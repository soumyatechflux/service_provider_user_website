import{r as m,A as J,f as N,l as U,n as V,p as X,o as Y,q as Z,j as a,B as d,k as O,T as h,E as $,t as z,v as _,w as q,K as tt,z as et,C as K,D as k,F as A,y as st}from"./index-BLDXZsNf.js";function ot(){var g,p,y,S,j,E;const{userData:c}=m.useContext(J),{data:n,isLoading:B}=N({queryKey:["examSession"],queryFn:()=>et(c.id)}),l=U(),f=V(),{id:R}=X(),[o,W]=m.useState(),L=async s=>{const e=K(k,"quizzes",s),i=await A(e);return{...i.data(),id:i.id}},{data:t}=N({queryKey:["examSessionQuiz"],queryFn:()=>L(R??"")}),P=async()=>{var i,r;const s=K(k,"courses",t==null?void 0:t.courseId),e=await A(s);await st(((i=n[0])==null?void 0:i.id)??"",c.id,`/programs/current/${(r=e.data())==null?void 0:r.programId}`)},{mutate:G}=Y({onMutate:()=>{const s=l.getQueryData(["examSession"]);return l.setQueryData(["examSession"],()=>[]),()=>l.setQueryData(["examSession"],s)},mutationFn:()=>P()}),x=(p=(g=n[0])==null?void 0:g.startTime)==null?void 0:p.toDate(),u=(S=(y=n[0])==null?void 0:y.endTime)==null?void 0:S.toDate();m.useEffect(()=>{const s=setInterval(()=>{if(x&&u){const e=u-Z.now().toMillis();e>0?W(e):(G(),f("/"))}},1e3);return()=>clearInterval(s)},[x,u,o]);const H=async()=>{t!=null&&t.id&&await tt(c.id,t.id),await l.invalidateQueries({queryKey:["examSession"]}),f("/")};return B?a.jsx(a.Fragment,{}):a.jsxs(d,{width:"100%",position:"relative",children:[a.jsxs(O,{justifyContent:"space-between",direction:"row",children:[a.jsxs(O,{direction:"column",bgcolor:"#D0EBFC",px:12,py:4,children:[a.jsx(h,{sx:{color:"#FF7E00"},fontSize:16,fontFamily:"Inter",fontWeight:800,children:"Quiz"}),a.jsx(h,{sx:{color:"#FF7E00"},fontSize:16,fontFamily:"Inter",fontWeight:600,children:"Course 3"})]}),a.jsx(d,{boxShadow:"0px 4px 4px 0px rgba(0, 0, 0, 0.25)",textAlign:"center",borderRadius:"15px",mr:14,mt:4,display:"flex",justifyContent:"center",alignItems:"center",height:"60px",width:"180px",children:a.jsxs(h,{fontSize:16,fontFamily:"Inter",fontWeight:500,children:[o?Math.floor(o/(1e3*60*60)).toString().length>1?Math.floor(o/(1e3*60*60)):`0${o&&Math.floor(o/(1e3*60*60))}`:"00",":",o?Math.floor(o%(1e3*60*60)/(1e3*60)).toString().length>1?Math.floor(o%(1e3*60*60)/(1e3*60)):`0${o&&Math.floor(o%(1e3*60*60)/(1e3*60))}`:"00",":",o?Math.floor(o%(1e3*60)/1e3).toString().length>1?Math.floor(o%(1e3*60)/1e3):`0${o&&Math.floor(o%(1e3*60)/1e3)}`:"00"]})})]}),a.jsx(d,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:((j=t==null?void 0:t.questions)==null?void 0:j.length)&&((E=t==null?void 0:t.questions)==null?void 0:E.map((s,e)=>{var i,r,Q,b,w,D,F,I,M,T,v,C;return s.type==="options"?s.correctOption.length>1?a.jsx($,{hidden:e!==Number((i=n[0])==null?void 0:i.lastQuestion),quizId:t.id,question:s,index:e,total:(r=t==null?void 0:t.questions)==null?void 0:r.length},e):a.jsx(z,{hidden:e!==Number((Q=n[0])==null?void 0:Q.lastQuestion),quizId:t.id,question:s,index:e,total:(b=t==null?void 0:t.questions)==null?void 0:b.length},e):s.type==="fiveOptions"?s.correctOption.length>2?a.jsx(_,{hidden:e!==Number((w=n[0])==null?void 0:w.lastQuestion),quizId:t.id,question:s,index:e,total:(D=t==null?void 0:t.questions)==null?void 0:D.length},e):s.correctOption.length>1?a.jsx($,{hidden:e!==Number((F=n[0])==null?void 0:F.lastQuestion),quizId:t.id,question:s,index:e,total:(I=t==null?void 0:t.questions)==null?void 0:I.length},e):a.jsx(z,{hidden:e!==Number((M=n[0])==null?void 0:M.lastQuestion),quizId:t.id,question:s,index:e,total:(T=t==null?void 0:t.questions)==null?void 0:T.length},e):a.jsx(q,{hidden:e!==Number((v=n[0])==null?void 0:v.lastQuestion),quizId:t.id,question:s,index:e,total:(C=t==null?void 0:t.questions)==null?void 0:C.length},e)}))}),a.jsx("div",{className:"absolute flex flex-col gap-2 w-fit text-left items-end justify-end text-[#FF7E00] font-[Inter] bottom-10 left-5 z-50",children:a.jsx("button",{className:"bg-[#FF7E00] text-white px-4 py-2 rounded-md",onClick:()=>H(),children:"Exit Exam"})})]})}export{ot as default};
