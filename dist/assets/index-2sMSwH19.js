var ts=Object.defineProperty;var es=(H,r,U)=>r in H?ts(H,r,{enumerable:!0,configurable:!0,writable:!0,value:U}):H[r]=U;var ee=(H,r,U)=>(es(H,typeof r!="symbol"?r+"":r,U),U),Ne=(H,r,U)=>{if(!r.has(H))throw TypeError("Cannot "+U)};var t=(H,r,U)=>(Ne(H,r,"read from private field"),U?U.call(H):r.get(H)),B=(H,r,U)=>{if(r.has(H))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(H):r.set(H,U)},rt=(H,r,U,a)=>(Ne(H,r,"write to private field"),a?a.call(H,U):r.set(H,U),U);var ge=(H,r,U,a)=>({set _(p){rt(H,r,p,U)},get _(){return t(H,r,a)}}),X=(H,r,U)=>(Ne(H,r,"access private method"),U);import{b9 as getAugmentedNamespace,Z as getDefaultExportFromCjs,r as reactExports,bb as $670gB$react,ap as clsx}from"./index-BLDXZsNf.js";import{P as PropTypes}from"./index-_pDSIHrO.js";function _mergeNamespaces(H,r){for(var U=0;U<r.length;U++){const a=r[U];if(typeof a!="string"&&!Array.isArray(a)){for(const p in a)if(p!=="default"&&!(p in H)){const V=Object.getOwnPropertyDescriptor(a,p);V&&Object.defineProperty(H,p,V.get?V:{enumerable:!0,get:()=>a[p]})}}}return Object.freeze(Object.defineProperty(H,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(H){throw new Error('Could not dynamically require "'+H+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(r,U){module.exports=r.pdfjsLib=U()})(globalThis,()=>(()=>{var __webpack_modules__=[,(H,r)=>{var zt;Object.defineProperty(r,"__esModule",{value:!0}),r.VerbosityLevel=r.Util=r.UnknownErrorException=r.UnexpectedResponseException=r.TextRenderingMode=r.RenderingIntentFlag=r.PromiseCapability=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.MAX_IMAGE_SIZE_TO_CACHE=r.LINE_FACTOR=r.LINE_DESCENT_FACTOR=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FeatureTest=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.BASELINE_FACTOR=r.AnnotationType=r.AnnotationReplyType=r.AnnotationPrefix=r.AnnotationMode=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationEditorType=r.AnnotationEditorPrefix=r.AnnotationEditorParamsType=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,r.assert=ct,r.bytesToString=N,r.createValidAbsoluteUrl=vt,r.getModificationDate=wt,r.getUuid=Wt,r.getVerbosityLevel=q,r.info=it,r.isArrayBuffer=ft,r.isArrayEqual=Pt,r.isNodeJS=void 0,r.normalizeUnicode=Vt,r.objectFromMap=lt,r.objectSize=tt,r.setVerbosityLevel=S,r.shadow=Tt,r.string32=Z,r.stringToBytes=st,r.stringToPDFString=pt,r.stringToUTF8String=et,r.unreachable=W,r.utf8StringToString=nt,r.warn=ot;const U=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");r.isNodeJS=U;const a=[1,0,0,1,0,0];r.IDENTITY_MATRIX=a;const p=[.001,0,0,.001,0,0];r.FONT_IDENTITY_MATRIX=p;const V=1e7;r.MAX_IMAGE_SIZE_TO_CACHE=V;const j=1.35;r.LINE_FACTOR=j;const dt=.35;r.LINE_DESCENT_FACTOR=dt;const F=dt/j;r.BASELINE_FACTOR=F;const x={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};r.RenderingIntentFlag=x;const g={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};r.AnnotationMode=g;const D="pdfjs_internal_editor_";r.AnnotationEditorPrefix=D;const L={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};r.AnnotationEditorType=L;const C={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};r.AnnotationEditorParamsType=C;const v={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.PermissionFlag=v;const y={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.TextRenderingMode=y;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.ImageKind=u;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationType=_;const P={GROUP:"Group",REPLY:"R"};r.AnnotationReplyType=P;const T={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFlag=T;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationFieldFlag=A;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationBorderStyleType=o;const h={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.AnnotationActionEventType=h;const k={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.DocumentActionEventType=k;const m={O:"PageOpen",C:"PageClose"};r.PageActionEventType=m;const l={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=l;const R={NONE:0,BINARY:1};r.CMapCompressionType=R;const f={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.OPS=f;const $={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};r.PasswordResponses=$;let G=l.WARNINGS;function S(ut){Number.isInteger(ut)&&(G=ut)}function q(){return G}function it(ut){G>=l.INFOS&&console.log(`Info: ${ut}`)}function ot(ut){G>=l.WARNINGS&&console.log(`Warning: ${ut}`)}function W(ut){throw new Error(ut)}function ct(ut,Q){ut||W(Q)}function gt(ut){switch(ut==null?void 0:ut.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function vt(ut,Q=null,Y=null){if(!ut)return null;try{if(Y&&typeof ut=="string"){if(Y.addDefaultProtocol&&ut.startsWith("www.")){const At=ut.match(/\./g);(At==null?void 0:At.length)>=2&&(ut=`http://${ut}`)}if(Y.tryConvertEncoding)try{ut=et(ut)}catch{}}const _t=Q?new URL(ut,Q):new URL(ut);if(gt(_t))return _t}catch{}return null}function Tt(ut,Q,Y,_t=!1){return Object.defineProperty(ut,Q,{value:Y,enumerable:!_t,configurable:!0,writable:!1}),Y}const w=function(){function Q(Y,_t){this.constructor===Q&&W("Cannot initialize BaseException."),this.message=Y,this.name=_t}return Q.prototype=new Error,Q.constructor=Q,Q}();r.BaseException=w;class n extends w{constructor(Q,Y){super(Q,"PasswordException"),this.code=Y}}r.PasswordException=n;class i extends w{constructor(Q,Y){super(Q,"UnknownErrorException"),this.details=Y}}r.UnknownErrorException=i;class s extends w{constructor(Q){super(Q,"InvalidPDFException")}}r.InvalidPDFException=s;class c extends w{constructor(Q){super(Q,"MissingPDFException")}}r.MissingPDFException=c;class d extends w{constructor(Q,Y){super(Q,"UnexpectedResponseException"),this.status=Y}}r.UnexpectedResponseException=d;class E extends w{constructor(Q){super(Q,"FormatError")}}r.FormatError=E;class M extends w{constructor(Q){super(Q,"AbortException")}}r.AbortException=M;function N(ut){(typeof ut!="object"||(ut==null?void 0:ut.length)===void 0)&&W("Invalid argument for bytesToString");const Q=ut.length,Y=8192;if(Q<Y)return String.fromCharCode.apply(null,ut);const _t=[];for(let At=0;At<Q;At+=Y){const te=Math.min(At+Y,Q),Zt=ut.subarray(At,te);_t.push(String.fromCharCode.apply(null,Zt))}return _t.join("")}function st(ut){typeof ut!="string"&&W("Invalid argument for stringToBytes");const Q=ut.length,Y=new Uint8Array(Q);for(let _t=0;_t<Q;++_t)Y[_t]=ut.charCodeAt(_t)&255;return Y}function Z(ut){return String.fromCharCode(ut>>24&255,ut>>16&255,ut>>8&255,ut&255)}function tt(ut){return Object.keys(ut).length}function lt(ut){const Q=Object.create(null);for(const[Y,_t]of ut)Q[Y]=_t;return Q}function mt(){const ut=new Uint8Array(4);return ut[0]=1,new Uint32Array(ut.buffer,0,1)[0]===1}function ht(){try{return new Function(""),!0}catch{return!1}}class kt{static get isLittleEndian(){return Tt(this,"isLittleEndian",mt())}static get isEvalSupported(){return Tt(this,"isEvalSupported",ht())}static get isOffscreenCanvasSupported(){return Tt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Tt(this,"platform",{isWin:!1,isMac:!1}):Tt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Q,Y;return Tt(this,"isCSSRoundSupported",(Y=(Q=globalThis.CSS)==null?void 0:Q.supports)==null?void 0:Y.call(Q,"width: round(1.5px, 1px)"))}}r.FeatureTest=kt;const Bt=[...Array(256).keys()].map(ut=>ut.toString(16).padStart(2,"0"));class Et{static makeHexColor(Q,Y,_t){return`#${Bt[Q]}${Bt[Y]}${Bt[_t]}`}static scaleMinMax(Q,Y){let _t;Q[0]?(Q[0]<0&&(_t=Y[0],Y[0]=Y[1],Y[1]=_t),Y[0]*=Q[0],Y[1]*=Q[0],Q[3]<0&&(_t=Y[2],Y[2]=Y[3],Y[3]=_t),Y[2]*=Q[3],Y[3]*=Q[3]):(_t=Y[0],Y[0]=Y[2],Y[2]=_t,_t=Y[1],Y[1]=Y[3],Y[3]=_t,Q[1]<0&&(_t=Y[2],Y[2]=Y[3],Y[3]=_t),Y[2]*=Q[1],Y[3]*=Q[1],Q[2]<0&&(_t=Y[0],Y[0]=Y[1],Y[1]=_t),Y[0]*=Q[2],Y[1]*=Q[2]),Y[0]+=Q[4],Y[1]+=Q[4],Y[2]+=Q[5],Y[3]+=Q[5]}static transform(Q,Y){return[Q[0]*Y[0]+Q[2]*Y[1],Q[1]*Y[0]+Q[3]*Y[1],Q[0]*Y[2]+Q[2]*Y[3],Q[1]*Y[2]+Q[3]*Y[3],Q[0]*Y[4]+Q[2]*Y[5]+Q[4],Q[1]*Y[4]+Q[3]*Y[5]+Q[5]]}static applyTransform(Q,Y){const _t=Q[0]*Y[0]+Q[1]*Y[2]+Y[4],At=Q[0]*Y[1]+Q[1]*Y[3]+Y[5];return[_t,At]}static applyInverseTransform(Q,Y){const _t=Y[0]*Y[3]-Y[1]*Y[2],At=(Q[0]*Y[3]-Q[1]*Y[2]+Y[2]*Y[5]-Y[4]*Y[3])/_t,te=(-Q[0]*Y[1]+Q[1]*Y[0]+Y[4]*Y[1]-Y[5]*Y[0])/_t;return[At,te]}static getAxialAlignedBoundingBox(Q,Y){const _t=this.applyTransform(Q,Y),At=this.applyTransform(Q.slice(2,4),Y),te=this.applyTransform([Q[0],Q[3]],Y),Zt=this.applyTransform([Q[2],Q[1]],Y);return[Math.min(_t[0],At[0],te[0],Zt[0]),Math.min(_t[1],At[1],te[1],Zt[1]),Math.max(_t[0],At[0],te[0],Zt[0]),Math.max(_t[1],At[1],te[1],Zt[1])]}static inverseTransform(Q){const Y=Q[0]*Q[3]-Q[1]*Q[2];return[Q[3]/Y,-Q[1]/Y,-Q[2]/Y,Q[0]/Y,(Q[2]*Q[5]-Q[4]*Q[3])/Y,(Q[4]*Q[1]-Q[5]*Q[0])/Y]}static singularValueDecompose2dScale(Q){const Y=[Q[0],Q[2],Q[1],Q[3]],_t=Q[0]*Y[0]+Q[1]*Y[2],At=Q[0]*Y[1]+Q[1]*Y[3],te=Q[2]*Y[0]+Q[3]*Y[2],Zt=Q[2]*Y[1]+Q[3]*Y[3],J=(_t+Zt)/2,St=Math.sqrt((_t+Zt)**2-4*(_t*Zt-te*At))/2,It=J+St||1,Ct=J-St||1;return[Math.sqrt(It),Math.sqrt(Ct)]}static normalizeRect(Q){const Y=Q.slice(0);return Q[0]>Q[2]&&(Y[0]=Q[2],Y[2]=Q[0]),Q[1]>Q[3]&&(Y[1]=Q[3],Y[3]=Q[1]),Y}static intersect(Q,Y){const _t=Math.max(Math.min(Q[0],Q[2]),Math.min(Y[0],Y[2])),At=Math.min(Math.max(Q[0],Q[2]),Math.max(Y[0],Y[2]));if(_t>At)return null;const te=Math.max(Math.min(Q[1],Q[3]),Math.min(Y[1],Y[3])),Zt=Math.min(Math.max(Q[1],Q[3]),Math.max(Y[1],Y[3]));return te>Zt?null:[_t,te,At,Zt]}static bezierBoundingBox(Q,Y,_t,At,te,Zt,J,St){const It=[],Ct=[[],[]];let Ot,Nt,Jt,yt,Yt,Lt,I,e;for(let K=0;K<2;++K){if(K===0?(Nt=6*Q-12*_t+6*te,Ot=-3*Q+9*_t-9*te+3*J,Jt=3*_t-3*Q):(Nt=6*Y-12*At+6*Zt,Ot=-3*Y+9*At-9*Zt+3*St,Jt=3*At-3*Y),Math.abs(Ot)<1e-12){if(Math.abs(Nt)<1e-12)continue;yt=-Jt/Nt,0<yt&&yt<1&&It.push(yt);continue}I=Nt*Nt-4*Jt*Ot,e=Math.sqrt(I),!(I<0)&&(Yt=(-Nt+e)/(2*Ot),0<Yt&&Yt<1&&It.push(Yt),Lt=(-Nt-e)/(2*Ot),0<Lt&&Lt<1&&It.push(Lt))}let b=It.length,O;const z=b;for(;b--;)yt=It[b],O=1-yt,Ct[0][b]=O*O*O*Q+3*O*O*yt*_t+3*O*yt*yt*te+yt*yt*yt*J,Ct[1][b]=O*O*O*Y+3*O*O*yt*At+3*O*yt*yt*Zt+yt*yt*yt*St;return Ct[0][z]=Q,Ct[1][z]=Y,Ct[0][z+1]=J,Ct[1][z+1]=St,Ct[0].length=Ct[1].length=z+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}r.Util=Et;const Dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function pt(ut){if(ut[0]>="ï"){let Y;if(ut[0]==="þ"&&ut[1]==="ÿ"?Y="utf-16be":ut[0]==="ÿ"&&ut[1]==="þ"?Y="utf-16le":ut[0]==="ï"&&ut[1]==="»"&&ut[2]==="¿"&&(Y="utf-8"),Y)try{const _t=new TextDecoder(Y,{fatal:!0}),At=st(ut);return _t.decode(At)}catch(_t){ot(`stringToPDFString: "${_t}".`)}}const Q=[];for(let Y=0,_t=ut.length;Y<_t;Y++){const At=Dt[ut.charCodeAt(Y)];Q.push(At?String.fromCharCode(At):ut.charAt(Y))}return Q.join("")}function et(ut){return decodeURIComponent(escape(ut))}function nt(ut){return unescape(encodeURIComponent(ut))}function ft(ut){return typeof ut=="object"&&(ut==null?void 0:ut.byteLength)!==void 0}function Pt(ut,Q){if(ut.length!==Q.length)return!1;for(let Y=0,_t=ut.length;Y<_t;Y++)if(ut[Y]!==Q[Y])return!1;return!0}function wt(ut=new Date){return[ut.getUTCFullYear().toString(),(ut.getUTCMonth()+1).toString().padStart(2,"0"),ut.getUTCDate().toString().padStart(2,"0"),ut.getUTCHours().toString().padStart(2,"0"),ut.getUTCMinutes().toString().padStart(2,"0"),ut.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){B(this,zt,!1);this.promise=new Promise((Q,Y)=>{this.resolve=_t=>{rt(this,zt,!0),Q(_t)},this.reject=_t=>{rt(this,zt,!0),Y(_t)}})}get settled(){return t(this,zt)}}zt=new WeakMap,r.PromiseCapability=Ut;let Gt=null,jt=null;function Vt(ut){return Gt||(Gt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,jt=new Map([["ﬅ","ſt"]])),ut.replaceAll(Gt,(Q,Y,_t)=>Y?Y.normalize("NFKC"):jt.get(_t))}function Wt(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const ut=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(ut);else for(let Q=0;Q<32;Q++)ut[Q]=Math.floor(Math.random()*255);return N(ut)}const $t="pdfjs_internal_id_";r.AnnotationPrefix=$t},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var H,U,a,p,he,j,Se,F,x,g,D,L,C,v,y,u,Te,P,T,Be,o,h;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(m){if(typeof m=="string"||m instanceof URL?m={url:m}:(0,_util.isArrayBuffer)(m)&&(m={data:m}),typeof m!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!m.url&&!m.data&&!m.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:R}=l,f=m.url?getUrlProp(m.url):null,$=m.data?getDataProp(m.data):null,G=m.httpHeaders||null,S=m.withCredentials===!0,q=m.password??null,it=m.range instanceof PDFDataRangeTransport?m.range:null,ot=Number.isInteger(m.rangeChunkSize)&&m.rangeChunkSize>0?m.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let W=m.worker instanceof PDFWorker?m.worker:null;const ct=m.verbosity,gt=typeof m.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(m.docBaseUrl)?m.docBaseUrl:null,vt=typeof m.cMapUrl=="string"?m.cMapUrl:null,Tt=m.cMapPacked!==!1,w=m.CMapReaderFactory||DefaultCMapReaderFactory,n=typeof m.standardFontDataUrl=="string"?m.standardFontDataUrl:null,i=m.StandardFontDataFactory||DefaultStandardFontDataFactory,s=m.stopAtErrors!==!0,c=Number.isInteger(m.maxImageSize)&&m.maxImageSize>-1?m.maxImageSize:-1,d=m.isEvalSupported!==!1,E=typeof m.isOffscreenCanvasSupported=="boolean"?m.isOffscreenCanvasSupported:!_util.isNodeJS,M=Number.isInteger(m.canvasMaxAreaInBytes)?m.canvasMaxAreaInBytes:-1,N=typeof m.disableFontFace=="boolean"?m.disableFontFace:_util.isNodeJS,st=m.fontExtraProperties===!0,Z=m.enableXfa===!0,tt=m.ownerDocument||globalThis.document,lt=m.disableRange===!0,mt=m.disableStream===!0,ht=m.disableAutoFetch===!0,kt=m.pdfBug===!0,Bt=it?it.length:m.length??NaN,Et=typeof m.useSystemFonts=="boolean"?m.useSystemFonts:!_util.isNodeJS&&!N,Dt=typeof m.useWorkerFetch=="boolean"?m.useWorkerFetch:w===_display_utils.DOMCMapReaderFactory&&i===_display_utils.DOMStandardFontDataFactory&&vt&&n&&(0,_display_utils.isValidFetchUrl)(vt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(n,document.baseURI),pt=m.canvasFactory||new DefaultCanvasFactory({ownerDocument:tt}),et=m.filterFactory||new DefaultFilterFactory({docId:R,ownerDocument:tt}),nt=null;(0,_util.setVerbosityLevel)(ct);const ft={canvasFactory:pt,filterFactory:et};if(Dt||(ft.cMapReaderFactory=new w({baseUrl:vt,isCompressed:Tt}),ft.standardFontDataFactory=new i({baseUrl:n})),!W){const Ut={verbosity:ct,port:_worker_options.GlobalWorkerOptions.workerPort};W=Ut.port?PDFWorker.fromPort(Ut):new PDFWorker(Ut),l._worker=W}const Pt={docId:R,apiVersion:"3.11.174",data:$,password:q,disableAutoFetch:ht,rangeChunkSize:ot,length:Bt,docBaseUrl:gt,enableXfa:Z,evaluatorOptions:{maxImageSize:c,disableFontFace:N,ignoreErrors:s,isEvalSupported:d,isOffscreenCanvasSupported:E,canvasMaxAreaInBytes:M,fontExtraProperties:st,useSystemFonts:Et,cMapUrl:Dt?vt:null,standardFontDataUrl:Dt?n:null}},wt={ignoreErrors:s,isEvalSupported:d,disableFontFace:N,fontExtraProperties:st,enableXfa:Z,ownerDocument:tt,disableAutoFetch:ht,pdfBug:kt,styleElement:nt};return W.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const Ut=_fetchDocument(W,Pt),Gt=new Promise(function(jt){let Vt;it?Vt=new _transport_stream.PDFDataTransportStream({length:Bt,initialData:it.initialData,progressiveDone:it.progressiveDone,contentDispositionFilename:it.contentDispositionFilename,disableRange:lt,disableStream:mt},it):$||(Vt=($t=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream($t):(0,_display_utils.isValidFetchUrl)($t.url)?new _displayFetch_stream.PDFFetchStream($t):new _displayNetwork.PDFNetworkStream($t))({url:f,length:Bt,httpHeaders:G,withCredentials:S,rangeChunkSize:ot,disableRange:lt,disableStream:mt})),jt(Vt)});return Promise.all([Ut,Gt]).then(function([jt,Vt]){if(l.destroyed)throw new Error("Loading aborted");const Wt=new _message_handler.MessageHandler(R,jt,W.port),$t=new WorkerTransport(Wt,l,Vt,wt,ft);l._transport=$t,Wt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(m,l){if(m.destroyed)throw new Error("Worker was destroyed");const R=await m.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(m.destroyed)throw new Error("Worker was destroyed");return R}function getUrlProp(m){if(m instanceof URL)return m.href;try{return new URL(m,window.location).href}catch{if(_util.isNodeJS&&typeof m=="string")return m}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(m){if(_util.isNodeJS&&typeof Buffer<"u"&&m instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength)return m;if(typeof m=="string")return(0,_util.stringToBytes)(m);if(typeof m=="object"&&!isNaN(m==null?void 0:m.length)||(0,_util.isArrayBuffer)(m))return new Uint8Array(m);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const r=class r{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${ge(r,H)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,R,f;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((R=this._transport)==null?void 0:R.destroy())}catch($){throw(f=this._worker)!=null&&f.port&&delete this._worker._pendingDestroy,$}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};H=new WeakMap,B(r,H,0);let PDFDocumentLoadingTask=r;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,R,f=!1,$=null){this.length=l,this.initialData=R,this.progressiveDone=f,this.contentDispositionFilename=$,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,R){for(const f of this._rangeListeners)f(l,R)}onDataProgress(l,R){this._readyCapability.promise.then(()=>{for(const f of this._progressListeners)f(l,R)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const R of this._progressiveReadListeners)R(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,R){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,R){this._pdfInfo=l,this._transport=R,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(f=>{if(!f)return f;const $=[];for(const G in f)$.push(...f[G]);return $}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,R,f,$=!1){B(this,p);B(this,j);B(this,U,null);B(this,a,!1);this._pageIndex=l,this._pageInfo=R,this._transport=f,this._stats=$?new _display_utils.StatTimer:null,this._pdfBug=$,this.commonObjs=f.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:R=this.rotate,offsetX:f=0,offsetY:$=0,dontFlip:G=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:R,offsetX:f,offsetY:$,dontFlip:G})}getAnnotations({intent:l="display"}={}){const R=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,R.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:R,intent:f="display",annotationMode:$=_util.AnnotationMode.ENABLE,transform:G=null,background:S=null,optionalContentConfigPromise:q=null,annotationCanvasMap:it=null,pageColors:ot=null,printAnnotationStorage:W=null}){var i,s;(i=this._stats)==null||i.time("Overall");const ct=this._transport.getRenderingIntent(f,$,W);rt(this,a,!1),X(this,j,Se).call(this),q||(q=this._transport.getOptionalContentConfig());let gt=this._intentStates.get(ct.cacheKey);gt||(gt=Object.create(null),this._intentStates.set(ct.cacheKey,gt)),gt.streamReaderCancelTimeout&&(clearTimeout(gt.streamReaderCancelTimeout),gt.streamReaderCancelTimeout=null);const vt=!!(ct.renderingIntent&_util.RenderingIntentFlag.PRINT);gt.displayReadyCapability||(gt.displayReadyCapability=new _util.PromiseCapability,gt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(s=this._stats)==null||s.time("Page Request"),this._pumpOperatorList(ct));const Tt=c=>{var d,E;gt.renderTasks.delete(w),(this._maybeCleanupAfterRender||vt)&&rt(this,a,!0),X(this,p,he).call(this,!vt),c?(w.capability.reject(c),this._abortOperatorList({intentState:gt,reason:c instanceof Error?c:new Error(c)})):w.capability.resolve(),(d=this._stats)==null||d.timeEnd("Rendering"),(E=this._stats)==null||E.timeEnd("Overall")},w=new InternalRenderTask({callback:Tt,params:{canvasContext:l,viewport:R,transform:G,background:S},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:it,operatorList:gt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!vt,pdfBug:this._pdfBug,pageColors:ot});(gt.renderTasks||(gt.renderTasks=new Set)).add(w);const n=w.task;return Promise.all([gt.displayReadyCapability.promise,q]).then(([c,d])=>{var E;if(this.destroyed){Tt();return}(E=this._stats)==null||E.time("Rendering"),w.initializeGraphics({transparency:c,optionalContentConfig:d}),w.operatorListChanged()}).catch(Tt),n}getOperatorList({intent:l="display",annotationMode:R=_util.AnnotationMode.ENABLE,printAnnotationStorage:f=null}={}){var it;function $(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(q))}const G=this._transport.getRenderingIntent(l,R,f,!0);let S=this._intentStates.get(G.cacheKey);S||(S=Object.create(null),this._intentStates.set(G.cacheKey,S));let q;return S.opListReadCapability||(q=Object.create(null),q.operatorListChanged=$,S.opListReadCapability=new _util.PromiseCapability,(S.renderTasks||(S.renderTasks=new Set)).add(q),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(it=this._stats)==null||it.time("Page Request"),this._pumpOperatorList(G)),S.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:R=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:R===!0},{highWaterMark:100,size($){return $.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(f=>_xfa_text.XfaText.textContent(f));const R=this.streamTextContent(l);return new Promise(function(f,$){function G(){S.read().then(function({value:it,done:ot}){if(ot){f(q);return}Object.assign(q.styles,it.styles),q.items.push(...it.items),G()},$)}const S=R.getReader(),q={items:[],styles:Object.create(null)};G()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const R of this._intentStates.values())if(this._abortOperatorList({intentState:R,reason:new Error("Page was destroyed."),force:!0}),!R.opListReadCapability)for(const f of R.renderTasks)l.push(f.completed),f.cancel();return this.objs.clear(),rt(this,a,!1),X(this,j,Se).call(this),Promise.all(l)}cleanup(l=!1){rt(this,a,!0);const R=X(this,p,he).call(this,!1);return l&&R&&this._stats&&(this._stats=new _display_utils.StatTimer),R}_startRenderPage(l,R){var $,G;const f=this._intentStates.get(R);f&&(($=this._stats)==null||$.timeEnd("Page Request"),(G=f.displayReadyCapability)==null||G.resolve(l))}_renderPageChunk(l,R){for(let f=0,$=l.length;f<$;f++)R.operatorList.fnArray.push(l.fnArray[f]),R.operatorList.argsArray.push(l.argsArray[f]);R.operatorList.lastChunk=l.lastChunk,R.operatorList.separateAnnots=l.separateAnnots;for(const f of R.renderTasks)f.operatorListChanged();l.lastChunk&&X(this,p,he).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:R,annotationStorageSerializable:f}){const{map:$,transfers:G}=f,q=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:R,annotationStorage:$},G).getReader(),it=this._intentStates.get(R);it.streamReader=q;const ot=()=>{q.read().then(({value:W,done:ct})=>{if(ct){it.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(W,it),ot())},W=>{if(it.streamReader=null,!this._transport.destroyed){if(it.operatorList){it.operatorList.lastChunk=!0;for(const ct of it.renderTasks)ct.operatorListChanged();X(this,p,he).call(this,!0)}if(it.displayReadyCapability)it.displayReadyCapability.reject(W);else if(it.opListReadCapability)it.opListReadCapability.reject(W);else throw W}})};ot()}_abortOperatorList({intentState:l,reason:R,force:f=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!f){if(l.renderTasks.size>0)return;if(R instanceof _display_utils.RenderingCancelledException){let $=RENDERING_CANCELLED_TIMEOUT;R.extraDelay>0&&R.extraDelay<1e3&&($+=R.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:R,force:!0})},$);return}}if(l.streamReader.cancel(new _util.AbortException(R.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[$,G]of this._intentStates)if(G===l){this._intentStates.delete($);break}this.cleanup()}}}get stats(){return this._stats}}U=new WeakMap,a=new WeakMap,p=new WeakSet,he=function(l=!1){if(X(this,j,Se).call(this),!t(this,a)||this.destroyed)return!1;if(l)return rt(this,U,setTimeout(()=>{rt(this,U,null),X(this,p,he).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:R,operatorList:f}of this._intentStates.values())if(R.size>0||!f.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),rt(this,a,!1),!0},j=new WeakSet,Se=function(){t(this,U)&&(clearTimeout(t(this,U)),rt(this,U,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){B(this,F,new Set);B(this,x,Promise.resolve())}postMessage(l,R){const f={data:structuredClone(l,R?{transfer:R}:null)};t(this,x).then(()=>{for(const $ of t(this,F))$.call(this,f)})}addEventListener(l,R){t(this,F).add(R)}removeEventListener(l,R){t(this,F).delete(R)}terminate(){t(this,F).clear()}}F=new WeakMap,x=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const m=(g=document==null?void 0:document.currentScript)==null?void 0:g.src;m&&(PDFWorkerUtil.fallbackWorkerSrc=m.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(m,l){let R;try{if(R=new URL(m),!R.origin||R.origin==="null")return!1}catch{return!1}const f=new URL(l,R);return R.origin===f.origin},PDFWorkerUtil.createCDNWrapper=function(m){const l=`importScripts("${m}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:m=null,port:l=null,verbosity:R=(0,_util.getVerbosityLevel)()}={}){var f;if(this.name=m,this.destroyed=!1,this.verbosity=R,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((f=t(_PDFWorker,D))!=null&&f.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,D)||rt(_PDFWorker,D,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(m){this._port=m,this._messageHandler=new _message_handler.MessageHandler("main","worker",m),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:m}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,m)||(m=PDFWorkerUtil.createCDNWrapper(new URL(m,window.location).href));const l=new Worker(m),R=new _message_handler.MessageHandler("main","worker",l),f=()=>{l.removeEventListener("error",$),R.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},$=()=>{this._webWorker||f()};l.addEventListener("error",$),R.on("test",S=>{if(l.removeEventListener("error",$),this.destroyed){f();return}S?(this._messageHandler=R,this._port=l,this._webWorker=l,this._readyCapability.resolve(),R.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),R.destroy(),l.terminate())}),R.on("ready",S=>{if(l.removeEventListener("error",$),this.destroyed){f();return}try{G()}catch{this._setupFakeWorker()}});const G=()=>{const S=new Uint8Array;R.send("test",S,[S.buffer])};G();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(m=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const R=`fake${PDFWorkerUtil.fakeWorkerId++}`,f=new _message_handler.MessageHandler(R+"_worker",R,l);m.setup(f,l);const $=new _message_handler.MessageHandler(R,R+"_worker",l);this._messageHandler=$,this._readyCapability.resolve(),$.send("configure",{verbosity:this.verbosity})}).catch(m=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${m.message}".`))})}destroy(){var m;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(m=t(_PDFWorker,D))==null||m.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(m){var R;if(!(m!=null&&m.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(R=t(this,D))==null?void 0:R.get(m.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(m)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var m;try{return((m=globalThis.pdfjsWorker)==null?void 0:m.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};D=new WeakMap,B(_PDFWorker,D,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,R,f,$,G){B(this,u);B(this,L,new Map);B(this,C,new Map);B(this,v,new Map);B(this,y,null);this.messageHandler=l,this.loadingTask=R,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:$.ownerDocument,styleElement:$.styleElement}),this._params=$,this.canvasFactory=G.canvasFactory,this.filterFactory=G.filterFactory,this.cMapReaderFactory=G.cMapReaderFactory,this.standardFontDataFactory=G.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=f,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,R=_util.AnnotationMode.ENABLE,f=null,$=!1){let G=_util.RenderingIntentFlag.DISPLAY,S=_annotation_storage.SerializableEmpty;switch(l){case"any":G=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":G=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(R){case _util.AnnotationMode.DISABLE:G+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:G+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:G+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=(G&_util.RenderingIntentFlag.PRINT&&f instanceof _annotation_storage.PrintAnnotationStorage?f:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${R}`)}return $&&(G+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:G,cacheKey:`${G}_${S.hash}`,annotationStorageSerializable:S}}destroy(){var f;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(f=t(this,y))==null||f.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const $ of t(this,C).values())l.push($._destroy());t(this,C).clear(),t(this,v).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const R=this.messageHandler.sendWithPromise("Terminate",null);return l.push(R),Promise.all(l).then(()=>{var $;this.commonObjs.clear(),this.fontLoader.clear(),t(this,L).clear(),this.filterFactory.destroy(),($=this._networkStream)==null||$.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:R}=this;l.on("GetReader",(f,$)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=G=>{this._lastProgress={loaded:G.loaded,total:G.total}},$.onPull=()=>{this._fullReader.read().then(function({value:G,done:S}){if(S){$.close();return}(0,_util.assert)(G instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(G),1,[G])}).catch(G=>{$.error(G)})},$.onCancel=G=>{this._fullReader.cancel(G),$.ready.catch(S=>{if(!this.destroyed)throw S})}}),l.on("ReaderHeadersReady",f=>{const $=new _util.PromiseCapability,G=this._fullReader;return G.headersReady.then(()=>{var S;(!G.isStreamingSupported||!G.isRangeSupported)&&(this._lastProgress&&((S=R.onProgress)==null||S.call(R,this._lastProgress)),G.onProgress=q=>{var it;(it=R.onProgress)==null||it.call(R,{loaded:q.loaded,total:q.total})}),$.resolve({isStreamingSupported:G.isStreamingSupported,isRangeSupported:G.isRangeSupported,contentLength:G.contentLength})},$.reject),$.promise}),l.on("GetRangeReader",(f,$)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const G=this._networkStream.getRangeReader(f.begin,f.end);if(!G){$.close();return}$.onPull=()=>{G.read().then(function({value:S,done:q}){if(q){$.close();return}(0,_util.assert)(S instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),$.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{$.error(S)})},$.onCancel=S=>{G.cancel(S),$.ready.catch(q=>{if(!this.destroyed)throw q})}}),l.on("GetDoc",({pdfInfo:f})=>{this._numPages=f.numPages,this._htmlForXfa=f.htmlForXfa,delete f.htmlForXfa,R._capability.resolve(new PDFDocumentProxy(f,this))}),l.on("DocException",function(f){let $;switch(f.name){case"PasswordException":$=new _util.PasswordException(f.message,f.code);break;case"InvalidPDFException":$=new _util.InvalidPDFException(f.message);break;case"MissingPDFException":$=new _util.MissingPDFException(f.message);break;case"UnexpectedResponseException":$=new _util.UnexpectedResponseException(f.message,f.status);break;case"UnknownErrorException":$=new _util.UnknownErrorException(f.message,f.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}R._capability.reject($)}),l.on("PasswordRequest",f=>{if(rt(this,y,new _util.PromiseCapability),R.onPassword){const $=G=>{G instanceof Error?t(this,y).reject(G):t(this,y).resolve({password:G})};try{R.onPassword($,f.code)}catch(G){t(this,y).reject(G)}}else t(this,y).reject(new _util.PasswordException(f.message,f.code));return t(this,y).promise}),l.on("DataLoaded",f=>{var $;($=R.onProgress)==null||$.call(R,{loaded:f.length,total:f.length}),this.downloadInfoCapability.resolve(f)}),l.on("StartRenderPage",f=>{if(this.destroyed)return;t(this,C).get(f.pageIndex)._startRenderPage(f.transparency,f.cacheKey)}),l.on("commonobj",([f,$,G])=>{var S;if(!this.destroyed&&!this.commonObjs.has(f))switch($){case"Font":const q=this._params;if("error"in G){const W=G.error;(0,_util.warn)(`Error during font loading: ${W}`),this.commonObjs.resolve(f,W);break}const it=q.pdfBug&&((S=globalThis.FontInspector)!=null&&S.enabled)?(W,ct)=>globalThis.FontInspector.fontAdded(W,ct):null,ot=new _font_loader.FontFaceObject(G,{isEvalSupported:q.isEvalSupported,disableFontFace:q.disableFontFace,ignoreErrors:q.ignoreErrors,inspectFont:it});this.fontLoader.bind(ot).catch(W=>l.sendWithPromise("FontFallback",{id:f})).finally(()=>{!q.fontExtraProperties&&ot.data&&(ot.data=null),this.commonObjs.resolve(f,ot)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(f,G);break;default:throw new Error(`Got unknown common object type ${$}`)}}),l.on("obj",([f,$,G,S])=>{var it;if(this.destroyed)return;const q=t(this,C).get($);if(!q.objs.has(f))switch(G){case"Image":if(q.objs.resolve(f,S),S){let ot;if(S.bitmap){const{width:W,height:ct}=S;ot=W*ct*4}else ot=((it=S.data)==null?void 0:it.length)||0;ot>_util.MAX_IMAGE_SIZE_TO_CACHE&&(q._maybeCleanupAfterRender=!0)}break;case"Pattern":q.objs.resolve(f,S);break;default:throw new Error(`Got unknown object type ${G}`)}}),l.on("DocProgress",f=>{var $;this.destroyed||($=R.onProgress)==null||$.call(R,{loaded:f.loaded,total:f.total})}),l.on("FetchBuiltInCMap",f=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(f):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",f=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(f):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var f;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:R}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:((f=this._fullReader)==null?void 0:f.filename)??null},R).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const R=l-1,f=t(this,v).get(R);if(f)return f;const $=this.messageHandler.sendWithPromise("GetPage",{pageIndex:R}).then(G=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(R,G,this,this._params.pdfBug);return t(this,C).set(R,S),S});return t(this,v).set(R,$),$}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,R){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:R})}getFieldObjects(){return X(this,u,Te).call(this,"GetFieldObjects")}hasJSActions(){return X(this,u,Te).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return X(this,u,Te).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",R=t(this,L).get(l);if(R)return R;const f=this.messageHandler.sendWithPromise(l,null).then($=>{var G,S;return{info:$[0],metadata:$[1]?new _metadata.Metadata($[1]):null,contentDispositionFilename:((G=this._fullReader)==null?void 0:G.filename)??null,contentLength:((S=this._fullReader)==null?void 0:S.contentLength)??null}});return t(this,L).set(l,f),f}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const R of t(this,C).values())if(!R.cleanup())throw new Error(`startCleanup: Page ${R.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,L).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:R}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:R})}}L=new WeakMap,C=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakSet,Te=function(l,R=null){const f=t(this,L).get(l);if(f)return f;const $=this.messageHandler.sendWithPromise(l,R);return t(this,L).set(l,$),$};class PDFObjects{constructor(){B(this,T);B(this,P,Object.create(null))}get(l,R=null){if(R){const $=X(this,T,Be).call(this,l);return $.capability.promise.then(()=>R($.data)),null}const f=t(this,P)[l];if(!(f!=null&&f.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return f.data}has(l){const R=t(this,P)[l];return(R==null?void 0:R.capability.settled)||!1}resolve(l,R=null){const f=X(this,T,Be).call(this,l);f.data=R,f.capability.resolve()}clear(){var l;for(const R in t(this,P)){const{data:f}=t(this,P)[R];(l=f==null?void 0:f.bitmap)==null||l.close()}rt(this,P,Object.create(null))}}P=new WeakMap,T=new WeakSet,Be=function(l){var R;return(R=t(this,P))[l]||(R[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){B(this,o,null);rt(this,o,l),this.onContinue=null}get promise(){return t(this,o).capability.promise}cancel(l=0){t(this,o).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,o).operatorList;if(!l)return!1;const{annotationCanvasMap:R}=t(this,o);return l.form||l.canvas&&(R==null?void 0:R.size)>0}}o=new WeakMap,exports.RenderTask=RenderTask;const k=class k{constructor({callback:l,params:R,objs:f,commonObjs:$,annotationCanvasMap:G,operatorList:S,pageIndex:q,canvasFactory:it,filterFactory:ot,useRequestAnimationFrame:W=!1,pdfBug:ct=!1,pageColors:gt=null}){this.callback=l,this.params=R,this.objs=f,this.commonObjs=$,this.annotationCanvasMap=G,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=q,this.canvasFactory=it,this.filterFactory=ot,this._pdfBug=ct,this.pageColors=gt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=W===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=R.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:R}){var q,it;if(this.cancelled)return;if(this._canvas){if(t(k,h).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(k,h).add(this._canvas)}this._pdfBug&&((q=globalThis.StepperManager)!=null&&q.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:f,viewport:$,transform:G,background:S}=this.params;this.gfx=new _canvas.CanvasGraphics(f,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:R},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:G,viewport:$,transparency:l,background:S}),this.operatorListIdx=0,this.graphicsReady=!0,(it=this.graphicsReadyCallback)==null||it.call(this)}cancel(l=null,R=0){var f;this.running=!1,this.cancelled=!0,(f=this.gfx)==null||f.endDrawing(),t(k,h).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,R))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(k,h).delete(this._canvas),this.callback())))}};h=new WeakMap,B(k,h,new WeakSet);let InternalRenderTask=k;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(H,r,U)=>{var x,g,D,An,C;Object.defineProperty(r,"__esModule",{value:!0}),r.SerializableEmpty=r.PrintAnnotationStorage=r.AnnotationStorage=void 0;var a=U(1),p=U(4),V=U(8);const j=Object.freeze({map:null,hash:"",transfers:void 0});r.SerializableEmpty=j;class dt{constructor(){B(this,D);B(this,x,!1);B(this,g,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(y,u){const _=t(this,g).get(y);return _===void 0?u:Object.assign(u,_)}getRawValue(y){return t(this,g).get(y)}remove(y){if(t(this,g).delete(y),t(this,g).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const u of t(this,g).values())if(u instanceof p.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(y,u){const _=t(this,g).get(y);let P=!1;if(_!==void 0)for(const[T,A]of Object.entries(u))_[T]!==A&&(P=!0,_[T]=A);else P=!0,t(this,g).set(y,u);P&&X(this,D,An).call(this),u instanceof p.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(u.constructor._type)}has(y){return t(this,g).has(y)}getAll(){return t(this,g).size>0?(0,a.objectFromMap)(t(this,g)):null}setAll(y){for(const[u,_]of Object.entries(y))this.setValue(u,_)}get size(){return t(this,g).size}resetModified(){t(this,x)&&(rt(this,x,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new F(this)}get serializable(){if(t(this,g).size===0)return j;const y=new Map,u=new V.MurmurHash3_64,_=[],P=Object.create(null);let T=!1;for(const[A,o]of t(this,g)){const h=o instanceof p.AnnotationEditor?o.serialize(!1,P):o;h&&(y.set(A,h),u.update(`${A}:${JSON.stringify(h)}`),T||(T=!!h.bitmap))}if(T)for(const A of y.values())A.bitmap&&_.push(A.bitmap);return y.size>0?{map:y,hash:u.hexdigest(),transfers:_}:j}}x=new WeakMap,g=new WeakMap,D=new WeakSet,An=function(){t(this,x)||(rt(this,x,!0),typeof this.onSetModified=="function"&&this.onSetModified())},r.AnnotationStorage=dt;class F extends dt{constructor(u){super();B(this,C,void 0);const{map:_,hash:P,transfers:T}=u.serializable,A=structuredClone(_,T?{transfer:T}:null);rt(this,C,{map:A,hash:P,transfers:T})}get print(){(0,a.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,C)}}C=new WeakMap,r.PrintAnnotationStorage=F},(H,r,U)=>{var F,x,g,D,L,C,v,y,u,_,P,T,A,o,h,Ue,m,je,R,$e,$,He,S,vn,it,En,W,Sn,gt,We,Tt,Tn;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditor=void 0;var a=U(5),p=U(1),V=U(6);const n=class n{constructor(s){B(this,h);B(this,m);B(this,$);B(this,S);B(this,it);B(this,W);B(this,gt);B(this,Tt);B(this,F,"");B(this,x,!1);B(this,g,null);B(this,D,null);B(this,L,null);B(this,C,!1);B(this,v,null);B(this,y,this.focusin.bind(this));B(this,u,this.focusout.bind(this));B(this,_,!1);B(this,P,!1);B(this,T,!1);ee(this,"_initialOptions",Object.create(null));ee(this,"_uiManager",null);ee(this,"_focusEventsAllowed",!0);ee(this,"_l10nPromise",null);B(this,A,!1);B(this,o,n._zIndex++);this.constructor===n&&(0,p.unreachable)("Cannot initialize AnnotationEditor."),this.parent=s.parent,this.id=s.id,this.width=this.height=null,this.pageIndex=s.parent.pageIndex,this.name=s.name,this.div=null,this._uiManager=s.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=s.isCentered,this._structTreeParentId=null;const{rotation:c,rawDims:{pageWidth:d,pageHeight:E,pageX:M,pageY:N}}=this.parent.viewport;this.rotation=c,this.pageRotation=(360+c-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[d,E],this.pageTranslation=[M,N];const[st,Z]=this.parentDimensions;this.x=s.x/st,this.y=s.y/Z,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,p.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(s){const c=new dt({id:s.parent.getNextId(),parent:s.parent,uiManager:s._uiManager});c.annotationElementId=s.annotationElementId,c.deleted=!0,c._uiManager.addToAnnotationStorage(c)}static initialize(s,c=null){if(n._l10nPromise||(n._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(E=>[E,s.get(E)]))),c!=null&&c.strings)for(const E of c.strings)n._l10nPromise.set(E,s.get(E));if(n._borderLineWidth!==-1)return;const d=getComputedStyle(document.documentElement);n._borderLineWidth=parseFloat(d.getPropertyValue("--outline-width"))||0}static updateDefaultParams(s,c){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(s){return!1}static paste(s,c){(0,p.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,A)}set _isDraggable(s){var c;rt(this,A,s),(c=this.div)==null||c.classList.toggle("draggable",s)}center(){const[s,c]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*c/(s*2),this.y+=this.width*s/(c*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*c/(s*2),this.y-=this.width*s/(c*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(s){this._uiManager.addCommands(s)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,o)}setParent(s){s!==null&&(this.pageIndex=s.pageIndex,this.pageDimensions=s.pageDimensions),this.parent=s}focusin(s){this._focusEventsAllowed&&(t(this,_)?rt(this,_,!1):this.parent.setSelected(this))}focusout(s){var d;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const c=s.relatedTarget;c!=null&&c.closest(`#${this.id}`)||(s.preventDefault(),(d=this.parent)!=null&&d.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(s,c,d,E){const[M,N]=this.parentDimensions;[d,E]=this.screenToPageTranslation(d,E),this.x=(s+d)/M,this.y=(c+E)/N,this.fixAndSetPosition()}translate(s,c){X(this,h,Ue).call(this,this.parentDimensions,s,c)}translateInPage(s,c){X(this,h,Ue).call(this,this.pageDimensions,s,c),this.div.scrollIntoView({block:"nearest"})}drag(s,c){const[d,E]=this.parentDimensions;if(this.x+=s/d,this.y+=c/E,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:tt,y:lt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,tt,lt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:M,y:N}=this;const[st,Z]=X(this,m,je).call(this);M+=st,N+=Z,this.div.style.left=`${(100*M).toFixed(2)}%`,this.div.style.top=`${(100*N).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[s,c]=this.pageDimensions;let{x:d,y:E,width:M,height:N}=this;switch(M*=s,N*=c,d*=s,E*=c,this.rotation){case 0:d=Math.max(0,Math.min(s-M,d)),E=Math.max(0,Math.min(c-N,E));break;case 90:d=Math.max(0,Math.min(s-N,d)),E=Math.min(c,Math.max(M,E));break;case 180:d=Math.min(s,Math.max(M,d)),E=Math.min(c,Math.max(N,E));break;case 270:d=Math.min(s,Math.max(N,d)),E=Math.max(0,Math.min(c-M,E));break}this.x=d/=s,this.y=E/=c;const[st,Z]=X(this,m,je).call(this);d+=st,E+=Z;const{style:tt}=this.div;tt.left=`${(100*d).toFixed(2)}%`,tt.top=`${(100*E).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(s,c){var d;return X(d=n,R,$e).call(d,s,c,this.parentRotation)}pageTranslationToScreen(s,c){var d;return X(d=n,R,$e).call(d,s,c,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:s,pageDimensions:[c,d]}=this,E=c*s,M=d*s;return p.FeatureTest.isCSSRoundSupported?[Math.round(E),Math.round(M)]:[E,M]}setDims(s,c){var M;const[d,E]=this.parentDimensions;this.div.style.width=`${(100*s/d).toFixed(2)}%`,t(this,C)||(this.div.style.height=`${(100*c/E).toFixed(2)}%`),(M=t(this,g))==null||M.classList.toggle("small",s<n.SMALL_EDITOR_SIZE||c<n.SMALL_EDITOR_SIZE)}fixDims(){const{style:s}=this.div,{height:c,width:d}=s,E=d.endsWith("%"),M=!t(this,C)&&c.endsWith("%");if(E&&M)return;const[N,st]=this.parentDimensions;E||(s.width=`${(100*parseFloat(d)/N).toFixed(2)}%`),!t(this,C)&&!M&&(s.height=`${(100*parseFloat(c)/st).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,g))return;const s=rt(this,g,document.createElement("button"));s.className="altText";const c=await n._l10nPromise.get("editor_alt_text_button_label");s.textContent=c,s.setAttribute("aria-label",c),s.tabIndex="0",s.addEventListener("contextmenu",V.noContextMenu),s.addEventListener("pointerdown",d=>d.stopPropagation()),s.addEventListener("click",d=>{d.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),s.addEventListener("keydown",d=>{d.target===s&&d.key==="Enter"&&(d.preventDefault(),this._uiManager.editAltText(this))}),X(this,gt,We).call(this),this.div.append(s),n.SMALL_EDITOR_SIZE||(n.SMALL_EDITOR_SIZE=Math.min(128,Math.round(s.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,F),decorative:t(this,x)}}set altTextData({altText:s,decorative:c}){t(this,F)===s&&t(this,x)===c||(rt(this,F,s),rt(this,x,c),X(this,gt,We).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,y)),this.div.addEventListener("focusout",t(this,u));const[s,c]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*c/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/c).toFixed(2)}%`);const[d,E]=this.getInitialTranslation();return this.translate(d,E),(0,a.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(s){const{isMac:c}=p.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&c){s.preventDefault();return}rt(this,_,!0),X(this,Tt,Tn).call(this,s)}moveInDOM(){var s;(s=this.parent)==null||s.moveEditorInDOM(this)}_setParentAndPosition(s,c,d){s.changeParent(this),this.x=c,this.y=d,this.fixAndSetPosition()}getRect(s,c){const d=this.parentScale,[E,M]=this.pageDimensions,[N,st]=this.pageTranslation,Z=s/d,tt=c/d,lt=this.x*E,mt=this.y*M,ht=this.width*E,kt=this.height*M;switch(this.rotation){case 0:return[lt+Z+N,M-mt-tt-kt+st,lt+Z+ht+N,M-mt-tt+st];case 90:return[lt+tt+N,M-mt+Z+st,lt+tt+kt+N,M-mt+Z+ht+st];case 180:return[lt-Z-ht+N,M-mt+tt+st,lt-Z+N,M-mt+tt+kt+st];case 270:return[lt-tt-kt+N,M-mt-Z-ht+st,lt-tt+N,M-mt-Z+st];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(s,c){const[d,E,M,N]=s,st=M-d,Z=N-E;switch(this.rotation){case 0:return[d,c-N,st,Z];case 90:return[d,c-E,Z,st];case 180:return[M,c-E,st,Z];case 270:return[M,c-N,Z,st];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){rt(this,T,!0)}disableEditMode(){rt(this,T,!1)}isInEditMode(){return t(this,T)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var s,c;(s=this.div)==null||s.addEventListener("focusin",t(this,y)),(c=this.div)==null||c.addEventListener("focusout",t(this,u))}serialize(s=!1,c=null){(0,p.unreachable)("An editor must be serializable")}static deserialize(s,c,d){const E=new this.prototype.constructor({parent:c,id:c.getNextId(),uiManager:d});E.rotation=s.rotation;const[M,N]=E.pageDimensions,[st,Z,tt,lt]=E.getRectInCurrentCoords(s.rect,N);return E.x=st/M,E.y=Z/N,E.width=tt/M,E.height=lt/N,E}remove(){var s;this.div.removeEventListener("focusin",t(this,y)),this.div.removeEventListener("focusout",t(this,u)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(s=t(this,g))==null||s.remove(),rt(this,g,null),rt(this,D,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(X(this,S,vn).call(this),t(this,v).classList.remove("hidden"))}select(){var s;this.makeResizable(),(s=this.div)==null||s.classList.add("selectedEditor")}unselect(){var s,c,d;(s=t(this,v))==null||s.classList.add("hidden"),(c=this.div)==null||c.classList.remove("selectedEditor"),(d=this.div)!=null&&d.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(s,c){}disableEditing(){t(this,g)&&(t(this,g).hidden=!0)}enableEditing(){t(this,g)&&(t(this,g).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,P)}set isEditing(s){rt(this,P,s),this.parent&&(s?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(s,c){rt(this,C,!0);const d=s/c,{style:E}=this.div;E.aspectRatio=d,E.height="auto"}static get MIN_SIZE(){return 16}};F=new WeakMap,x=new WeakMap,g=new WeakMap,D=new WeakMap,L=new WeakMap,C=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,P=new WeakMap,T=new WeakMap,A=new WeakMap,o=new WeakMap,h=new WeakSet,Ue=function([s,c],d,E){[d,E]=this.screenToPageTranslation(d,E),this.x+=d/s,this.y+=E/c,this.fixAndSetPosition()},m=new WeakSet,je=function(){const[s,c]=this.parentDimensions,{_borderLineWidth:d}=n,E=d/s,M=d/c;switch(this.rotation){case 90:return[-E,M];case 180:return[E,M];case 270:return[E,-M];default:return[-E,-M]}},R=new WeakSet,$e=function(s,c,d){switch(d){case 90:return[c,-s];case 180:return[-s,-c];case 270:return[-c,s];default:return[s,c]}},$=new WeakSet,He=function(s){switch(s){case 90:{const[c,d]=this.pageDimensions;return[0,-c/d,d/c,0]}case 180:return[-1,0,0,-1];case 270:{const[c,d]=this.pageDimensions;return[0,c/d,-d/c,0]}default:return[1,0,0,1]}},S=new WeakSet,vn=function(){if(t(this,v))return;rt(this,v,document.createElement("div")),t(this,v).classList.add("resizers");const s=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||s.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const c of s){const d=document.createElement("div");t(this,v).append(d),d.classList.add("resizer",c),d.addEventListener("pointerdown",X(this,it,En).bind(this,c)),d.addEventListener("contextmenu",V.noContextMenu)}this.div.prepend(t(this,v))},it=new WeakSet,En=function(s,c){c.preventDefault();const{isMac:d}=p.FeatureTest.platform;if(c.button!==0||c.ctrlKey&&d)return;const E=X(this,W,Sn).bind(this,s),M=this._isDraggable;this._isDraggable=!1;const N={passive:!0,capture:!0};window.addEventListener("pointermove",E,N);const st=this.x,Z=this.y,tt=this.width,lt=this.height,mt=this.parent.div.style.cursor,ht=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(c.target).cursor;const kt=()=>{this._isDraggable=M,window.removeEventListener("pointerup",kt),window.removeEventListener("blur",kt),window.removeEventListener("pointermove",E,N),this.parent.div.style.cursor=mt,this.div.style.cursor=ht;const Bt=this.x,Et=this.y,Dt=this.width,pt=this.height;Bt===st&&Et===Z&&Dt===tt&&pt===lt||this.addCommands({cmd:()=>{this.width=Dt,this.height=pt,this.x=Bt,this.y=Et;const[et,nt]=this.parentDimensions;this.setDims(et*Dt,nt*pt),this.fixAndSetPosition()},undo:()=>{this.width=tt,this.height=lt,this.x=st,this.y=Z;const[et,nt]=this.parentDimensions;this.setDims(et*tt,nt*lt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",kt),window.addEventListener("blur",kt)},W=new WeakSet,Sn=function(s,c){const[d,E]=this.parentDimensions,M=this.x,N=this.y,st=this.width,Z=this.height,tt=n.MIN_SIZE/d,lt=n.MIN_SIZE/E,mt=_t=>Math.round(_t*1e4)/1e4,ht=X(this,$,He).call(this,this.rotation),kt=(_t,At)=>[ht[0]*_t+ht[2]*At,ht[1]*_t+ht[3]*At],Bt=X(this,$,He).call(this,360-this.rotation),Et=(_t,At)=>[Bt[0]*_t+Bt[2]*At,Bt[1]*_t+Bt[3]*At];let Dt,pt,et=!1,nt=!1;switch(s){case"topLeft":et=!0,Dt=(_t,At)=>[0,0],pt=(_t,At)=>[_t,At];break;case"topMiddle":Dt=(_t,At)=>[_t/2,0],pt=(_t,At)=>[_t/2,At];break;case"topRight":et=!0,Dt=(_t,At)=>[_t,0],pt=(_t,At)=>[0,At];break;case"middleRight":nt=!0,Dt=(_t,At)=>[_t,At/2],pt=(_t,At)=>[0,At/2];break;case"bottomRight":et=!0,Dt=(_t,At)=>[_t,At],pt=(_t,At)=>[0,0];break;case"bottomMiddle":Dt=(_t,At)=>[_t/2,At],pt=(_t,At)=>[_t/2,0];break;case"bottomLeft":et=!0,Dt=(_t,At)=>[0,At],pt=(_t,At)=>[_t,0];break;case"middleLeft":nt=!0,Dt=(_t,At)=>[0,At/2],pt=(_t,At)=>[_t,At/2];break}const ft=Dt(st,Z),Pt=pt(st,Z);let wt=kt(...Pt);const Ut=mt(M+wt[0]),Gt=mt(N+wt[1]);let jt=1,Vt=1,[Wt,$t]=this.screenToPageTranslation(c.movementX,c.movementY);if([Wt,$t]=Et(Wt/d,$t/E),et){const _t=Math.hypot(st,Z);jt=Vt=Math.max(Math.min(Math.hypot(Pt[0]-ft[0]-Wt,Pt[1]-ft[1]-$t)/_t,1/st,1/Z),tt/st,lt/Z)}else nt?jt=Math.max(tt,Math.min(1,Math.abs(Pt[0]-ft[0]-Wt)))/st:Vt=Math.max(lt,Math.min(1,Math.abs(Pt[1]-ft[1]-$t)))/Z;const zt=mt(st*jt),ut=mt(Z*Vt);wt=kt(...pt(zt,ut));const Q=Ut-wt[0],Y=Gt-wt[1];this.width=zt,this.height=ut,this.x=Q,this.y=Y,this.setDims(d*zt,E*ut),this.fixAndSetPosition()},gt=new WeakSet,We=async function(){var d;const s=t(this,g);if(!s)return;if(!t(this,F)&&!t(this,x)){s.classList.remove("done"),(d=t(this,D))==null||d.remove();return}n._l10nPromise.get("editor_alt_text_edit_button_label").then(E=>{s.setAttribute("aria-label",E)});let c=t(this,D);if(!c){rt(this,D,c=document.createElement("span")),c.className="tooltip",c.setAttribute("role","tooltip");const E=c.id=`alt-text-tooltip-${this.id}`;s.setAttribute("aria-describedby",E);const M=100;s.addEventListener("mouseenter",()=>{rt(this,L,setTimeout(()=>{rt(this,L,null),t(this,D).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},M))}),s.addEventListener("mouseleave",()=>{var N;clearTimeout(t(this,L)),rt(this,L,null),(N=t(this,D))==null||N.classList.remove("show")})}s.classList.add("done"),c.innerText=t(this,x)?await n._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,F),c.parentNode||s.append(c)},Tt=new WeakSet,Tn=function(s){if(!this._isDraggable)return;const c=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let d,E;c&&(d={passive:!0,capture:!0},E=N=>{const[st,Z]=this.screenToPageTranslation(N.movementX,N.movementY);this._uiManager.dragSelectedEditors(st,Z)},window.addEventListener("pointermove",E,d));const M=()=>{if(window.removeEventListener("pointerup",M),window.removeEventListener("blur",M),c&&window.removeEventListener("pointermove",E,d),rt(this,_,!1),!this._uiManager.endDragSession()){const{isMac:N}=p.FeatureTest.platform;s.ctrlKey&&!N||s.shiftKey||s.metaKey&&N?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",M),window.addEventListener("blur",M)},B(n,R),ee(n,"_borderLineWidth",-1),ee(n,"_colorManager",new a.ColorManager),ee(n,"_zIndex",1),ee(n,"SMALL_EDITOR_SIZE",0);let j=n;r.AnnotationEditor=j;class dt extends j{constructor(s){super(s),this.annotationElementId=s.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(H,r,U)=>{var C,v,y,u,_,Ge,A,o,h,k,m,Pn,f,$,G,S,q,it,ot,W,ct,gt,vt,Tt,w,n,i,s,c,d,E,M,N,st,Z,tt,lt,mt,ht,kt,Bt,Et,Dt,pt,et,nt,ft,wn,wt,Ve,Gt,ze,Vt,Pe,$t,Xe,ut,qe,Y,re,At,me,Zt,Cn,St,xn,Ct,Ye,Nt,be,yt,Ke;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardManager=r.CommandManager=r.ColorManager=r.AnnotationEditorUIManager=void 0,r.bindEvents=V,r.opacityToHex=j;var a=U(1),p=U(6);function V(I,e,b){for(const O of b)e.addEventListener(O,I[O].bind(I))}function j(I){return Math.round(Math.min(255,Math.max(1,255*I))).toString(16).padStart(2,"0")}class dt{constructor(){B(this,C,0)}getId(){return`${a.AnnotationEditorPrefix}${ge(this,C)._++}`}}C=new WeakMap;const T=class T{constructor(){B(this,_);B(this,v,(0,a.getUuid)());B(this,y,0);B(this,u,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',O=new OffscreenCanvas(1,3).getContext("2d"),z=new Image;z.src=e;const K=z.decode().then(()=>(O.drawImage(z,0,0,1,1,0,0,1,3),new Uint32Array(O.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,a.shadow)(this,"_isSVGFittingCanvas",K)}async getFromFile(e){const{lastModified:b,name:O,size:z,type:K}=e;return X(this,_,Ge).call(this,`${b}_${O}_${z}_${K}`,e)}async getFromUrl(e){return X(this,_,Ge).call(this,e,e)}async getFromId(e){t(this,u)||rt(this,u,new Map);const b=t(this,u).get(e);return b?b.bitmap?(b.refCounter+=1,b):b.file?this.getFromFile(b.file):this.getFromUrl(b.url):null}getSvgUrl(e){const b=t(this,u).get(e);return b!=null&&b.isSvg?b.svgUrl:null}deleteId(e){t(this,u)||rt(this,u,new Map);const b=t(this,u).get(e);b&&(b.refCounter-=1,b.refCounter===0&&(b.bitmap=null))}isValidId(e){return e.startsWith(`image_${t(this,v)}_`)}};v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakSet,Ge=async function(e,b){t(this,u)||rt(this,u,new Map);let O=t(this,u).get(e);if(O===null)return null;if(O!=null&&O.bitmap)return O.refCounter+=1,O;try{O||(O={bitmap:null,id:`image_${t(this,v)}_${ge(this,y)._++}`,refCounter:0,isSvg:!1});let z;if(typeof b=="string"){O.url=b;const K=await fetch(b);if(!K.ok)throw new Error(K.statusText);z=await K.blob()}else z=O.file=b;if(z.type==="image/svg+xml"){const K=T._isSVGFittingCanvas,at=new FileReader,bt=new Image,Rt=new Promise((xt,Xt)=>{bt.onload=()=>{O.bitmap=bt,O.isSvg=!0,xt()},at.onload=async()=>{const Ft=O.svgUrl=at.result;bt.src=await K?`${Ft}#svgView(preserveAspectRatio(none))`:Ft},bt.onerror=at.onerror=Xt});at.readAsDataURL(z),await Rt}else O.bitmap=await createImageBitmap(z);O.refCounter=1}catch(z){console.error(z),O=null}return t(this,u).set(e,O),O&&t(this,u).set(O.id,O),O};let F=T;class x{constructor(e=128){B(this,A,[]);B(this,o,!1);B(this,h,void 0);B(this,k,-1);rt(this,h,e)}add({cmd:e,undo:b,mustExec:O,type:z=NaN,overwriteIfSameType:K=!1,keepUndo:at=!1}){if(O&&e(),t(this,o))return;const bt={cmd:e,undo:b,type:z};if(t(this,k)===-1){t(this,A).length>0&&(t(this,A).length=0),rt(this,k,0),t(this,A).push(bt);return}if(K&&t(this,A)[t(this,k)].type===z){at&&(bt.undo=t(this,A)[t(this,k)].undo),t(this,A)[t(this,k)]=bt;return}const Rt=t(this,k)+1;Rt===t(this,h)?t(this,A).splice(0,1):(rt(this,k,Rt),Rt<t(this,A).length&&t(this,A).splice(Rt)),t(this,A).push(bt)}undo(){t(this,k)!==-1&&(rt(this,o,!0),t(this,A)[t(this,k)].undo(),rt(this,o,!1),rt(this,k,t(this,k)-1))}redo(){t(this,k)<t(this,A).length-1&&(rt(this,k,t(this,k)+1),rt(this,o,!0),t(this,A)[t(this,k)].cmd(),rt(this,o,!1))}hasSomethingToUndo(){return t(this,k)!==-1}hasSomethingToRedo(){return t(this,k)<t(this,A).length-1}destroy(){rt(this,A,null)}}A=new WeakMap,o=new WeakMap,h=new WeakMap,k=new WeakMap,r.CommandManager=x;class g{constructor(e){B(this,m);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:b}=a.FeatureTest.platform;for(const[O,z,K={}]of e)for(const at of O){const bt=at.startsWith("mac+");b&&bt?(this.callbacks.set(at.slice(4),{callback:z,options:K}),this.allKeys.add(at.split("+").at(-1))):!b&&!bt&&(this.callbacks.set(at,{callback:z,options:K}),this.allKeys.add(at.split("+").at(-1)))}}exec(e,b){if(!this.allKeys.has(b.key))return;const O=this.callbacks.get(X(this,m,Pn).call(this,b));if(!O)return;const{callback:z,options:{bubbles:K=!1,args:at=[],checker:bt=null}}=O;bt&&!bt(e,b)||(z.bind(e,...at)(),K||(b.stopPropagation(),b.preventDefault()))}}m=new WeakSet,Pn=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const b=this.buffer.join("+");return this.buffer.length=0,b},r.KeyboardManager=g;const R=class R{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,p.getColorValues)(e),(0,a.shadow)(this,"_colors",e)}convert(e){const b=(0,p.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return b;for(const[O,z]of this._colors)if(z.every((K,at)=>K===b[at]))return R._colorsMapping.get(O);return b}getHexCode(e){const b=this._colors.get(e);return b?a.Util.makeHexColor(...b):e}};ee(R,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let D=R;r.ColorManager=D;const Lt=class Lt{constructor(e,b,O,z,K,at){B(this,ft);B(this,wt);B(this,Gt);B(this,Vt);B(this,$t);B(this,ut);B(this,Y);B(this,At);B(this,Zt);B(this,St);B(this,Ct);B(this,Nt);B(this,yt);B(this,f,null);B(this,$,new Map);B(this,G,new Map);B(this,S,null);B(this,q,null);B(this,it,new x);B(this,ot,0);B(this,W,new Set);B(this,ct,null);B(this,gt,null);B(this,vt,new Set);B(this,Tt,null);B(this,w,new dt);B(this,n,!1);B(this,i,!1);B(this,s,null);B(this,c,a.AnnotationEditorType.NONE);B(this,d,new Set);B(this,E,null);B(this,M,this.blur.bind(this));B(this,N,this.focus.bind(this));B(this,st,this.copy.bind(this));B(this,Z,this.cut.bind(this));B(this,tt,this.paste.bind(this));B(this,lt,this.keydown.bind(this));B(this,mt,this.onEditingAction.bind(this));B(this,ht,this.onPageChanging.bind(this));B(this,kt,this.onScaleChanging.bind(this));B(this,Bt,this.onRotationChanging.bind(this));B(this,Et,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});B(this,Dt,[0,0]);B(this,pt,null);B(this,et,null);B(this,nt,null);rt(this,et,e),rt(this,nt,b),rt(this,S,O),this._eventBus=z,this._eventBus._on("editingaction",t(this,mt)),this._eventBus._on("pagechanging",t(this,ht)),this._eventBus._on("scalechanging",t(this,kt)),this._eventBus._on("rotationchanging",t(this,Bt)),rt(this,q,K.annotationStorage),rt(this,Tt,K.filterFactory),rt(this,E,at),this.viewParameters={realScale:p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const e=Lt.prototype,b=K=>{const{activeElement:at}=document;return at&&t(K,et).contains(at)&&K.hasSomethingToControl()},O=this.TRANSLATE_SMALL,z=this.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new g([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-O,0],checker:b}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-z,0],checker:b}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[O,0],checker:b}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[z,0],checker:b}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-O],checker:b}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-z],checker:b}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,O],checker:b}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,z],checker:b}]]))}destroy(){X(this,Vt,Pe).call(this),X(this,wt,Ve).call(this),this._eventBus._off("editingaction",t(this,mt)),this._eventBus._off("pagechanging",t(this,ht)),this._eventBus._off("scalechanging",t(this,kt)),this._eventBus._off("rotationchanging",t(this,Bt));for(const e of t(this,G).values())e.destroy();t(this,G).clear(),t(this,$).clear(),t(this,vt).clear(),rt(this,f,null),t(this,d).clear(),t(this,it).destroy(),t(this,S).destroy()}get hcmFilter(){return(0,a.shadow)(this,"hcmFilter",t(this,E)?t(this,Tt).addHCMFilter(t(this,E).foreground,t(this,E).background):"none")}get direction(){return(0,a.shadow)(this,"direction",getComputedStyle(t(this,et)).direction)}editAltText(e){var b;(b=t(this,S))==null||b.editAltText(this,e)}onPageChanging({pageNumber:e}){rt(this,ot,e-1)}focusMainContainer(){t(this,et).focus()}findParent(e,b){for(const O of t(this,G).values()){const{x:z,y:K,width:at,height:bt}=O.div.getBoundingClientRect();if(e>=z&&e<=z+at&&b>=K&&b<=K+bt)return O}return null}disableUserSelect(e=!1){t(this,nt).classList.toggle("noUserSelect",e)}addShouldRescale(e){t(this,vt).add(e)}removeShouldRescale(e){t(this,vt).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*p.PixelsPerInch.PDF_TO_CSS_UNITS;for(const b of t(this,vt))b.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&t(this,q)&&!t(this,q).has(e.id)&&t(this,q).setValue(e.id,e)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const b of t(this,d))if(b.div.contains(e)){rt(this,s,[b,e]),b._focusEventsAllowed=!1;break}}focus(){if(!t(this,s))return;const[e,b]=t(this,s);rt(this,s,null),b.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),b.focus()}addEditListeners(){X(this,Gt,ze).call(this),X(this,$t,Xe).call(this)}removeEditListeners(){X(this,Vt,Pe).call(this),X(this,ut,qe).call(this)}copy(e){var O;if(e.preventDefault(),(O=t(this,f))==null||O.commitOrRemove(),!this.hasSelection)return;const b=[];for(const z of t(this,d)){const K=z.serialize(!0);K&&b.push(K)}b.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(b))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:b}=e;for(const K of b.items)for(const at of t(this,gt))if(at.isHandlingMimeForPasting(K.type)){at.paste(K,this.currentLayer);return}let O=b.getData("application/pdfjs");if(!O)return;try{O=JSON.parse(O)}catch(K){(0,a.warn)(`paste: "${K.message}".`);return}if(!Array.isArray(O))return;this.unselectAll();const z=this.currentLayer;try{const K=[];for(const Rt of O){const xt=z.deserialize(Rt);if(!xt)return;K.push(xt)}const at=()=>{for(const Rt of K)X(this,Ct,Ye).call(this,Rt);X(this,yt,Ke).call(this,K)},bt=()=>{for(const Rt of K)Rt.remove()};this.addCommands({cmd:at,undo:bt,mustExec:!0})}catch(K){(0,a.warn)(`paste: "${K.message}".`)}}keydown(e){var b;(b=this.getActive())!=null&&b.shouldGetKeyboardEvents()||Lt._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(X(this,ft,wn).call(this),X(this,Gt,ze).call(this),X(this,$t,Xe).call(this),X(this,Y,re).call(this,{isEditing:t(this,c)!==a.AnnotationEditorType.NONE,isEmpty:X(this,Nt,be).call(this),hasSomethingToUndo:t(this,it).hasSomethingToUndo(),hasSomethingToRedo:t(this,it).hasSomethingToRedo(),hasSelectedEditor:!1})):(X(this,wt,Ve).call(this),X(this,Vt,Pe).call(this),X(this,ut,qe).call(this),X(this,Y,re).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!t(this,gt)){rt(this,gt,e);for(const b of t(this,gt))X(this,At,me).call(this,b.defaultPropertiesToUpdate)}}getId(){return t(this,w).getId()}get currentLayer(){return t(this,G).get(t(this,ot))}getLayer(e){return t(this,G).get(e)}get currentPageIndex(){return t(this,ot)}addLayer(e){t(this,G).set(e.pageIndex,e),t(this,n)?e.enable():e.disable()}removeLayer(e){t(this,G).delete(e.pageIndex)}updateMode(e,b=null){if(t(this,c)!==e){if(rt(this,c,e),e===a.AnnotationEditorType.NONE){this.setEditingState(!1),X(this,St,xn).call(this);return}this.setEditingState(!0),X(this,Zt,Cn).call(this),this.unselectAll();for(const O of t(this,G).values())O.updateMode(e);if(b){for(const O of t(this,$).values())if(O.annotationElementId===b){this.setSelected(O),O.enterInEditMode();break}}}}updateToolbar(e){e!==t(this,c)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,b){if(t(this,gt)){if(e===a.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const O of t(this,d))O.updateParams(e,b);for(const O of t(this,gt))O.updateDefaultParams(e,b)}}enableWaiting(e=!1){if(t(this,i)!==e){rt(this,i,e);for(const b of t(this,G).values())e?b.disableClick():b.enableClick(),b.div.classList.toggle("waiting",e)}}getEditors(e){const b=[];for(const O of t(this,$).values())O.pageIndex===e&&b.push(O);return b}getEditor(e){return t(this,$).get(e)}addEditor(e){t(this,$).set(e.id,e)}removeEditor(e){var b;t(this,$).delete(e.id),this.unselect(e),(!e.annotationElementId||!t(this,W).has(e.annotationElementId))&&((b=t(this,q))==null||b.remove(e.id))}addDeletedAnnotationElement(e){t(this,W).add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return t(this,W).has(e)}removeDeletedAnnotationElement(e){t(this,W).delete(e.annotationElementId),e.deleted=!1}setActiveEditor(e){t(this,f)!==e&&(rt(this,f,e),e&&X(this,At,me).call(this,e.propertiesToUpdate))}toggleSelected(e){if(t(this,d).has(e)){t(this,d).delete(e),e.unselect(),X(this,Y,re).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,d).add(e),e.select(),X(this,At,me).call(this,e.propertiesToUpdate),X(this,Y,re).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const b of t(this,d))b!==e&&b.unselect();t(this,d).clear(),t(this,d).add(e),e.select(),X(this,At,me).call(this,e.propertiesToUpdate),X(this,Y,re).call(this,{hasSelectedEditor:!0})}isSelected(e){return t(this,d).has(e)}unselect(e){e.unselect(),t(this,d).delete(e),X(this,Y,re).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,d).size!==0}undo(){t(this,it).undo(),X(this,Y,re).call(this,{hasSomethingToUndo:t(this,it).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:X(this,Nt,be).call(this)})}redo(){t(this,it).redo(),X(this,Y,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,it).hasSomethingToRedo(),isEmpty:X(this,Nt,be).call(this)})}addCommands(e){t(this,it).add(e),X(this,Y,re).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:X(this,Nt,be).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...t(this,d)],b=()=>{for(const z of e)z.remove()},O=()=>{for(const z of e)X(this,Ct,Ye).call(this,z)};this.addCommands({cmd:b,undo:O,mustExec:!0})}commitOrRemove(){var e;(e=t(this,f))==null||e.commitOrRemove()}hasSomethingToControl(){return t(this,f)||this.hasSelection}selectAll(){for(const e of t(this,d))e.commit();X(this,yt,Ke).call(this,t(this,$).values())}unselectAll(){if(t(this,f)){t(this,f).commitOrRemove();return}if(this.hasSelection){for(const e of t(this,d))e.unselect();t(this,d).clear(),X(this,Y,re).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,b,O=!1){if(O||this.commitOrRemove(),!this.hasSelection)return;t(this,Dt)[0]+=e,t(this,Dt)[1]+=b;const[z,K]=t(this,Dt),at=[...t(this,d)],bt=1e3;t(this,pt)&&clearTimeout(t(this,pt)),rt(this,pt,setTimeout(()=>{rt(this,pt,null),t(this,Dt)[0]=t(this,Dt)[1]=0,this.addCommands({cmd:()=>{for(const Rt of at)t(this,$).has(Rt.id)&&Rt.translateInPage(z,K)},undo:()=>{for(const Rt of at)t(this,$).has(Rt.id)&&Rt.translateInPage(-z,-K)},mustExec:!1})},bt));for(const Rt of at)Rt.translateInPage(e,b)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),rt(this,ct,new Map);for(const e of t(this,d))t(this,ct).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ct))return!1;this.disableUserSelect(!1);const e=t(this,ct);rt(this,ct,null);let b=!1;for(const[{x:z,y:K,pageIndex:at},bt]of e)bt.newX=z,bt.newY=K,bt.newPageIndex=at,b||(b=z!==bt.savedX||K!==bt.savedY||at!==bt.savedPageIndex);if(!b)return!1;const O=(z,K,at,bt)=>{if(t(this,$).has(z.id)){const Rt=t(this,G).get(bt);Rt?z._setParentAndPosition(Rt,K,at):(z.pageIndex=bt,z.x=K,z.y=at)}};return this.addCommands({cmd:()=>{for(const[z,{newX:K,newY:at,newPageIndex:bt}]of e)O(z,K,at,bt)},undo:()=>{for(const[z,{savedX:K,savedY:at,savedPageIndex:bt}]of e)O(z,K,at,bt)},mustExec:!0}),!0}dragSelectedEditors(e,b){if(t(this,ct))for(const O of t(this,ct).keys())O.drag(e,b)}rebuild(e){if(e.parent===null){const b=this.getLayer(e.pageIndex);b?(b.changeParent(e),b.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return t(this,f)===e}getActive(){return t(this,f)}getMode(){return t(this,c)}get imageManager(){return(0,a.shadow)(this,"imageManager",new F)}};f=new WeakMap,$=new WeakMap,G=new WeakMap,S=new WeakMap,q=new WeakMap,it=new WeakMap,ot=new WeakMap,W=new WeakMap,ct=new WeakMap,gt=new WeakMap,vt=new WeakMap,Tt=new WeakMap,w=new WeakMap,n=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,d=new WeakMap,E=new WeakMap,M=new WeakMap,N=new WeakMap,st=new WeakMap,Z=new WeakMap,tt=new WeakMap,lt=new WeakMap,mt=new WeakMap,ht=new WeakMap,kt=new WeakMap,Bt=new WeakMap,Et=new WeakMap,Dt=new WeakMap,pt=new WeakMap,et=new WeakMap,nt=new WeakMap,ft=new WeakSet,wn=function(){window.addEventListener("focus",t(this,N)),window.addEventListener("blur",t(this,M))},wt=new WeakSet,Ve=function(){window.removeEventListener("focus",t(this,N)),window.removeEventListener("blur",t(this,M))},Gt=new WeakSet,ze=function(){window.addEventListener("keydown",t(this,lt),{capture:!0})},Vt=new WeakSet,Pe=function(){window.removeEventListener("keydown",t(this,lt),{capture:!0})},$t=new WeakSet,Xe=function(){document.addEventListener("copy",t(this,st)),document.addEventListener("cut",t(this,Z)),document.addEventListener("paste",t(this,tt))},ut=new WeakSet,qe=function(){document.removeEventListener("copy",t(this,st)),document.removeEventListener("cut",t(this,Z)),document.removeEventListener("paste",t(this,tt))},Y=new WeakSet,re=function(e){Object.entries(e).some(([O,z])=>t(this,Et)[O]!==z)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Et),e)})},At=new WeakSet,me=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Zt=new WeakSet,Cn=function(){if(!t(this,n)){rt(this,n,!0);for(const e of t(this,G).values())e.enable()}},St=new WeakSet,xn=function(){if(this.unselectAll(),t(this,n)){rt(this,n,!1);for(const e of t(this,G).values())e.disable()}},Ct=new WeakSet,Ye=function(e){const b=t(this,G).get(e.pageIndex);b?b.addOrRebuild(e):this.addEditor(e)},Nt=new WeakSet,be=function(){if(t(this,$).size===0)return!0;if(t(this,$).size===1)for(const e of t(this,$).values())return e.isEmpty();return!1},yt=new WeakSet,Ke=function(e){t(this,d).clear();for(const b of e)b.isEmpty()||(t(this,d).add(b),b.select());X(this,Y,re).call(this,{hasSelectedEditor:!0})},ee(Lt,"TRANSLATE_SMALL",1),ee(Lt,"TRANSLATE_BIG",10);let L=Lt;r.AnnotationEditorUIManager=L},(H,r,U)=>{var ot,W,ct,gt,vt,Tt,w,n,i,s,c,d,de,M,ue,st,Je,tt,we,mt,Ce,kt,_e,Et,ye;Object.defineProperty(r,"__esModule",{value:!0}),r.StatTimer=r.RenderingCancelledException=r.PixelsPerInch=r.PageViewport=r.PDFDateString=r.DOMStandardFontDataFactory=r.DOMSVGFactory=r.DOMFilterFactory=r.DOMCanvasFactory=r.DOMCMapReaderFactory=void 0,r.deprecated=k,r.getColorValues=$,r.getCurrentTransform=G,r.getCurrentTransformInverse=S,r.getFilenameFromUrl=_,r.getPdfFilenameFromUrl=P,r.getRGB=f,r.getXfaPageViewport=R,r.isDataScheme=y,r.isPdfFile=u,r.isValidFetchUrl=A,r.loadScript=h,r.noContextMenu=o,r.setLayerDimensions=q;var a=U(7),p=U(1);const V="http://www.w3.org/2000/svg",it=class it{};ee(it,"CSS",96),ee(it,"PDF",72),ee(it,"PDF_TO_CSS_UNITS",it.CSS/it.PDF);let j=it;r.PixelsPerInch=j;class dt extends a.BaseFilterFactory{constructor({docId:nt,ownerDocument:ft=globalThis.document}={}){super();B(this,d);B(this,M);B(this,st);B(this,tt);B(this,mt);B(this,kt);B(this,Et);B(this,ot,void 0);B(this,W,void 0);B(this,ct,void 0);B(this,gt,void 0);B(this,vt,void 0);B(this,Tt,void 0);B(this,w,void 0);B(this,n,void 0);B(this,i,void 0);B(this,s,void 0);B(this,c,0);rt(this,ct,nt),rt(this,gt,ft)}addFilter(nt){if(!nt)return"none";let ft=t(this,d,de).get(nt);if(ft)return ft;let Pt,wt,Ut,Gt;if(nt.length===1){const $t=nt[0],zt=new Array(256);for(let ut=0;ut<256;ut++)zt[ut]=$t[ut]/255;Gt=Pt=wt=Ut=zt.join(",")}else{const[$t,zt,ut]=nt,Q=new Array(256),Y=new Array(256),_t=new Array(256);for(let At=0;At<256;At++)Q[At]=$t[At]/255,Y[At]=zt[At]/255,_t[At]=ut[At]/255;Pt=Q.join(","),wt=Y.join(","),Ut=_t.join(","),Gt=`${Pt}${wt}${Ut}`}if(ft=t(this,d,de).get(Gt),ft)return t(this,d,de).set(nt,ft),ft;const jt=`g_${t(this,ct)}_transfer_map_${ge(this,c)._++}`,Vt=`url(#${jt})`;t(this,d,de).set(nt,Vt),t(this,d,de).set(Gt,Vt);const Wt=X(this,tt,we).call(this,jt);return X(this,kt,_e).call(this,Pt,wt,Ut,Wt),Vt}addHCMFilter(nt,ft){var zt;const Pt=`${nt}-${ft}`;if(t(this,Tt)===Pt)return t(this,w);if(rt(this,Tt,Pt),rt(this,w,"none"),(zt=t(this,vt))==null||zt.remove(),!nt||!ft)return t(this,w);const wt=X(this,Et,ye).call(this,nt);nt=p.Util.makeHexColor(...wt);const Ut=X(this,Et,ye).call(this,ft);if(ft=p.Util.makeHexColor(...Ut),t(this,M,ue).style.color="",nt==="#000000"&&ft==="#ffffff"||nt===ft)return t(this,w);const Gt=new Array(256);for(let ut=0;ut<=255;ut++){const Q=ut/255;Gt[ut]=Q<=.03928?Q/12.92:((Q+.055)/1.055)**2.4}const jt=Gt.join(","),Vt=`g_${t(this,ct)}_hcm_filter`,Wt=rt(this,n,X(this,tt,we).call(this,Vt));X(this,kt,_e).call(this,jt,jt,jt,Wt),X(this,st,Je).call(this,Wt);const $t=(ut,Q)=>{const Y=wt[ut]/255,_t=Ut[ut]/255,At=new Array(Q+1);for(let te=0;te<=Q;te++)At[te]=Y+te/Q*(_t-Y);return At.join(",")};return X(this,kt,_e).call(this,$t(0,5),$t(1,5),$t(2,5),Wt),rt(this,w,`url(#${Vt})`),t(this,w)}addHighlightHCMFilter(nt,ft,Pt,wt){var _t;const Ut=`${nt}-${ft}-${Pt}-${wt}`;if(t(this,i)===Ut)return t(this,s);if(rt(this,i,Ut),rt(this,s,"none"),(_t=t(this,n))==null||_t.remove(),!nt||!ft)return t(this,s);const[Gt,jt]=[nt,ft].map(X(this,Et,ye).bind(this));let Vt=Math.round(.2126*Gt[0]+.7152*Gt[1]+.0722*Gt[2]),Wt=Math.round(.2126*jt[0]+.7152*jt[1]+.0722*jt[2]),[$t,zt]=[Pt,wt].map(X(this,Et,ye).bind(this));Wt<Vt&&([Vt,Wt,$t,zt]=[Wt,Vt,zt,$t]),t(this,M,ue).style.color="";const ut=(At,te,Zt)=>{const J=new Array(256),St=(Wt-Vt)/Zt,It=At/255,Ct=(te-At)/(255*Zt);let Ot=0;for(let Nt=0;Nt<=Zt;Nt++){const Jt=Math.round(Vt+Nt*St),yt=It+Nt*Ct;for(let Yt=Ot;Yt<=Jt;Yt++)J[Yt]=yt;Ot=Jt+1}for(let Nt=Ot;Nt<256;Nt++)J[Nt]=J[Ot-1];return J.join(",")},Q=`g_${t(this,ct)}_hcm_highlight_filter`,Y=rt(this,n,X(this,tt,we).call(this,Q));return X(this,st,Je).call(this,Y),X(this,kt,_e).call(this,ut($t[0],zt[0],5),ut($t[1],zt[1],5),ut($t[2],zt[2],5),Y),rt(this,s,`url(#${Q})`),t(this,s)}destroy(nt=!1){nt&&(t(this,w)||t(this,s))||(t(this,W)&&(t(this,W).parentNode.parentNode.remove(),rt(this,W,null)),t(this,ot)&&(t(this,ot).clear(),rt(this,ot,null)),rt(this,c,0))}}ot=new WeakMap,W=new WeakMap,ct=new WeakMap,gt=new WeakMap,vt=new WeakMap,Tt=new WeakMap,w=new WeakMap,n=new WeakMap,i=new WeakMap,s=new WeakMap,c=new WeakMap,d=new WeakSet,de=function(){return t(this,ot)||rt(this,ot,new Map)},M=new WeakSet,ue=function(){if(!t(this,W)){const nt=t(this,gt).createElement("div"),{style:ft}=nt;ft.visibility="hidden",ft.contain="strict",ft.width=ft.height=0,ft.position="absolute",ft.top=ft.left=0,ft.zIndex=-1;const Pt=t(this,gt).createElementNS(V,"svg");Pt.setAttribute("width",0),Pt.setAttribute("height",0),rt(this,W,t(this,gt).createElementNS(V,"defs")),nt.append(Pt),Pt.append(t(this,W)),t(this,gt).body.append(nt)}return t(this,W)},st=new WeakSet,Je=function(nt){const ft=t(this,gt).createElementNS(V,"feColorMatrix");ft.setAttribute("type","matrix"),ft.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),nt.append(ft)},tt=new WeakSet,we=function(nt){const ft=t(this,gt).createElementNS(V,"filter");return ft.setAttribute("color-interpolation-filters","sRGB"),ft.setAttribute("id",nt),t(this,M,ue).append(ft),ft},mt=new WeakSet,Ce=function(nt,ft,Pt){const wt=t(this,gt).createElementNS(V,ft);wt.setAttribute("type","discrete"),wt.setAttribute("tableValues",Pt),nt.append(wt)},kt=new WeakSet,_e=function(nt,ft,Pt,wt){const Ut=t(this,gt).createElementNS(V,"feComponentTransfer");wt.append(Ut),X(this,mt,Ce).call(this,Ut,"feFuncR",nt),X(this,mt,Ce).call(this,Ut,"feFuncG",ft),X(this,mt,Ce).call(this,Ut,"feFuncB",Pt)},Et=new WeakSet,ye=function(nt){return t(this,M,ue).style.color=nt,f(getComputedStyle(t(this,M,ue)).getPropertyValue("color"))},r.DOMFilterFactory=dt;class F extends a.BaseCanvasFactory{constructor({ownerDocument:et=globalThis.document}={}){super(),this._document=et}_createCanvas(et,nt){const ft=this._document.createElement("canvas");return ft.width=et,ft.height=nt,ft}}r.DOMCanvasFactory=F;async function x(pt,et=!1){if(A(pt,document.baseURI)){const nt=await fetch(pt);if(!nt.ok)throw new Error(nt.statusText);return et?new Uint8Array(await nt.arrayBuffer()):(0,p.stringToBytes)(await nt.text())}return new Promise((nt,ft)=>{const Pt=new XMLHttpRequest;Pt.open("GET",pt,!0),et&&(Pt.responseType="arraybuffer"),Pt.onreadystatechange=()=>{if(Pt.readyState===XMLHttpRequest.DONE){if(Pt.status===200||Pt.status===0){let wt;if(et&&Pt.response?wt=new Uint8Array(Pt.response):!et&&Pt.responseText&&(wt=(0,p.stringToBytes)(Pt.responseText)),wt){nt(wt);return}}ft(new Error(Pt.statusText))}},Pt.send(null)})}class g extends a.BaseCMapReaderFactory{_fetchData(et,nt){return x(et,this.isCompressed).then(ft=>({cMapData:ft,compressionType:nt}))}}r.DOMCMapReaderFactory=g;class D extends a.BaseStandardFontDataFactory{_fetchData(et){return x(et,!0)}}r.DOMStandardFontDataFactory=D;class L extends a.BaseSVGFactory{_createSVG(et){return document.createElementNS(V,et)}}r.DOMSVGFactory=L;class C{constructor({viewBox:et,scale:nt,rotation:ft,offsetX:Pt=0,offsetY:wt=0,dontFlip:Ut=!1}){this.viewBox=et,this.scale=nt,this.rotation=ft,this.offsetX=Pt,this.offsetY=wt;const Gt=(et[2]+et[0])/2,jt=(et[3]+et[1])/2;let Vt,Wt,$t,zt;switch(ft%=360,ft<0&&(ft+=360),ft){case 180:Vt=-1,Wt=0,$t=0,zt=1;break;case 90:Vt=0,Wt=1,$t=1,zt=0;break;case 270:Vt=0,Wt=-1,$t=-1,zt=0;break;case 0:Vt=1,Wt=0,$t=0,zt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ut&&($t=-$t,zt=-zt);let ut,Q,Y,_t;Vt===0?(ut=Math.abs(jt-et[1])*nt+Pt,Q=Math.abs(Gt-et[0])*nt+wt,Y=(et[3]-et[1])*nt,_t=(et[2]-et[0])*nt):(ut=Math.abs(Gt-et[0])*nt+Pt,Q=Math.abs(jt-et[1])*nt+wt,Y=(et[2]-et[0])*nt,_t=(et[3]-et[1])*nt),this.transform=[Vt*nt,Wt*nt,$t*nt,zt*nt,ut-Vt*nt*Gt-$t*nt*jt,Q-Wt*nt*Gt-zt*nt*jt],this.width=Y,this.height=_t}get rawDims(){const{viewBox:et}=this;return(0,p.shadow)(this,"rawDims",{pageWidth:et[2]-et[0],pageHeight:et[3]-et[1],pageX:et[0],pageY:et[1]})}clone({scale:et=this.scale,rotation:nt=this.rotation,offsetX:ft=this.offsetX,offsetY:Pt=this.offsetY,dontFlip:wt=!1}={}){return new C({viewBox:this.viewBox.slice(),scale:et,rotation:nt,offsetX:ft,offsetY:Pt,dontFlip:wt})}convertToViewportPoint(et,nt){return p.Util.applyTransform([et,nt],this.transform)}convertToViewportRectangle(et){const nt=p.Util.applyTransform([et[0],et[1]],this.transform),ft=p.Util.applyTransform([et[2],et[3]],this.transform);return[nt[0],nt[1],ft[0],ft[1]]}convertToPdfPoint(et,nt){return p.Util.applyInverseTransform([et,nt],this.transform)}}r.PageViewport=C;class v extends p.BaseException{constructor(et,nt=0){super(et,"RenderingCancelledException"),this.extraDelay=nt}}r.RenderingCancelledException=v;function y(pt){const et=pt.length;let nt=0;for(;nt<et&&pt[nt].trim()==="";)nt++;return pt.substring(nt,nt+5).toLowerCase()==="data:"}function u(pt){return typeof pt=="string"&&/\.pdf$/i.test(pt)}function _(pt,et=!1){return et||([pt]=pt.split(/[#?]/,1)),pt.substring(pt.lastIndexOf("/")+1)}function P(pt,et="document.pdf"){if(typeof pt!="string")return et;if(y(pt))return(0,p.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),et;const nt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ft=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Pt=nt.exec(pt);let wt=ft.exec(Pt[1])||ft.exec(Pt[2])||ft.exec(Pt[3]);if(wt&&(wt=wt[0],wt.includes("%")))try{wt=ft.exec(decodeURIComponent(wt))[0]}catch{}return wt||et}class T{constructor(){ee(this,"started",Object.create(null));ee(this,"times",[])}time(et){et in this.started&&(0,p.warn)(`Timer is already running for ${et}`),this.started[et]=Date.now()}timeEnd(et){et in this.started||(0,p.warn)(`Timer has not been started for ${et}`),this.times.push({name:et,start:this.started[et],end:Date.now()}),delete this.started[et]}toString(){const et=[];let nt=0;for(const{name:ft}of this.times)nt=Math.max(ft.length,nt);for(const{name:ft,start:Pt,end:wt}of this.times)et.push(`${ft.padEnd(nt)} ${wt-Pt}ms
`);return et.join("")}}r.StatTimer=T;function A(pt,et){try{const{protocol:nt}=et?new URL(pt,et):new URL(pt);return nt==="http:"||nt==="https:"}catch{return!1}}function o(pt){pt.preventDefault()}function h(pt,et=!1){return new Promise((nt,ft)=>{const Pt=document.createElement("script");Pt.src=pt,Pt.onload=function(wt){et&&Pt.remove(),nt(wt)},Pt.onerror=function(){ft(new Error(`Cannot load script at: ${Pt.src}`))},(document.head||document.documentElement).append(Pt)})}function k(pt){console.log("Deprecated API usage: "+pt)}let m;class l{static toDateObject(et){if(!et||typeof et!="string")return null;m||(m=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const nt=m.exec(et);if(!nt)return null;const ft=parseInt(nt[1],10);let Pt=parseInt(nt[2],10);Pt=Pt>=1&&Pt<=12?Pt-1:0;let wt=parseInt(nt[3],10);wt=wt>=1&&wt<=31?wt:1;let Ut=parseInt(nt[4],10);Ut=Ut>=0&&Ut<=23?Ut:0;let Gt=parseInt(nt[5],10);Gt=Gt>=0&&Gt<=59?Gt:0;let jt=parseInt(nt[6],10);jt=jt>=0&&jt<=59?jt:0;const Vt=nt[7]||"Z";let Wt=parseInt(nt[8],10);Wt=Wt>=0&&Wt<=23?Wt:0;let $t=parseInt(nt[9],10)||0;return $t=$t>=0&&$t<=59?$t:0,Vt==="-"?(Ut+=Wt,Gt+=$t):Vt==="+"&&(Ut-=Wt,Gt-=$t),new Date(Date.UTC(ft,Pt,wt,Ut,Gt,jt))}}r.PDFDateString=l;function R(pt,{scale:et=1,rotation:nt=0}){const{width:ft,height:Pt}=pt.attributes.style,wt=[0,0,parseInt(ft),parseInt(Pt)];return new C({viewBox:wt,scale:et,rotation:nt})}function f(pt){if(pt.startsWith("#")){const et=parseInt(pt.slice(1),16);return[(et&16711680)>>16,(et&65280)>>8,et&255]}return pt.startsWith("rgb(")?pt.slice(4,-1).split(",").map(et=>parseInt(et)):pt.startsWith("rgba(")?pt.slice(5,-1).split(",").map(et=>parseInt(et)).slice(0,3):((0,p.warn)(`Not a valid color format: "${pt}"`),[0,0,0])}function $(pt){const et=document.createElement("span");et.style.visibility="hidden",document.body.append(et);for(const nt of pt.keys()){et.style.color=nt;const ft=window.getComputedStyle(et).color;pt.set(nt,f(ft))}et.remove()}function G(pt){const{a:et,b:nt,c:ft,d:Pt,e:wt,f:Ut}=pt.getTransform();return[et,nt,ft,Pt,wt,Ut]}function S(pt){const{a:et,b:nt,c:ft,d:Pt,e:wt,f:Ut}=pt.getTransform().invertSelf();return[et,nt,ft,Pt,wt,Ut]}function q(pt,et,nt=!1,ft=!0){if(et instanceof C){const{pageWidth:Pt,pageHeight:wt}=et.rawDims,{style:Ut}=pt,Gt=p.FeatureTest.isCSSRoundSupported,jt=`var(--scale-factor) * ${Pt}px`,Vt=`var(--scale-factor) * ${wt}px`,Wt=Gt?`round(${jt}, 1px)`:`calc(${jt})`,$t=Gt?`round(${Vt}, 1px)`:`calc(${Vt})`;!nt||et.rotation%180===0?(Ut.width=Wt,Ut.height=$t):(Ut.width=$t,Ut.height=Wt)}ft&&pt.setAttribute("data-main-rotation",et.rotation)}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStandardFontDataFactory=r.BaseSVGFactory=r.BaseFilterFactory=r.BaseCanvasFactory=r.BaseCMapReaderFactory=void 0;var a=U(1);class p{constructor(){this.constructor===p&&(0,a.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(g){return"none"}addHCMFilter(g,D){return"none"}addHighlightHCMFilter(g,D,L,C){return"none"}destroy(g=!1){}}r.BaseFilterFactory=p;class V{constructor(){this.constructor===V&&(0,a.unreachable)("Cannot initialize BaseCanvasFactory.")}create(g,D){if(g<=0||D<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(g,D);return{canvas:L,context:L.getContext("2d")}}reset(g,D,L){if(!g.canvas)throw new Error("Canvas is not specified");if(D<=0||L<=0)throw new Error("Invalid canvas size");g.canvas.width=D,g.canvas.height=L}destroy(g){if(!g.canvas)throw new Error("Canvas is not specified");g.canvas.width=0,g.canvas.height=0,g.canvas=null,g.context=null}_createCanvas(g,D){(0,a.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=V;class j{constructor({baseUrl:g=null,isCompressed:D=!0}){this.constructor===j&&(0,a.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=g,this.isCompressed=D}async fetch({name:g}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!g)throw new Error("CMap name must be specified.");const D=this.baseUrl+g+(this.isCompressed?".bcmap":""),L=this.isCompressed?a.CMapCompressionType.BINARY:a.CMapCompressionType.NONE;return this._fetchData(D,L).catch(C=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${D}`)})}_fetchData(g,D){(0,a.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=j;class dt{constructor({baseUrl:g=null}){this.constructor===dt&&(0,a.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=g}async fetch({filename:g}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!g)throw new Error("Font filename must be specified.");const D=`${this.baseUrl}${g}`;return this._fetchData(D).catch(L=>{throw new Error(`Unable to load font data at: ${D}`)})}_fetchData(g){(0,a.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=dt;class F{constructor(){this.constructor===F&&(0,a.unreachable)("Cannot initialize BaseSVGFactory.")}create(g,D,L=!1){if(g<=0||D<=0)throw new Error("Invalid SVG dimensions");const C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),L||(C.setAttribute("width",`${g}px`),C.setAttribute("height",`${D}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${g} ${D}`),C}createElement(g){if(typeof g!="string")throw new Error("Invalid SVG element type");return this._createSVG(g)}_createSVG(g){(0,a.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=F},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MurmurHash3_64=void 0;var a=U(1);const p=3285377520,V=4294901760,j=65535;class dt{constructor(x){this.h1=x?x&4294967295:p,this.h2=x?x&4294967295:p}update(x){let g,D;if(typeof x=="string"){g=new Uint8Array(x.length*2),D=0;for(let k=0,m=x.length;k<m;k++){const l=x.charCodeAt(k);l<=255?g[D++]=l:(g[D++]=l>>>8,g[D++]=l&255)}}else if((0,a.isArrayBuffer)(x))g=x.slice(),D=g.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const L=D>>2,C=D-L*4,v=new Uint32Array(g.buffer,0,L);let y=0,u=0,_=this.h1,P=this.h2;const T=3432918353,A=461845907,o=T&j,h=A&j;for(let k=0;k<L;k++)k&1?(y=v[k],y=y*T&V|y*o&j,y=y<<15|y>>>17,y=y*A&V|y*h&j,_^=y,_=_<<13|_>>>19,_=_*5+3864292196):(u=v[k],u=u*T&V|u*o&j,u=u<<15|u>>>17,u=u*A&V|u*h&j,P^=u,P=P<<13|P>>>19,P=P*5+3864292196);switch(y=0,C){case 3:y^=g[L*4+2]<<16;case 2:y^=g[L*4+1]<<8;case 1:y^=g[L*4],y=y*T&V|y*o&j,y=y<<15|y>>>17,y=y*A&V|y*h&j,L&1?_^=y:P^=y}this.h1=_,this.h2=P}hexdigest(){let x=this.h1,g=this.h2;return x^=g>>>1,x=x*3981806797&V|x*36045&j,g=g*4283543511&V|((g<<16|x>>>16)*2950163797&V)>>>16,x^=g>>>1,x=x*444984403&V|x*60499&j,g=g*3301882366&V|((g<<16|x>>>16)*3120437893&V)>>>16,x^=g>>>1,(x>>>0).toString(16).padStart(8,"0")+(g>>>0).toString(16).padStart(8,"0")}}r.MurmurHash3_64=dt},(H,r,U)=>{var j;Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var a=U(1);class p{constructor({ownerDocument:F=globalThis.document,styleElement:x=null}){B(this,j,new Set);this._document=F,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(F){this.nativeFontFaces.add(F),this._document.fonts.add(F)}removeNativeFontFace(F){this.nativeFontFaces.delete(F),this._document.fonts.delete(F)}insertRule(F){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const x=this.styleElement.sheet;x.insertRule(F,x.cssRules.length)}clear(){for(const F of this.nativeFontFaces)this._document.fonts.delete(F);this.nativeFontFaces.clear(),t(this,j).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(F){if(!(!F||t(this,j).has(F.loadedName))){if((0,a.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:x,src:g,style:D}=F,L=new FontFace(x,g,D);this.addNativeFontFace(L);try{await L.load(),t(this,j).add(x)}catch{(0,a.warn)(`Cannot load system font: ${F.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(L)}return}(0,a.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(F){if(F.attached||F.missingFile&&!F.systemFontInfo)return;if(F.attached=!0,F.systemFontInfo){await this.loadSystemFont(F.systemFontInfo);return}if(this.isFontLoadingAPISupported){const g=F.createNativeFontFace();if(g){this.addNativeFontFace(g);try{await g.loaded}catch(D){throw(0,a.warn)(`Failed to load font '${g.family}': '${D}'.`),F.disableFontFace=!0,D}}return}const x=F.createFontFaceRule();if(x){if(this.insertRule(x),this.isSyncFontLoadingSupported)return;await new Promise(g=>{const D=this._queueLoadingCallback(g);this._prepareFontLoadEvent(F,D)})}}get isFontLoadingAPISupported(){var x;const F=!!((x=this._document)!=null&&x.fonts);return(0,a.shadow)(this,"isFontLoadingAPISupported",F)}get isSyncFontLoadingSupported(){let F=!1;return(a.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(F=!0),(0,a.shadow)(this,"isSyncFontLoadingSupported",F)}_queueLoadingCallback(F){function x(){for((0,a.assert)(!D.done,"completeRequest() cannot be called twice."),D.done=!0;g.length>0&&g[0].done;){const L=g.shift();setTimeout(L.callback,0)}}const{loadingRequests:g}=this,D={done:!1,complete:x,callback:F};return g.push(D),D}get _loadTestFont(){const F=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,a.shadow)(this,"_loadTestFont",F)}_prepareFontLoadEvent(F,x){function g(f,$){return f.charCodeAt($)<<24|f.charCodeAt($+1)<<16|f.charCodeAt($+2)<<8|f.charCodeAt($+3)&255}function D(f,$,G,S){const q=f.substring(0,$),it=f.substring($+G);return q+S+it}let L,C;const v=this._document.createElement("canvas");v.width=1,v.height=1;const y=v.getContext("2d");let u=0;function _(f,$){if(++u>30){(0,a.warn)("Load test font never loaded."),$();return}if(y.font="30px "+f,y.fillText(".",0,20),y.getImageData(0,0,1,1).data[3]>0){$();return}setTimeout(_.bind(null,f,$))}const P=`lt${Date.now()}${this.loadTestFontId++}`;let T=this._loadTestFont;T=D(T,976,P.length,P);const o=16,h=1482184792;let k=g(T,o);for(L=0,C=P.length-3;L<C;L+=4)k=k-h+g(P,L)|0;L<P.length&&(k=k-h+g(P+"XXX",L)|0),T=D(T,o,4,(0,a.string32)(k));const m=`url(data:font/opentype;base64,${btoa(T)});`,l=`@font-face {font-family:"${P}";src:${m}}`;this.insertRule(l);const R=this._document.createElement("div");R.style.visibility="hidden",R.style.width=R.style.height="10px",R.style.position="absolute",R.style.top=R.style.left="0px";for(const f of[F.loadedName,P]){const $=this._document.createElement("span");$.textContent="Hi",$.style.fontFamily=f,R.append($)}this._document.body.append(R),_(P,()=>{R.remove(),x.complete()})}}j=new WeakMap,r.FontLoader=p;class V{constructor(F,{isEvalSupported:x=!0,disableFontFace:g=!1,ignoreErrors:D=!1,inspectFont:L=null}){this.compiledGlyphs=Object.create(null);for(const C in F)this[C]=F[C];this.isEvalSupported=x!==!1,this.disableFontFace=g===!0,this.ignoreErrors=D===!0,this._inspectFont=L}createNativeFontFace(){var x;if(!this.data||this.disableFontFace)return null;let F;if(!this.cssFontInfo)F=new FontFace(this.loadedName,this.data,{});else{const g={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(g.style=`oblique ${this.cssFontInfo.italicAngle}deg`),F=new FontFace(this.cssFontInfo.fontFamily,this.data,g)}return(x=this._inspectFont)==null||x.call(this,this),F}createFontFaceRule(){var D;if(!this.data||this.disableFontFace)return null;const F=(0,a.bytesToString)(this.data),x=`url(data:${this.mimetype};base64,${btoa(F)});`;let g;if(!this.cssFontInfo)g=`@font-face {font-family:"${this.loadedName}";src:${x}}`;else{let L=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(L+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),g=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${L}src:${x}}`}return(D=this._inspectFont)==null||D.call(this,this,x),g}getPathGenerator(F,x){if(this.compiledGlyphs[x]!==void 0)return this.compiledGlyphs[x];let g;try{g=F.get(this.loadedName+"_path_"+x)}catch(D){if(!this.ignoreErrors)throw D;return(0,a.warn)(`getPathGenerator - ignoring character: "${D}".`),this.compiledGlyphs[x]=function(L,C){}}if(this.isEvalSupported&&a.FeatureTest.isEvalSupported){const D=[];for(const L of g){const C=L.args!==void 0?L.args.join(","):"";D.push("c.",L.cmd,"(",C,`);
`)}return this.compiledGlyphs[x]=new Function("c","size",D.join(""))}return this.compiledGlyphs[x]=function(D,L){for(const C of g)C.cmd==="scale"&&(C.args=[L,-L]),D[C.cmd].apply(D,C.args)}}}r.FontFaceObject=V},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeFilterFactory=r.NodeCanvasFactory=r.NodeCMapReaderFactory=void 0;var a=U(7);U(1);const p=function(x){return new Promise((g,D)=>{require$$5.readFile(x,(C,v)=>{if(C||!v){D(new Error(C));return}g(new Uint8Array(v))})})};class V extends a.BaseFilterFactory{}r.NodeFilterFactory=V;class j extends a.BaseCanvasFactory{_createCanvas(g,D){return require$$5.createCanvas(g,D)}}r.NodeCanvasFactory=j;class dt extends a.BaseCMapReaderFactory{_fetchData(g,D){return p(g).then(L=>({cMapData:L,compressionType:D}))}}r.NodeCMapReaderFactory=dt;class F extends a.BaseStandardFontDataFactory{_fetchData(g){return p(g)}}r.NodeStandardFontDataFactory=F},(H,r,U)=>{var W,Qe,gt,Ze;Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var a=U(1),p=U(6),V=U(12),j=U(13);const dt=16,F=100,x=4096,g=15,D=10,L=1e3,C=16;function v(w,n){if(w._removeMirroring)throw new Error("Context is already forwarding operations.");w.__originalSave=w.save,w.__originalRestore=w.restore,w.__originalRotate=w.rotate,w.__originalScale=w.scale,w.__originalTranslate=w.translate,w.__originalTransform=w.transform,w.__originalSetTransform=w.setTransform,w.__originalResetTransform=w.resetTransform,w.__originalClip=w.clip,w.__originalMoveTo=w.moveTo,w.__originalLineTo=w.lineTo,w.__originalBezierCurveTo=w.bezierCurveTo,w.__originalRect=w.rect,w.__originalClosePath=w.closePath,w.__originalBeginPath=w.beginPath,w._removeMirroring=()=>{w.save=w.__originalSave,w.restore=w.__originalRestore,w.rotate=w.__originalRotate,w.scale=w.__originalScale,w.translate=w.__originalTranslate,w.transform=w.__originalTransform,w.setTransform=w.__originalSetTransform,w.resetTransform=w.__originalResetTransform,w.clip=w.__originalClip,w.moveTo=w.__originalMoveTo,w.lineTo=w.__originalLineTo,w.bezierCurveTo=w.__originalBezierCurveTo,w.rect=w.__originalRect,w.closePath=w.__originalClosePath,w.beginPath=w.__originalBeginPath,delete w._removeMirroring},w.save=function(){n.save(),this.__originalSave()},w.restore=function(){n.restore(),this.__originalRestore()},w.translate=function(s,c){n.translate(s,c),this.__originalTranslate(s,c)},w.scale=function(s,c){n.scale(s,c),this.__originalScale(s,c)},w.transform=function(s,c,d,E,M,N){n.transform(s,c,d,E,M,N),this.__originalTransform(s,c,d,E,M,N)},w.setTransform=function(s,c,d,E,M,N){n.setTransform(s,c,d,E,M,N),this.__originalSetTransform(s,c,d,E,M,N)},w.resetTransform=function(){n.resetTransform(),this.__originalResetTransform()},w.rotate=function(s){n.rotate(s),this.__originalRotate(s)},w.clip=function(s){n.clip(s),this.__originalClip(s)},w.moveTo=function(i,s){n.moveTo(i,s),this.__originalMoveTo(i,s)},w.lineTo=function(i,s){n.lineTo(i,s),this.__originalLineTo(i,s)},w.bezierCurveTo=function(i,s,c,d,E,M){n.bezierCurveTo(i,s,c,d,E,M),this.__originalBezierCurveTo(i,s,c,d,E,M)},w.rect=function(i,s,c,d){n.rect(i,s,c,d),this.__originalRect(i,s,c,d)},w.closePath=function(){n.closePath(),this.__originalClosePath()},w.beginPath=function(){n.beginPath(),this.__originalBeginPath()}}class y{constructor(n){this.canvasFactory=n,this.cache=Object.create(null)}getCanvas(n,i,s){let c;return this.cache[n]!==void 0?(c=this.cache[n],this.canvasFactory.reset(c,i,s)):(c=this.canvasFactory.create(i,s),this.cache[n]=c),c}delete(n){delete this.cache[n]}clear(){for(const n in this.cache){const i=this.cache[n];this.canvasFactory.destroy(i),delete this.cache[n]}}}function u(w,n,i,s,c,d,E,M,N,st){const[Z,tt,lt,mt,ht,kt]=(0,p.getCurrentTransform)(w);if(tt===0&&lt===0){const Dt=E*Z+ht,pt=Math.round(Dt),et=M*mt+kt,nt=Math.round(et),ft=(E+N)*Z+ht,Pt=Math.abs(Math.round(ft)-pt)||1,wt=(M+st)*mt+kt,Ut=Math.abs(Math.round(wt)-nt)||1;return w.setTransform(Math.sign(Z),0,0,Math.sign(mt),pt,nt),w.drawImage(n,i,s,c,d,0,0,Pt,Ut),w.setTransform(Z,tt,lt,mt,ht,kt),[Pt,Ut]}if(Z===0&&mt===0){const Dt=M*lt+ht,pt=Math.round(Dt),et=E*tt+kt,nt=Math.round(et),ft=(M+st)*lt+ht,Pt=Math.abs(Math.round(ft)-pt)||1,wt=(E+N)*tt+kt,Ut=Math.abs(Math.round(wt)-nt)||1;return w.setTransform(0,Math.sign(tt),Math.sign(lt),0,pt,nt),w.drawImage(n,i,s,c,d,0,0,Ut,Pt),w.setTransform(Z,tt,lt,mt,ht,kt),[Ut,Pt]}w.drawImage(n,i,s,c,d,E,M,N,st);const Bt=Math.hypot(Z,tt),Et=Math.hypot(lt,mt);return[Bt*N,Et*st]}function _(w){const{width:n,height:i}=w;if(n>L||i>L)return null;const s=1e3,c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),d=n+1;let E=new Uint8Array(d*(i+1)),M,N,st;const Z=n+7&-8;let tt=new Uint8Array(Z*i),lt=0;for(const Et of w.data){let Dt=128;for(;Dt>0;)tt[lt++]=Et&Dt?0:255,Dt>>=1}let mt=0;for(lt=0,tt[lt]!==0&&(E[0]=1,++mt),N=1;N<n;N++)tt[lt]!==tt[lt+1]&&(E[N]=tt[lt]?2:1,++mt),lt++;for(tt[lt]!==0&&(E[N]=2,++mt),M=1;M<i;M++){lt=M*Z,st=M*d,tt[lt-Z]!==tt[lt]&&(E[st]=tt[lt]?1:8,++mt);let Et=(tt[lt]?4:0)+(tt[lt-Z]?8:0);for(N=1;N<n;N++)Et=(Et>>2)+(tt[lt+1]?4:0)+(tt[lt-Z+1]?8:0),c[Et]&&(E[st+N]=c[Et],++mt),lt++;if(tt[lt-Z]!==tt[lt]&&(E[st+N]=tt[lt]?2:4,++mt),mt>s)return null}for(lt=Z*(i-1),st=M*d,tt[lt]!==0&&(E[st]=8,++mt),N=1;N<n;N++)tt[lt]!==tt[lt+1]&&(E[st+N]=tt[lt]?4:8,++mt),lt++;if(tt[lt]!==0&&(E[st+N]=4,++mt),mt>s)return null;const ht=new Int32Array([0,d,-1,0,-d,0,0,0,1]),kt=new Path2D;for(M=0;mt&&M<=i;M++){let Et=M*d;const Dt=Et+n;for(;Et<Dt&&!E[Et];)Et++;if(Et===Dt)continue;kt.moveTo(Et%d,M);const pt=Et;let et=E[Et];do{const nt=ht[et];do Et+=nt;while(!E[Et]);const ft=E[Et];ft!==5&&ft!==10?(et=ft,E[Et]=0):(et=ft&51*et>>4,E[Et]&=et>>2|et<<2),kt.lineTo(Et%d,Et/d|0),E[Et]||--mt}while(pt!==Et);--M}return tt=null,E=null,function(Et){Et.save(),Et.scale(1/n,-1/i),Et.translate(0,-i),Et.fill(kt),Et.beginPath(),Et.restore()}}class P{constructor(n,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,n,i])}clone(){const n=Object.create(this);return n.clipBox=this.clipBox.slice(),n}setCurrentPoint(n,i){this.x=n,this.y=i}updatePathMinMax(n,i,s){[i,s]=a.Util.applyTransform([i,s],n),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(n,i){const s=a.Util.applyTransform(i,n),c=a.Util.applyTransform(i.slice(2),n);this.minX=Math.min(this.minX,s[0],c[0]),this.minY=Math.min(this.minY,s[1],c[1]),this.maxX=Math.max(this.maxX,s[0],c[0]),this.maxY=Math.max(this.maxY,s[1],c[1])}updateScalingPathMinMax(n,i){a.Util.scaleMinMax(n,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(n,i,s,c,d,E,M,N,st,Z){const tt=a.Util.bezierBoundingBox(i,s,c,d,E,M,N,st);if(Z){Z[0]=Math.min(Z[0],tt[0],tt[2]),Z[1]=Math.max(Z[1],tt[0],tt[2]),Z[2]=Math.min(Z[2],tt[1],tt[3]),Z[3]=Math.max(Z[3],tt[1],tt[3]);return}this.updateRectMinMax(n,tt)}getPathBoundingBox(n=V.PathType.FILL,i=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(n===V.PathType.STROKE){i||(0,a.unreachable)("Stroke bounding box must include transform.");const c=a.Util.singularValueDecompose2dScale(i),d=c[0]*this.lineWidth/2,E=c[1]*this.lineWidth/2;s[0]-=d,s[1]-=E,s[2]+=d,s[3]+=E}return s}updateClipFromPath(){const n=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(n||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(n){this.clipBox=n,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(n=V.PathType.FILL,i=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(n,i))}}function T(w,n){if(typeof ImageData<"u"&&n instanceof ImageData){w.putImageData(n,0,0);return}const i=n.height,s=n.width,c=i%C,d=(i-c)/C,E=c===0?d:d+1,M=w.createImageData(s,C);let N=0,st;const Z=n.data,tt=M.data;let lt,mt,ht,kt;if(n.kind===a.ImageKind.GRAYSCALE_1BPP){const Bt=Z.byteLength,Et=new Uint32Array(tt.buffer,0,tt.byteLength>>2),Dt=Et.length,pt=s+7>>3,et=4294967295,nt=a.FeatureTest.isLittleEndian?4278190080:255;for(lt=0;lt<E;lt++){for(ht=lt<d?C:c,st=0,mt=0;mt<ht;mt++){const ft=Bt-N;let Pt=0;const wt=ft>pt?s:ft*8-7,Ut=wt&-8;let Gt=0,jt=0;for(;Pt<Ut;Pt+=8)jt=Z[N++],Et[st++]=jt&128?et:nt,Et[st++]=jt&64?et:nt,Et[st++]=jt&32?et:nt,Et[st++]=jt&16?et:nt,Et[st++]=jt&8?et:nt,Et[st++]=jt&4?et:nt,Et[st++]=jt&2?et:nt,Et[st++]=jt&1?et:nt;for(;Pt<wt;Pt++)Gt===0&&(jt=Z[N++],Gt=128),Et[st++]=jt&Gt?et:nt,Gt>>=1}for(;st<Dt;)Et[st++]=0;w.putImageData(M,0,lt*C)}}else if(n.kind===a.ImageKind.RGBA_32BPP){for(mt=0,kt=s*C*4,lt=0;lt<d;lt++)tt.set(Z.subarray(N,N+kt)),N+=kt,w.putImageData(M,0,mt),mt+=C;lt<E&&(kt=s*c*4,tt.set(Z.subarray(N,N+kt)),w.putImageData(M,0,mt))}else if(n.kind===a.ImageKind.RGB_24BPP)for(ht=C,kt=s*ht,lt=0;lt<E;lt++){for(lt>=d&&(ht=c,kt=s*ht),st=0,mt=kt;mt--;)tt[st++]=Z[N++],tt[st++]=Z[N++],tt[st++]=Z[N++],tt[st++]=255;w.putImageData(M,0,lt*C)}else throw new Error(`bad image kind: ${n.kind}`)}function A(w,n){if(n.bitmap){w.drawImage(n.bitmap,0,0);return}const i=n.height,s=n.width,c=i%C,d=(i-c)/C,E=c===0?d:d+1,M=w.createImageData(s,C);let N=0;const st=n.data,Z=M.data;for(let tt=0;tt<E;tt++){const lt=tt<d?C:c;({srcPos:N}=(0,j.convertBlackAndWhiteToRGBA)({src:st,srcPos:N,dest:Z,width:s,height:lt,nonBlackColor:0})),w.putImageData(M,0,tt*C)}}function o(w,n){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of i)w[s]!==void 0&&(n[s]=w[s]);w.setLineDash!==void 0&&(n.setLineDash(w.getLineDash()),n.lineDashOffset=w.lineDashOffset)}function h(w){if(w.strokeStyle=w.fillStyle="#000000",w.fillRule="nonzero",w.globalAlpha=1,w.lineWidth=1,w.lineCap="butt",w.lineJoin="miter",w.miterLimit=10,w.globalCompositeOperation="source-over",w.font="10px sans-serif",w.setLineDash!==void 0&&(w.setLineDash([]),w.lineDashOffset=0),!a.isNodeJS){const{filter:n}=w;n!=="none"&&n!==""&&(w.filter="none")}}function k(w,n,i,s){const c=w.length;for(let d=3;d<c;d+=4){const E=w[d];if(E===0)w[d-3]=n,w[d-2]=i,w[d-1]=s;else if(E<255){const M=255-E;w[d-3]=w[d-3]*E+n*M>>8,w[d-2]=w[d-2]*E+i*M>>8,w[d-1]=w[d-1]*E+s*M>>8}}}function m(w,n,i){const s=w.length,c=1/255;for(let d=3;d<s;d+=4){const E=i?i[w[d]]:w[d];n[d]=n[d]*E*c|0}}function l(w,n,i){const s=w.length;for(let c=3;c<s;c+=4){const d=w[c-3]*77+w[c-2]*152+w[c-1]*28;n[c]=i?n[c]*i[d>>8]>>8:n[c]*d>>16}}function R(w,n,i,s,c,d,E,M,N,st,Z){const tt=!!d,lt=tt?d[0]:0,mt=tt?d[1]:0,ht=tt?d[2]:0,kt=c==="Luminosity"?l:m,Et=Math.min(s,Math.ceil(1048576/i));for(let Dt=0;Dt<s;Dt+=Et){const pt=Math.min(Et,s-Dt),et=w.getImageData(M-st,Dt+(N-Z),i,pt),nt=n.getImageData(M,Dt+N,i,pt);tt&&k(et.data,lt,mt,ht),kt(et.data,nt.data,E),n.putImageData(nt,M,Dt+N)}}function f(w,n,i,s){const c=s[0],d=s[1],E=s[2]-c,M=s[3]-d;E===0||M===0||(R(n.context,i,E,M,n.subtype,n.backdrop,n.transferMap,c,d,n.offsetX,n.offsetY),w.save(),w.globalAlpha=1,w.globalCompositeOperation="source-over",w.setTransform(1,0,0,1,0,0),w.drawImage(i.canvas,0,0),w.restore())}function $(w,n){const i=a.Util.singularValueDecompose2dScale(w);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*p.PixelsPerInch.PDF_TO_CSS_UNITS);return n!==void 0?n:i[0]<=s||i[1]<=s}const G=["butt","round","square"],S=["miter","round","bevel"],q={},it={},Tt=class Tt{constructor(n,i,s,c,d,{optionalContentConfig:E,markedContentStack:M=null},N,st){B(this,W);B(this,gt);this.ctx=n,this.current=new P(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=s,this.canvasFactory=c,this.filterFactory=d,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=M||[],this.optionalContentConfig=E,this.cachedCanvases=new y(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=N,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=st,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(n,i=null){return typeof n=="string"?n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n):i}beginDrawing({transform:n,viewport:i,transparency:s=!1,background:c=null}){const d=this.ctx.canvas.width,E=this.ctx.canvas.height,M=this.ctx.fillStyle;if(this.ctx.fillStyle=c||"#ffffff",this.ctx.fillRect(0,0,d,E),this.ctx.fillStyle=M,s){const N=this.cachedCanvases.getCanvas("transparent",d,E);this.compositeCtx=this.ctx,this.transparentCanvas=N.canvas,this.ctx=N.context,this.ctx.save(),this.ctx.transform(...(0,p.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),h(this.ctx),n&&(this.ctx.transform(...n),this.outputScaleX=n[0],this.outputScaleY=n[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,p.getCurrentTransform)(this.ctx)}executeOperatorList(n,i,s,c){const d=n.argsArray,E=n.fnArray;let M=i||0;const N=d.length;if(N===M)return M;const st=N-M>D&&typeof s=="function",Z=st?Date.now()+g:0;let tt=0;const lt=this.commonObjs,mt=this.objs;let ht;for(;;){if(c!==void 0&&M===c.nextBreakPoint)return c.breakIt(M,s),M;if(ht=E[M],ht!==a.OPS.dependency)this[ht].apply(this,d[M]);else for(const kt of d[M]){const Bt=kt.startsWith("g_")?lt:mt;if(!Bt.has(kt))return Bt.get(kt,s),M}if(M++,M===N)return M;if(st&&++tt>D){if(Date.now()>Z)return s(),M;tt=0}}}endDrawing(){X(this,W,Qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const n of this._cachedBitmapsMap.values()){for(const i of n.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);n.clear()}this._cachedBitmapsMap.clear(),X(this,gt,Ze).call(this)}_scaleImage(n,i){const s=n.width,c=n.height;let d=Math.max(Math.hypot(i[0],i[1]),1),E=Math.max(Math.hypot(i[2],i[3]),1),M=s,N=c,st="prescale1",Z,tt;for(;d>2&&M>1||E>2&&N>1;){let lt=M,mt=N;d>2&&M>1&&(lt=M>=16384?Math.floor(M/2)-1||1:Math.ceil(M/2),d/=M/lt),E>2&&N>1&&(mt=N>=16384?Math.floor(N/2)-1||1:Math.ceil(N)/2,E/=N/mt),Z=this.cachedCanvases.getCanvas(st,lt,mt),tt=Z.context,tt.clearRect(0,0,lt,mt),tt.drawImage(n,0,0,M,N,0,0,lt,mt),n=Z.canvas,M=lt,N=mt,st=st==="prescale1"?"prescale2":"prescale1"}return{img:n,paintWidth:M,paintHeight:N}}_createMaskCanvas(n){const i=this.ctx,{width:s,height:c}=n,d=this.current.fillColor,E=this.current.patternFill,M=(0,p.getCurrentTransform)(i);let N,st,Z,tt;if((n.bitmap||n.data)&&n.count>1){const Pt=n.bitmap||n.data.buffer;st=JSON.stringify(E?M:[M.slice(0,4),d]),N=this._cachedBitmapsMap.get(Pt),N||(N=new Map,this._cachedBitmapsMap.set(Pt,N));const wt=N.get(st);if(wt&&!E){const Ut=Math.round(Math.min(M[0],M[2])+M[4]),Gt=Math.round(Math.min(M[1],M[3])+M[5]);return{canvas:wt,offsetX:Ut,offsetY:Gt}}Z=wt}Z||(tt=this.cachedCanvases.getCanvas("maskCanvas",s,c),A(tt.context,n));let lt=a.Util.transform(M,[1/s,0,0,-1/c,0,0]);lt=a.Util.transform(lt,[1,0,0,1,0,-c]);const mt=a.Util.applyTransform([0,0],lt),ht=a.Util.applyTransform([s,c],lt),kt=a.Util.normalizeRect([mt[0],mt[1],ht[0],ht[1]]),Bt=Math.round(kt[2]-kt[0])||1,Et=Math.round(kt[3]-kt[1])||1,Dt=this.cachedCanvases.getCanvas("fillCanvas",Bt,Et),pt=Dt.context,et=Math.min(mt[0],ht[0]),nt=Math.min(mt[1],ht[1]);pt.translate(-et,-nt),pt.transform(...lt),Z||(Z=this._scaleImage(tt.canvas,(0,p.getCurrentTransformInverse)(pt)),Z=Z.img,N&&E&&N.set(st,Z)),pt.imageSmoothingEnabled=$((0,p.getCurrentTransform)(pt),n.interpolate),u(pt,Z,0,0,Z.width,Z.height,0,0,s,c),pt.globalCompositeOperation="source-in";const ft=a.Util.transform((0,p.getCurrentTransformInverse)(pt),[1,0,0,1,-et,-nt]);return pt.fillStyle=E?d.getPattern(i,this,ft,V.PathType.FILL):d,pt.fillRect(0,0,s,c),N&&!E&&(this.cachedCanvases.delete("fillCanvas"),N.set(st,Dt.canvas)),{canvas:Dt.canvas,offsetX:Math.round(et),offsetY:Math.round(nt)}}setLineWidth(n){n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(n){this.ctx.lineCap=G[n]}setLineJoin(n){this.ctx.lineJoin=S[n]}setMiterLimit(n){this.ctx.miterLimit=n}setDash(n,i){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(n),s.lineDashOffset=i)}setRenderingIntent(n){}setFlatness(n){}setGState(n){for(const[i,s]of n)switch(i){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const n=this.inSMaskMode;this.current.activeSMask&&!n?this.beginSMaskMode():!this.current.activeSMask&&n&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,c=this.cachedCanvases.getCanvas(s,n,i);this.suspendedCtx=this.ctx,this.ctx=c.context;const d=this.ctx;d.setTransform(...(0,p.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,d),v(d,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(n){if(!this.current.activeSMask)return;n?(n[0]=Math.floor(n[0]),n[1]=Math.floor(n[1]),n[2]=Math.ceil(n[2]),n[3]=Math.ceil(n[3])):n=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,s=this.suspendedCtx;f(s,i,this.ctx,n),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(n,i,s,c,d,E){this.ctx.transform(n,i,s,c,d,E),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(n,i,s){const c=this.ctx,d=this.current;let E=d.x,M=d.y,N,st;const Z=(0,p.getCurrentTransform)(c),tt=Z[0]===0&&Z[3]===0||Z[1]===0&&Z[2]===0,lt=tt?s.slice(0):null;for(let mt=0,ht=0,kt=n.length;mt<kt;mt++)switch(n[mt]|0){case a.OPS.rectangle:E=i[ht++],M=i[ht++];const Bt=i[ht++],Et=i[ht++],Dt=E+Bt,pt=M+Et;c.moveTo(E,M),Bt===0||Et===0?c.lineTo(Dt,pt):(c.lineTo(Dt,M),c.lineTo(Dt,pt),c.lineTo(E,pt)),tt||d.updateRectMinMax(Z,[E,M,Dt,pt]),c.closePath();break;case a.OPS.moveTo:E=i[ht++],M=i[ht++],c.moveTo(E,M),tt||d.updatePathMinMax(Z,E,M);break;case a.OPS.lineTo:E=i[ht++],M=i[ht++],c.lineTo(E,M),tt||d.updatePathMinMax(Z,E,M);break;case a.OPS.curveTo:N=E,st=M,E=i[ht+4],M=i[ht+5],c.bezierCurveTo(i[ht],i[ht+1],i[ht+2],i[ht+3],E,M),d.updateCurvePathMinMax(Z,N,st,i[ht],i[ht+1],i[ht+2],i[ht+3],E,M,lt),ht+=6;break;case a.OPS.curveTo2:N=E,st=M,c.bezierCurveTo(E,M,i[ht],i[ht+1],i[ht+2],i[ht+3]),d.updateCurvePathMinMax(Z,N,st,E,M,i[ht],i[ht+1],i[ht+2],i[ht+3],lt),E=i[ht+2],M=i[ht+3],ht+=4;break;case a.OPS.curveTo3:N=E,st=M,E=i[ht+2],M=i[ht+3],c.bezierCurveTo(i[ht],i[ht+1],E,M,E,M),d.updateCurvePathMinMax(Z,N,st,i[ht],i[ht+1],E,M,E,M,lt),ht+=4;break;case a.OPS.closePath:c.closePath();break}tt&&d.updateScalingPathMinMax(Z,lt),d.setCurrentPoint(E,M)}closePath(){this.ctx.closePath()}stroke(n=!0){const i=this.ctx,s=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(i.save(),i.strokeStyle=s.getPattern(i,this,(0,p.getCurrentTransformInverse)(i),V.PathType.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),n&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(n=!0){const i=this.ctx,s=this.current.fillColor,c=this.current.patternFill;let d=!1;c&&(i.save(),i.fillStyle=s.getPattern(i,this,(0,p.getCurrentTransformInverse)(i),V.PathType.FILL),d=!0);const E=this.current.getClippedPathBoundingBox();this.contentVisible&&E!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),d&&i.restore(),n&&this.consumePath(E)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=q}eoClip(){this.pendingClip=it}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const n=this.pendingTextPaths,i=this.ctx;if(n===void 0){i.beginPath();return}i.save(),i.beginPath();for(const s of n)i.setTransform(...s.transform),i.translate(s.x,s.y),s.addToPath(i,s.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(n){this.current.charSpacing=n}setWordSpacing(n){this.current.wordSpacing=n}setHScale(n){this.current.textHScale=n/100}setLeading(n){this.current.leading=-n}setFont(n,i){var Z;const s=this.commonObjs.get(n),c=this.current;if(!s)throw new Error(`Can't find font for ${n}`);if(c.fontMatrix=s.fontMatrix||a.FONT_IDENTITY_MATRIX,(c.fontMatrix[0]===0||c.fontMatrix[3]===0)&&(0,a.warn)("Invalid font matrix for font "+n),i<0?(i=-i,c.fontDirection=-1):c.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const d=s.loadedName||"sans-serif",E=((Z=s.systemFontInfo)==null?void 0:Z.css)||`"${d}", ${s.fallbackName}`;let M="normal";s.black?M="900":s.bold&&(M="bold");const N=s.italic?"italic":"normal";let st=i;i<dt?st=dt:i>F&&(st=F),this.current.fontSizeScale=i/st,this.ctx.font=`${N} ${M} ${st}px ${E}`}setTextRenderingMode(n){this.current.textRenderingMode=n}setTextRise(n){this.current.textRise=n}moveText(n,i){this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=i}setLeadingMoveText(n,i){this.setLeading(-i),this.moveText(n,i)}setTextMatrix(n,i,s,c,d,E){this.current.textMatrix=[n,i,s,c,d,E],this.current.textMatrixScale=Math.hypot(n,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(n,i,s,c){const d=this.ctx,E=this.current,M=E.font,N=E.textRenderingMode,st=E.fontSize/E.fontSizeScale,Z=N&a.TextRenderingMode.FILL_STROKE_MASK,tt=!!(N&a.TextRenderingMode.ADD_TO_PATH_FLAG),lt=E.patternFill&&!M.missingFile;let mt;(M.disableFontFace||tt||lt)&&(mt=M.getPathGenerator(this.commonObjs,n)),M.disableFontFace||lt?(d.save(),d.translate(i,s),d.beginPath(),mt(d,st),c&&d.setTransform(...c),(Z===a.TextRenderingMode.FILL||Z===a.TextRenderingMode.FILL_STROKE)&&d.fill(),(Z===a.TextRenderingMode.STROKE||Z===a.TextRenderingMode.FILL_STROKE)&&d.stroke(),d.restore()):((Z===a.TextRenderingMode.FILL||Z===a.TextRenderingMode.FILL_STROKE)&&d.fillText(n,i,s),(Z===a.TextRenderingMode.STROKE||Z===a.TextRenderingMode.FILL_STROKE)&&d.strokeText(n,i,s)),tt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,p.getCurrentTransform)(d),x:i,y:s,fontSize:st,addToPath:mt})}get isFontSubpixelAAEnabled(){const{context:n}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);n.scale(1.5,1),n.fillText("I",0,10);const i=n.getImageData(0,0,10,10).data;let s=!1;for(let c=3;c<i.length;c+=4)if(i[c]>0&&i[c]<255){s=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(n){const i=this.current,s=i.font;if(s.isType3Font)return this.showType3Text(n);const c=i.fontSize;if(c===0)return;const d=this.ctx,E=i.fontSizeScale,M=i.charSpacing,N=i.wordSpacing,st=i.fontDirection,Z=i.textHScale*st,tt=n.length,lt=s.vertical,mt=lt?1:-1,ht=s.defaultVMetrics,kt=c*i.fontMatrix[0],Bt=i.textRenderingMode===a.TextRenderingMode.FILL&&!s.disableFontFace&&!i.patternFill;d.save(),d.transform(...i.textMatrix),d.translate(i.x,i.y+i.textRise),st>0?d.scale(Z,-1):d.scale(Z,1);let Et;if(i.patternFill){d.save();const ft=i.fillColor.getPattern(d,this,(0,p.getCurrentTransformInverse)(d),V.PathType.FILL);Et=(0,p.getCurrentTransform)(d),d.restore(),d.fillStyle=ft}let Dt=i.lineWidth;const pt=i.textMatrixScale;if(pt===0||Dt===0){const ft=i.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;(ft===a.TextRenderingMode.STROKE||ft===a.TextRenderingMode.FILL_STROKE)&&(Dt=this.getSinglePixelWidth())}else Dt/=pt;if(E!==1&&(d.scale(E,E),Dt/=E),d.lineWidth=Dt,s.isInvalidPDFjsFont){const ft=[];let Pt=0;for(const wt of n)ft.push(wt.unicode),Pt+=wt.width;d.fillText(ft.join(""),0,0),i.x+=Pt*kt*Z,d.restore(),this.compose();return}let et=0,nt;for(nt=0;nt<tt;++nt){const ft=n[nt];if(typeof ft=="number"){et+=mt*ft*c/1e3;continue}let Pt=!1;const wt=(ft.isSpace?N:0)+M,Ut=ft.fontChar,Gt=ft.accent;let jt,Vt,Wt=ft.width;if(lt){const zt=ft.vmetric||ht,ut=-(ft.vmetric?zt[1]:Wt*.5)*kt,Q=zt[2]*kt;Wt=zt?-zt[0]:Wt,jt=ut/E,Vt=(et+Q)/E}else jt=et/E,Vt=0;if(s.remeasure&&Wt>0){const zt=d.measureText(Ut).width*1e3/c*E;if(Wt<zt&&this.isFontSubpixelAAEnabled){const ut=Wt/zt;Pt=!0,d.save(),d.scale(ut,1),jt/=ut}else Wt!==zt&&(jt+=(Wt-zt)/2e3*c/E)}if(this.contentVisible&&(ft.isInFont||s.missingFile)){if(Bt&&!Gt)d.fillText(Ut,jt,Vt);else if(this.paintChar(Ut,jt,Vt,Et),Gt){const zt=jt+c*Gt.offset.x/E,ut=Vt-c*Gt.offset.y/E;this.paintChar(Gt.fontChar,zt,ut,Et)}}const $t=lt?Wt*kt-wt*st:Wt*kt+wt*st;et+=$t,Pt&&d.restore()}lt?i.y-=et:i.x+=et*Z,d.restore(),this.compose()}showType3Text(n){const i=this.ctx,s=this.current,c=s.font,d=s.fontSize,E=s.fontDirection,M=c.vertical?1:-1,N=s.charSpacing,st=s.wordSpacing,Z=s.textHScale*E,tt=s.fontMatrix||a.FONT_IDENTITY_MATRIX,lt=n.length,mt=s.textRenderingMode===a.TextRenderingMode.INVISIBLE;let ht,kt,Bt,Et;if(!(mt||d===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...s.textMatrix),i.translate(s.x,s.y),i.scale(Z,E),ht=0;ht<lt;++ht){if(kt=n[ht],typeof kt=="number"){Et=M*kt*d/1e3,this.ctx.translate(Et,0),s.x+=Et*Z;continue}const Dt=(kt.isSpace?st:0)+N,pt=c.charProcOperatorList[kt.operatorListId];if(!pt){(0,a.warn)(`Type3 character "${kt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=kt,this.save(),i.scale(d,d),i.transform(...tt),this.executeOperatorList(pt),this.restore()),Bt=a.Util.applyTransform([kt.width,0],tt)[0]*d+Dt,i.translate(Bt,0),s.x+=Bt*Z}i.restore(),this.processingType3=null}}setCharWidth(n,i){}setCharWidthAndBounds(n,i,s,c,d,E){this.ctx.rect(s,c,d-s,E-c),this.ctx.clip(),this.endPath()}getColorN_Pattern(n){let i;if(n[0]==="TilingPattern"){const s=n[1],c=this.baseTransform||(0,p.getCurrentTransform)(this.ctx),d={createCanvasGraphics:E=>new Tt(E,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new V.TilingPattern(n,s,this.ctx,d,c)}else i=this._getPattern(n[1],n[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(n,i,s){const c=a.Util.makeHexColor(n,i,s);this.ctx.strokeStyle=c,this.current.strokeColor=c}setFillRGBColor(n,i,s){const c=a.Util.makeHexColor(n,i,s);this.ctx.fillStyle=c,this.current.fillColor=c,this.current.patternFill=!1}_getPattern(n,i=null){let s;return this.cachedPatterns.has(n)?s=this.cachedPatterns.get(n):(s=(0,V.getShadingPattern)(this.getObject(n)),this.cachedPatterns.set(n,s)),i&&(s.matrix=i),s}shadingFill(n){if(!this.contentVisible)return;const i=this.ctx;this.save();const s=this._getPattern(n);i.fillStyle=s.getPattern(i,this,(0,p.getCurrentTransformInverse)(i),V.PathType.SHADING);const c=(0,p.getCurrentTransformInverse)(i);if(c){const{width:d,height:E}=i.canvas,[M,N,st,Z]=a.Util.getAxialAlignedBoundingBox([0,0,d,E],c);this.ctx.fillRect(M,N,st-M,Z-N)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(n,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(n)&&n.length===6&&this.transform(...n),this.baseTransform=(0,p.getCurrentTransform)(this.ctx),i)){const s=i[2]-i[0],c=i[3]-i[1];this.ctx.rect(i[0],i[1],s,c),this.current.updateRectMinMax((0,p.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(n){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;n.isolated||(0,a.info)("TODO: Support non-isolated groups."),n.knockout&&(0,a.warn)("Knockout groups not supported.");const s=(0,p.getCurrentTransform)(i);if(n.matrix&&i.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let c=a.Util.getAxialAlignedBoundingBox(n.bbox,(0,p.getCurrentTransform)(i));const d=[0,0,i.canvas.width,i.canvas.height];c=a.Util.intersect(c,d)||[0,0,0,0];const E=Math.floor(c[0]),M=Math.floor(c[1]);let N=Math.max(Math.ceil(c[2])-E,1),st=Math.max(Math.ceil(c[3])-M,1),Z=1,tt=1;N>x&&(Z=N/x,N=x),st>x&&(tt=st/x,st=x),this.current.startNewPathAndClipBox([0,0,N,st]);let lt="groupAt"+this.groupLevel;n.smask&&(lt+="_smask_"+this.smaskCounter++%2);const mt=this.cachedCanvases.getCanvas(lt,N,st),ht=mt.context;ht.scale(1/Z,1/tt),ht.translate(-E,-M),ht.transform(...s),n.smask?this.smaskStack.push({canvas:mt.canvas,context:ht,offsetX:E,offsetY:M,scaleX:Z,scaleY:tt,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(E,M),i.scale(Z,tt),i.save()),o(i,ht),this.ctx=ht,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(n){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,n.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const c=(0,p.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...c);const d=a.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],c);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(d)}}beginAnnotation(n,i,s,c,d){if(X(this,W,Qe).call(this),h(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const E=i[2]-i[0],M=i[3]-i[1];if(d&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=E,i[3]=M;const[N,st]=a.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(this.ctx)),{viewportScale:Z}=this,tt=Math.ceil(E*this.outputScaleX*Z),lt=Math.ceil(M*this.outputScaleY*Z);this.annotationCanvas=this.canvasFactory.create(tt,lt);const{canvas:mt,context:ht}=this.annotationCanvas;this.annotationCanvasMap.set(n,mt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ht,this.ctx.save(),this.ctx.setTransform(N,0,0,-st,0,M*st),h(this.ctx)}else h(this.ctx),this.ctx.rect(i[0],i[1],E,M),this.ctx.clip(),this.endPath()}this.current=new P(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...c)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),X(this,gt,Ze).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(n){if(!this.contentVisible)return;const i=n.count;n=this.getObject(n.data,n),n.count=i;const s=this.ctx,c=this.processingType3;if(c&&(c.compiled===void 0&&(c.compiled=_(n)),c.compiled)){c.compiled(s);return}const d=this._createMaskCanvas(n),E=d.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(E,d.offsetX,d.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(n,i,s=0,c=0,d,E){if(!this.contentVisible)return;n=this.getObject(n.data,n);const M=this.ctx;M.save();const N=(0,p.getCurrentTransform)(M);M.transform(i,s,c,d,0,0);const st=this._createMaskCanvas(n);M.setTransform(1,0,0,1,st.offsetX-N[4],st.offsetY-N[5]);for(let Z=0,tt=E.length;Z<tt;Z+=2){const lt=a.Util.transform(N,[i,s,c,d,E[Z],E[Z+1]]),[mt,ht]=a.Util.applyTransform([0,0],lt);M.drawImage(st.canvas,mt,ht)}M.restore(),this.compose()}paintImageMaskXObjectGroup(n){if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,c=this.current.patternFill;for(const d of n){const{data:E,width:M,height:N,transform:st}=d,Z=this.cachedCanvases.getCanvas("maskCanvas",M,N),tt=Z.context;tt.save();const lt=this.getObject(E,d);A(tt,lt),tt.globalCompositeOperation="source-in",tt.fillStyle=c?s.getPattern(tt,this,(0,p.getCurrentTransformInverse)(i),V.PathType.FILL):s,tt.fillRect(0,0,M,N),tt.restore(),i.save(),i.transform(...st),i.scale(1,-1),u(i,Z.canvas,0,0,M,N,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(n){if(!this.contentVisible)return;const i=this.getObject(n);if(!i){(0,a.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(n,i,s,c){if(!this.contentVisible)return;const d=this.getObject(n);if(!d){(0,a.warn)("Dependent image isn't ready yet");return}const E=d.width,M=d.height,N=[];for(let st=0,Z=c.length;st<Z;st+=2)N.push({transform:[i,0,0,s,c[st],c[st+1]],x:0,y:0,w:E,h:M});this.paintInlineImageXObjectGroup(d,N)}applyTransferMapsToCanvas(n){return this.current.transferMaps!=="none"&&(n.filter=this.current.transferMaps,n.drawImage(n.canvas,0,0),n.filter="none"),n.canvas}applyTransferMapsToBitmap(n){if(this.current.transferMaps==="none")return n.bitmap;const{bitmap:i,width:s,height:c}=n,d=this.cachedCanvases.getCanvas("inlineImage",s,c),E=d.context;return E.filter=this.current.transferMaps,E.drawImage(i,0,0),E.filter="none",d.canvas}paintInlineImageXObject(n){if(!this.contentVisible)return;const i=n.width,s=n.height,c=this.ctx;if(this.save(),!a.isNodeJS){const{filter:M}=c;M!=="none"&&M!==""&&(c.filter="none")}c.scale(1/i,-1/s);let d;if(n.bitmap)d=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)d=n;else{const N=this.cachedCanvases.getCanvas("inlineImage",i,s).context;T(N,n),d=this.applyTransferMapsToCanvas(N)}const E=this._scaleImage(d,(0,p.getCurrentTransformInverse)(c));c.imageSmoothingEnabled=$((0,p.getCurrentTransform)(c),n.interpolate),u(c,E.img,0,0,E.paintWidth,E.paintHeight,0,-s,i,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(n,i){if(!this.contentVisible)return;const s=this.ctx;let c;if(n.bitmap)c=n.bitmap;else{const d=n.width,E=n.height,N=this.cachedCanvases.getCanvas("inlineImage",d,E).context;T(N,n),c=this.applyTransferMapsToCanvas(N)}for(const d of i)s.save(),s.transform(...d.transform),s.scale(1,-1),u(s,c,d.x,d.y,d.w,d.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(n){}markPointProps(n,i){}beginMarkedContent(n){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(n,i){n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const s=this.ctx;this.pendingClip&&(i||(this.pendingClip===it?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const n=(0,p.getCurrentTransform)(this.ctx);if(n[1]===0&&n[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(n[0]),Math.abs(n[3]));else{const i=Math.abs(n[0]*n[3]-n[2]*n[1]),s=Math.hypot(n[0],n[2]),c=Math.hypot(n[1],n[3]);this._cachedGetSinglePixelWidth=Math.max(s,c)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:n}=this.current,{a:i,b:s,c,d}=this.ctx.getTransform();let E,M;if(s===0&&c===0){const N=Math.abs(i),st=Math.abs(d);if(N===st)if(n===0)E=M=1/N;else{const Z=N*n;E=M=Z<1?1/Z:1}else if(n===0)E=1/N,M=1/st;else{const Z=N*n,tt=st*n;E=Z<1?1/Z:1,M=tt<1?1/tt:1}}else{const N=Math.abs(i*d-s*c),st=Math.hypot(i,s),Z=Math.hypot(c,d);if(n===0)E=Z/N,M=st/N;else{const tt=n*N;E=Z>tt?Z/tt:1,M=st>tt?st/tt:1}}this._cachedScaleForStroking[0]=E,this._cachedScaleForStroking[1]=M}return this._cachedScaleForStroking}rescaleAndStroke(n){const{ctx:i}=this,{lineWidth:s}=this.current,[c,d]=this.getScaleForStroking();if(i.lineWidth=s||1,c===1&&d===1){i.stroke();return}const E=i.getLineDash();if(n&&i.save(),i.scale(c,d),E.length>0){const M=Math.max(c,d);i.setLineDash(E.map(N=>N/M)),i.lineDashOffset/=M}i.stroke(),n&&i.restore()}isContentVisible(){for(let n=this.markedContentStack.length-1;n>=0;n--)if(!this.markedContentStack[n].visible)return!1;return!0}};W=new WeakSet,Qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},gt=new WeakSet,Ze=function(){if(this.pageColors){const n=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(n!=="none"){const i=this.ctx.filter;this.ctx.filter=n,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let ot=Tt;r.CanvasGraphics=ot;for(const w in a.OPS)ot.prototype[w]!==void 0&&(ot.prototype[a.OPS[w]]=ot.prototype[w])},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TilingPattern=r.PathType=void 0,r.getShadingPattern=C;var a=U(1),p=U(6);const V={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};r.PathType=V;function j(_,P){if(!P)return;const T=P[2]-P[0],A=P[3]-P[1],o=new Path2D;o.rect(P[0],P[1],T,A),_.clip(o)}class dt{constructor(){this.constructor===dt&&(0,a.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,a.unreachable)("Abstract method `getPattern` called.")}}class F extends dt{constructor(P){super(),this._type=P[1],this._bbox=P[2],this._colorStops=P[3],this._p0=P[4],this._p1=P[5],this._r0=P[6],this._r1=P[7],this.matrix=null}_createGradient(P){let T;this._type==="axial"?T=P.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(T=P.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)T.addColorStop(A[0],A[1]);return T}getPattern(P,T,A,o){let h;if(o===V.STROKE||o===V.FILL){const k=T.current.getClippedPathBoundingBox(o,(0,p.getCurrentTransform)(P))||[0,0,0,0],m=Math.ceil(k[2]-k[0])||1,l=Math.ceil(k[3]-k[1])||1,R=T.cachedCanvases.getCanvas("pattern",m,l,!0),f=R.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-k[0],-k[1]),A=a.Util.transform(A,[1,0,0,1,k[0],k[1]]),f.transform(...T.baseTransform),this.matrix&&f.transform(...this.matrix),j(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),h=P.createPattern(R.canvas,"no-repeat");const $=new DOMMatrix(A);h.setTransform($)}else j(P,this._bbox),h=this._createGradient(P);return h}}function x(_,P,T,A,o,h,k,m){const l=P.coords,R=P.colors,f=_.data,$=_.width*4;let G;l[T+1]>l[A+1]&&(G=T,T=A,A=G,G=h,h=k,k=G),l[A+1]>l[o+1]&&(G=A,A=o,o=G,G=k,k=m,m=G),l[T+1]>l[A+1]&&(G=T,T=A,A=G,G=h,h=k,k=G);const S=(l[T]+P.offsetX)*P.scaleX,q=(l[T+1]+P.offsetY)*P.scaleY,it=(l[A]+P.offsetX)*P.scaleX,ot=(l[A+1]+P.offsetY)*P.scaleY,W=(l[o]+P.offsetX)*P.scaleX,ct=(l[o+1]+P.offsetY)*P.scaleY;if(q>=ct)return;const gt=R[h],vt=R[h+1],Tt=R[h+2],w=R[k],n=R[k+1],i=R[k+2],s=R[m],c=R[m+1],d=R[m+2],E=Math.round(q),M=Math.round(ct);let N,st,Z,tt,lt,mt,ht,kt;for(let Bt=E;Bt<=M;Bt++){if(Bt<ot){const nt=Bt<q?0:(q-Bt)/(q-ot);N=S-(S-it)*nt,st=gt-(gt-w)*nt,Z=vt-(vt-n)*nt,tt=Tt-(Tt-i)*nt}else{let nt;Bt>ct?nt=1:ot===ct?nt=0:nt=(ot-Bt)/(ot-ct),N=it-(it-W)*nt,st=w-(w-s)*nt,Z=n-(n-c)*nt,tt=i-(i-d)*nt}let Et;Bt<q?Et=0:Bt>ct?Et=1:Et=(q-Bt)/(q-ct),lt=S-(S-W)*Et,mt=gt-(gt-s)*Et,ht=vt-(vt-c)*Et,kt=Tt-(Tt-d)*Et;const Dt=Math.round(Math.min(N,lt)),pt=Math.round(Math.max(N,lt));let et=$*Bt+Dt*4;for(let nt=Dt;nt<=pt;nt++)Et=(N-nt)/(N-lt),Et<0?Et=0:Et>1&&(Et=1),f[et++]=st-(st-mt)*Et|0,f[et++]=Z-(Z-ht)*Et|0,f[et++]=tt-(tt-kt)*Et|0,f[et++]=255}}function g(_,P,T){const A=P.coords,o=P.colors;let h,k;switch(P.type){case"lattice":const m=P.verticesPerRow,l=Math.floor(A.length/m)-1,R=m-1;for(h=0;h<l;h++){let f=h*m;for(let $=0;$<R;$++,f++)x(_,T,A[f],A[f+1],A[f+m],o[f],o[f+1],o[f+m]),x(_,T,A[f+m+1],A[f+1],A[f+m],o[f+m+1],o[f+1],o[f+m])}break;case"triangles":for(h=0,k=A.length;h<k;h+=3)x(_,T,A[h],A[h+1],A[h+2],o[h],o[h+1],o[h+2]);break;default:throw new Error("illegal figure")}}class D extends dt{constructor(P){super(),this._coords=P[2],this._colors=P[3],this._figures=P[4],this._bounds=P[5],this._bbox=P[7],this._background=P[8],this.matrix=null}_createMeshCanvas(P,T,A){const m=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),R=Math.ceil(this._bounds[2])-m,f=Math.ceil(this._bounds[3])-l,$=Math.min(Math.ceil(Math.abs(R*P[0]*1.1)),3e3),G=Math.min(Math.ceil(Math.abs(f*P[1]*1.1)),3e3),S=R/$,q=f/G,it={coords:this._coords,colors:this._colors,offsetX:-m,offsetY:-l,scaleX:1/S,scaleY:1/q},ot=$+2*2,W=G+2*2,ct=A.getCanvas("mesh",ot,W,!1),gt=ct.context,vt=gt.createImageData($,G);if(T){const w=vt.data;for(let n=0,i=w.length;n<i;n+=4)w[n]=T[0],w[n+1]=T[1],w[n+2]=T[2],w[n+3]=255}for(const w of this._figures)g(vt,w,it);return gt.putImageData(vt,2,2),{canvas:ct.canvas,offsetX:m-2*S,offsetY:l-2*q,scaleX:S,scaleY:q}}getPattern(P,T,A,o){j(P,this._bbox);let h;if(o===V.SHADING)h=a.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(P));else if(h=a.Util.singularValueDecompose2dScale(T.baseTransform),this.matrix){const m=a.Util.singularValueDecompose2dScale(this.matrix);h=[h[0]*m[0],h[1]*m[1]]}const k=this._createMeshCanvas(h,o===V.SHADING?null:this._background,T.cachedCanvases);return o!==V.SHADING&&(P.setTransform(...T.baseTransform),this.matrix&&P.transform(...this.matrix)),P.translate(k.offsetX,k.offsetY),P.scale(k.scaleX,k.scaleY),P.createPattern(k.canvas,"no-repeat")}}class L extends dt{getPattern(){return"hotpink"}}function C(_){switch(_[0]){case"RadialAxial":return new F(_);case"Mesh":return new D(_);case"Dummy":return new L}throw new Error(`Unknown IR type: ${_[0]}`)}const v={COLORED:1,UNCOLORED:2},u=class u{constructor(P,T,A,o,h){this.operatorList=P[2],this.matrix=P[3]||[1,0,0,1,0,0],this.bbox=P[4],this.xstep=P[5],this.ystep=P[6],this.paintType=P[7],this.tilingType=P[8],this.color=T,this.ctx=A,this.canvasGraphicsFactory=o,this.baseTransform=h}createPatternCanvas(P){const T=this.operatorList,A=this.bbox,o=this.xstep,h=this.ystep,k=this.paintType,m=this.tilingType,l=this.color,R=this.canvasGraphicsFactory;(0,a.info)("TilingType: "+m);const f=A[0],$=A[1],G=A[2],S=A[3],q=a.Util.singularValueDecompose2dScale(this.matrix),it=a.Util.singularValueDecompose2dScale(this.baseTransform),ot=[q[0]*it[0],q[1]*it[1]],W=this.getSizeAndScale(o,this.ctx.canvas.width,ot[0]),ct=this.getSizeAndScale(h,this.ctx.canvas.height,ot[1]),gt=P.cachedCanvases.getCanvas("pattern",W.size,ct.size,!0),vt=gt.context,Tt=R.createCanvasGraphics(vt);Tt.groupLevel=P.groupLevel,this.setFillAndStrokeStyleToContext(Tt,k,l);let w=f,n=$,i=G,s=S;return f<0&&(w=0,i+=Math.abs(f)),$<0&&(n=0,s+=Math.abs($)),vt.translate(-(W.scale*w),-(ct.scale*n)),Tt.transform(W.scale,0,0,ct.scale,0,0),vt.save(),this.clipBbox(Tt,w,n,i,s),Tt.baseTransform=(0,p.getCurrentTransform)(Tt.ctx),Tt.executeOperatorList(T),Tt.endDrawing(),{canvas:gt.canvas,scaleX:W.scale,scaleY:ct.scale,offsetX:w,offsetY:n}}getSizeAndScale(P,T,A){P=Math.abs(P);const o=Math.max(u.MAX_PATTERN_SIZE,T);let h=Math.ceil(P*A);return h>=o?h=o:A=h/P,{scale:A,size:h}}clipBbox(P,T,A,o,h){const k=o-T,m=h-A;P.ctx.rect(T,A,k,m),P.current.updateRectMinMax((0,p.getCurrentTransform)(P.ctx),[T,A,o,h]),P.clip(),P.endPath()}setFillAndStrokeStyleToContext(P,T,A){const o=P.ctx,h=P.current;switch(T){case v.COLORED:const k=this.ctx;o.fillStyle=k.fillStyle,o.strokeStyle=k.strokeStyle,h.fillColor=k.fillStyle,h.strokeColor=k.strokeStyle;break;case v.UNCOLORED:const m=a.Util.makeHexColor(A[0],A[1],A[2]);o.fillStyle=m,o.strokeStyle=m,h.fillColor=m,h.strokeColor=m;break;default:throw new a.FormatError(`Unsupported paint type: ${T}`)}}getPattern(P,T,A,o){let h=A;o!==V.SHADING&&(h=a.Util.transform(h,T.baseTransform),this.matrix&&(h=a.Util.transform(h,this.matrix)));const k=this.createPatternCanvas(T);let m=new DOMMatrix(h);m=m.translate(k.offsetX,k.offsetY),m=m.scale(1/k.scaleX,1/k.scaleY);const l=P.createPattern(k.canvas,"repeat");return l.setTransform(m),l}};ee(u,"MAX_PATTERN_SIZE",3e3);let y=u;r.TilingPattern=y},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.convertBlackAndWhiteToRGBA=V,r.convertToRGBA=p,r.grayToRGBA=dt;var a=U(1);function p(F){switch(F.kind){case a.ImageKind.GRAYSCALE_1BPP:return V(F);case a.ImageKind.RGB_24BPP:return j(F)}return null}function V({src:F,srcPos:x=0,dest:g,width:D,height:L,nonBlackColor:C=4294967295,inverseDecode:v=!1}){const y=a.FeatureTest.isLittleEndian?4278190080:255,[u,_]=v?[C,y]:[y,C],P=D>>3,T=D&7,A=F.length;g=new Uint32Array(g.buffer);let o=0;for(let h=0;h<L;h++){for(const m=x+P;x<m;x++){const l=x<A?F[x]:255;g[o++]=l&128?_:u,g[o++]=l&64?_:u,g[o++]=l&32?_:u,g[o++]=l&16?_:u,g[o++]=l&8?_:u,g[o++]=l&4?_:u,g[o++]=l&2?_:u,g[o++]=l&1?_:u}if(T===0)continue;const k=x<A?F[x++]:255;for(let m=0;m<T;m++)g[o++]=k&1<<7-m?_:u}return{srcPos:x,destPos:o}}function j({src:F,srcPos:x=0,dest:g,destPos:D=0,width:L,height:C}){let v=0;const y=F.length>>2,u=new Uint32Array(F.buffer,x,y);if(a.FeatureTest.isLittleEndian){for(;v<y-2;v+=3,D+=4){const _=u[v],P=u[v+1],T=u[v+2];g[D]=_|4278190080,g[D+1]=_>>>24|P<<8|4278190080,g[D+2]=P>>>16|T<<16|4278190080,g[D+3]=T>>>8|4278190080}for(let _=v*4,P=F.length;_<P;_+=3)g[D++]=F[_]|F[_+1]<<8|F[_+2]<<16|4278190080}else{for(;v<y-2;v+=3,D+=4){const _=u[v],P=u[v+1],T=u[v+2];g[D]=_|255,g[D+1]=_<<24|P>>>8|255,g[D+2]=P<<16|T>>>16|255,g[D+3]=T<<8|255}for(let _=v*4,P=F.length;_<P;_+=3)g[D++]=F[_]<<24|F[_+1]<<16|F[_+2]<<8|255}return{srcPos:x,destPos:D}}function dt(F,x){if(a.FeatureTest.isLittleEndian)for(let g=0,D=F.length;g<D;g++)x[g]=F[g]*65793|4278190080;else for(let g=0,D=F.length;g<D;g++)x[g]=F[g]*16843008|255}},(H,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const U=Object.create(null);r.GlobalWorkerOptions=U,U.workerPort=null,U.workerSrc=""},(H,r,U)=>{var F,Rn,g,kn,L,xe;Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var a=U(1);const p={UNKNOWN:0,DATA:1,ERROR:2},V={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function j(v){switch(v instanceof Error||typeof v=="object"&&v!==null||(0,a.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),v.name){case"AbortException":return new a.AbortException(v.message);case"MissingPDFException":return new a.MissingPDFException(v.message);case"PasswordException":return new a.PasswordException(v.message,v.code);case"UnexpectedResponseException":return new a.UnexpectedResponseException(v.message,v.status);case"UnknownErrorException":return new a.UnknownErrorException(v.message,v.details);default:return new a.UnknownErrorException(v.message,v.toString())}}class dt{constructor(y,u,_){B(this,F);B(this,g);B(this,L);this.sourceName=y,this.targetName=u,this.comObj=_,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=P=>{const T=P.data;if(T.targetName!==this.sourceName)return;if(T.stream){X(this,g,kn).call(this,T);return}if(T.callback){const o=T.callbackId,h=this.callbackCapabilities[o];if(!h)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],T.callback===p.DATA)h.resolve(T.data);else if(T.callback===p.ERROR)h.reject(j(T.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[T.action];if(!A)throw new Error(`Unknown action from worker: ${T.action}`);if(T.callbackId){const o=this.sourceName,h=T.sourceName;new Promise(function(k){k(A(T.data))}).then(function(k){_.postMessage({sourceName:o,targetName:h,callback:p.DATA,callbackId:T.callbackId,data:k})},function(k){_.postMessage({sourceName:o,targetName:h,callback:p.ERROR,callbackId:T.callbackId,reason:j(k)})});return}if(T.streamId){X(this,F,Rn).call(this,T);return}A(T.data)},_.addEventListener("message",this._onComObjOnMessage)}on(y,u){const _=this.actionHandler;if(_[y])throw new Error(`There is already an actionName called "${y}"`);_[y]=u}send(y,u,_){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,data:u},_)}sendWithPromise(y,u,_){const P=this.callbackId++,T=new a.PromiseCapability;this.callbackCapabilities[P]=T;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,callbackId:P,data:u},_)}catch(A){T.reject(A)}return T.promise}sendWithStream(y,u,_,P){const T=this.streamId++,A=this.sourceName,o=this.targetName,h=this.comObj;return new ReadableStream({start:k=>{const m=new a.PromiseCapability;return this.streamControllers[T]={controller:k,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:A,targetName:o,action:y,streamId:T,data:u,desiredSize:k.desiredSize},P),m.promise},pull:k=>{const m=new a.PromiseCapability;return this.streamControllers[T].pullCall=m,h.postMessage({sourceName:A,targetName:o,stream:V.PULL,streamId:T,desiredSize:k.desiredSize}),m.promise},cancel:k=>{(0,a.assert)(k instanceof Error,"cancel must have a valid reason");const m=new a.PromiseCapability;return this.streamControllers[T].cancelCall=m,this.streamControllers[T].isClosed=!0,h.postMessage({sourceName:A,targetName:o,stream:V.CANCEL,streamId:T,reason:j(k)}),m.promise}},_)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}F=new WeakSet,Rn=function(y){const u=y.streamId,_=this.sourceName,P=y.sourceName,T=this.comObj,A=this,o=this.actionHandler[y.action],h={enqueue(k,m=1,l){if(this.isCancelled)return;const R=this.desiredSize;this.desiredSize-=m,R>0&&this.desiredSize<=0&&(this.sinkCapability=new a.PromiseCapability,this.ready=this.sinkCapability.promise),T.postMessage({sourceName:_,targetName:P,stream:V.ENQUEUE,streamId:u,chunk:k},l)},close(){this.isCancelled||(this.isCancelled=!0,T.postMessage({sourceName:_,targetName:P,stream:V.CLOSE,streamId:u}),delete A.streamSinks[u])},error(k){(0,a.assert)(k instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,T.postMessage({sourceName:_,targetName:P,stream:V.ERROR,streamId:u,reason:j(k)}))},sinkCapability:new a.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:y.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[u]=h,new Promise(function(k){k(o(y.data,h))}).then(function(){T.postMessage({sourceName:_,targetName:P,stream:V.START_COMPLETE,streamId:u,success:!0})},function(k){T.postMessage({sourceName:_,targetName:P,stream:V.START_COMPLETE,streamId:u,reason:j(k)})})},g=new WeakSet,kn=function(y){const u=y.streamId,_=this.sourceName,P=y.sourceName,T=this.comObj,A=this.streamControllers[u],o=this.streamSinks[u];switch(y.stream){case V.START_COMPLETE:y.success?A.startCall.resolve():A.startCall.reject(j(y.reason));break;case V.PULL_COMPLETE:y.success?A.pullCall.resolve():A.pullCall.reject(j(y.reason));break;case V.PULL:if(!o){T.postMessage({sourceName:_,targetName:P,stream:V.PULL_COMPLETE,streamId:u,success:!0});break}o.desiredSize<=0&&y.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=y.desiredSize,new Promise(function(h){var k;h((k=o.onPull)==null?void 0:k.call(o))}).then(function(){T.postMessage({sourceName:_,targetName:P,stream:V.PULL_COMPLETE,streamId:u,success:!0})},function(h){T.postMessage({sourceName:_,targetName:P,stream:V.PULL_COMPLETE,streamId:u,reason:j(h)})});break;case V.ENQUEUE:if((0,a.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(y.chunk);break;case V.CLOSE:if((0,a.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),X(this,L,xe).call(this,A,u);break;case V.ERROR:(0,a.assert)(A,"error should have stream controller"),A.controller.error(j(y.reason)),X(this,L,xe).call(this,A,u);break;case V.CANCEL_COMPLETE:y.success?A.cancelCall.resolve():A.cancelCall.reject(j(y.reason)),X(this,L,xe).call(this,A,u);break;case V.CANCEL:if(!o)break;new Promise(function(h){var k;h((k=o.onCancel)==null?void 0:k.call(o,j(y.reason)))}).then(function(){T.postMessage({sourceName:_,targetName:P,stream:V.CANCEL_COMPLETE,streamId:u,success:!0})},function(h){T.postMessage({sourceName:_,targetName:P,stream:V.CANCEL_COMPLETE,streamId:u,reason:j(h)})}),o.sinkCapability.reject(j(y.reason)),o.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}},L=new WeakSet,xe=async function(y,u){var _,P,T;await Promise.allSettled([(_=y.startCall)==null?void 0:_.promise,(P=y.pullCall)==null?void 0:P.promise,(T=y.cancelCall)==null?void 0:T.promise]),delete this.streamControllers[u]},r.MessageHandler=dt},(H,r,U)=>{var V,j;Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var a=U(1);class p{constructor({parsedData:F,rawData:x}){B(this,V,void 0);B(this,j,void 0);rt(this,V,F),rt(this,j,x)}getRaw(){return t(this,j)}get(F){return t(this,V).get(F)??null}getAll(){return(0,a.objectFromMap)(t(this,V))}has(F){return t(this,V).has(F)}}V=new WeakMap,j=new WeakMap,r.Metadata=p},(H,r,U)=>{var F,x,g,D,L,C,tn;Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var a=U(1),p=U(8);const V=Symbol("INTERNAL");class j{constructor(u,_){B(this,F,!0);this.name=u,this.intent=_}get visible(){return t(this,F)}_setVisible(u,_){u!==V&&(0,a.unreachable)("Internal method `_setVisible` called."),rt(this,F,_)}}F=new WeakMap;class dt{constructor(u){B(this,C);B(this,x,null);B(this,g,new Map);B(this,D,null);B(this,L,null);if(this.name=null,this.creator=null,u!==null){this.name=u.name,this.creator=u.creator,rt(this,L,u.order);for(const _ of u.groups)t(this,g).set(_.id,new j(_.name,_.intent));if(u.baseState==="OFF")for(const _ of t(this,g).values())_._setVisible(V,!1);for(const _ of u.on)t(this,g).get(_)._setVisible(V,!0);for(const _ of u.off)t(this,g).get(_)._setVisible(V,!1);rt(this,D,this.getHash())}}isVisible(u){if(t(this,g).size===0)return!0;if(!u)return(0,a.warn)("Optional content group not defined."),!0;if(u.type==="OCG")return t(this,g).has(u.id)?t(this,g).get(u.id).visible:((0,a.warn)(`Optional content group not found: ${u.id}`),!0);if(u.type==="OCMD"){if(u.expression)return X(this,C,tn).call(this,u.expression);if(!u.policy||u.policy==="AnyOn"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,a.warn)(`Optional content group not found: ${_}`),!0;if(t(this,g).get(_).visible)return!0}return!1}else if(u.policy==="AllOn"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,a.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,g).get(_).visible)return!1}return!0}else if(u.policy==="AnyOff"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,a.warn)(`Optional content group not found: ${_}`),!0;if(!t(this,g).get(_).visible)return!0}return!1}else if(u.policy==="AllOff"){for(const _ of u.ids){if(!t(this,g).has(_))return(0,a.warn)(`Optional content group not found: ${_}`),!0;if(t(this,g).get(_).visible)return!1}return!0}return(0,a.warn)(`Unknown optional content policy ${u.policy}.`),!0}return(0,a.warn)(`Unknown group type ${u.type}.`),!0}setVisibility(u,_=!0){if(!t(this,g).has(u)){(0,a.warn)(`Optional content group not found: ${u}`);return}t(this,g).get(u)._setVisible(V,!!_),rt(this,x,null)}get hasInitialVisibility(){return t(this,D)===null||this.getHash()===t(this,D)}getOrder(){return t(this,g).size?t(this,L)?t(this,L).slice():[...t(this,g).keys()]:null}getGroups(){return t(this,g).size>0?(0,a.objectFromMap)(t(this,g)):null}getGroup(u){return t(this,g).get(u)||null}getHash(){if(t(this,x)!==null)return t(this,x);const u=new p.MurmurHash3_64;for(const[_,P]of t(this,g))u.update(`${_}:${P.visible}`);return rt(this,x,u.hexdigest())}}x=new WeakMap,g=new WeakMap,D=new WeakMap,L=new WeakMap,C=new WeakSet,tn=function(u){const _=u.length;if(_<2)return!0;const P=u[0];for(let T=1;T<_;T++){const A=u[T];let o;if(Array.isArray(A))o=X(this,C,tn).call(this,A);else if(t(this,g).has(A))o=t(this,g).get(A).visible;else return(0,a.warn)(`Optional content group not found: ${A}`),!0;switch(P){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return P==="And"},r.OptionalContentConfig=dt},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var a=U(1),p=U(6);class V{constructor({length:x,initialData:g,progressiveDone:D=!1,contentDispositionFilename:L=null,disableRange:C=!1,disableStream:v=!1},y){if((0,a.assert)(y,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=D,this._contentDispositionFilename=L,(g==null?void 0:g.length)>0){const u=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=y,this._isStreamingSupported=!v,this._isRangeSupported=!C,this._contentLength=x,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((u,_)=>{this._onReceiveData({begin:u,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((u,_)=>{this._onProgress({loaded:u,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:x,chunk:g}){const D=g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength?g.buffer:new Uint8Array(g).buffer;if(x===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(D):this._queuedChunks.push(D);else{const L=this._rangeReaders.some(function(C){return C._begin!==x?!1:(C._enqueue(D),!0)});(0,a.assert)(L,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}_onProgress(x){var g,D,L,C;x.total===void 0?(D=(g=this._rangeReaders[0])==null?void 0:g.onProgress)==null||D.call(g,{loaded:x.loaded}):(C=(L=this._fullRequestReader)==null?void 0:L.onProgress)==null||C.call(L,{loaded:x.loaded,total:x.total})}_onProgressiveDone(){var x;(x=this._fullRequestReader)==null||x.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(x){const g=this._rangeReaders.indexOf(x);g>=0&&this._rangeReaders.splice(g,1)}getFullReader(){(0,a.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const x=this._queuedChunks;return this._queuedChunks=null,new j(this,x,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(x,g){if(g<=this._progressiveDataLength)return null;const D=new dt(this,x,g);return this._pdfDataRangeTransport.requestDataRange(x,g),this._rangeReaders.push(D),D}cancelAllRequests(x){var g;(g=this._fullRequestReader)==null||g.cancel(x);for(const D of this._rangeReaders.slice(0))D.cancel(x);this._pdfDataRangeTransport.abort()}}r.PDFDataTransportStream=V;class j{constructor(x,g,D=!1,L=null){this._stream=x,this._done=D||!1,this._filename=(0,p.isPdfFile)(L)?L:null,this._queuedChunks=g||[],this._loaded=0;for(const C of this._queuedChunks)this._loaded+=C.byteLength;this._requests=[],this._headersReady=Promise.resolve(),x._fullRequestReader=this,this.onProgress=null}_enqueue(x){this._done||(this._requests.length>0?this._requests.shift().resolve({value:x,done:!1}):this._queuedChunks.push(x),this._loaded+=x.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const x=new a.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dt{constructor(x,g,D){this._stream=x,this._begin=g,this._end=D,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(x){if(!this._done){if(this._requests.length===0)this._queuedChunk=x;else{this._requests.shift().resolve({value:x,done:!1});for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const x=new a.PromiseCapability;return this._requests.push(x),x.promise}cancel(x){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var a=U(1),p=U(20);function V(D,L,C){return{method:"GET",headers:D,signal:C.signal,mode:"cors",credentials:L?"include":"same-origin",redirect:"follow"}}function j(D){const L=new Headers;for(const C in D){const v=D[C];v!==void 0&&L.append(C,v)}return L}function dt(D){return D instanceof Uint8Array?D.buffer:D instanceof ArrayBuffer?D:((0,a.warn)(`getArrayBuffer - unexpected data format: ${D}`),new Uint8Array(D).buffer)}class F{constructor(L){this.source=L,this.isHttp=/^https?:/i.test(L.url),this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new x(this),this._fullRequestReader}getRangeReader(L,C){if(C<=this._progressiveDataLength)return null;const v=new g(this,L,C);return this._rangeRequestReaders.push(v),v}cancelAllRequests(L){var C;(C=this._fullRequestReader)==null||C.cancel(L);for(const v of this._rangeRequestReaders.slice(0))v.cancel(L)}}r.PDFFetchStream=F;class x{constructor(L){this._stream=L,this._reader=null,this._loaded=0,this._filename=null;const C=L.source;this._withCredentials=C.withCredentials||!1,this._contentLength=C.length,this._headersCapability=new a.PromiseCapability,this._disableRange=C.disableRange||!1,this._rangeChunkSize=C.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!C.disableStream,this._isRangeSupported=!C.disableRange,this._headers=j(this._stream.httpHeaders);const v=C.url;fetch(v,V(this._headers,this._withCredentials,this._abortController)).then(y=>{if(!(0,p.validateResponseStatus)(y.status))throw(0,p.createResponseStatusError)(y.status,v);this._reader=y.body.getReader(),this._headersCapability.resolve();const u=T=>y.headers.get(T),{allowRangeRequests:_,suggestedLength:P}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=P||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new a.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var v;await this._headersCapability.promise;const{value:L,done:C}=await this._reader.read();return C?{value:L,done:C}:(this._loaded+=L.byteLength,(v=this.onProgress)==null||v.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dt(L),done:!1})}cancel(L){var C;(C=this._reader)==null||C.cancel(L),this._abortController.abort()}}class g{constructor(L,C,v){this._stream=L,this._reader=null,this._loaded=0;const y=L.source;this._withCredentials=y.withCredentials||!1,this._readCapability=new a.PromiseCapability,this._isStreamingSupported=!y.disableStream,this._abortController=new AbortController,this._headers=j(this._stream.httpHeaders),this._headers.append("Range",`bytes=${C}-${v-1}`);const u=y.url;fetch(u,V(this._headers,this._withCredentials,this._abortController)).then(_=>{if(!(0,p.validateResponseStatus)(_.status))throw(0,p.createResponseStatusError)(_.status,u);this._readCapability.resolve(),this._reader=_.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var v;await this._readCapability.promise;const{value:L,done:C}=await this._reader.read();return C?{value:L,done:C}:(this._loaded+=L.byteLength,(v=this.onProgress)==null||v.call(this,{loaded:this._loaded}),{value:dt(L),done:!1})}cancel(L){var C;(C=this._reader)==null||C.cancel(L),this._abortController.abort()}}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=F,r.extractFilenameFromHeader=dt,r.validateRangeRequestCapabilities=j,r.validateResponseStatus=x;var a=U(1),p=U(21),V=U(6);function j({getResponseHeader:g,isHttp:D,rangeChunkSize:L,disableRange:C}){const v={allowRangeRequests:!1,suggestedLength:void 0},y=parseInt(g("Content-Length"),10);return!Number.isInteger(y)||(v.suggestedLength=y,y<=2*L)||C||!D||g("Accept-Ranges")!=="bytes"||(g("Content-Encoding")||"identity")!=="identity"||(v.allowRangeRequests=!0),v}function dt(g){const D=g("Content-Disposition");if(D){let L=(0,p.getFilenameFromContentDispositionHeader)(D);if(L.includes("%"))try{L=decodeURIComponent(L)}catch{}if((0,V.isPdfFile)(L))return L}return null}function F(g,D){return g===404||g===0&&D.startsWith("file:")?new a.MissingPDFException('Missing PDF "'+D+'".'):new a.UnexpectedResponseException(`Unexpected server response (${g}) while retrieving PDF "${D}".`,g)}function x(g){return g===200||g===206}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=p;var a=U(1);function p(V){let j=!0,dt=F("filename\\*","i").exec(V);if(dt){dt=dt[1];let y=L(dt);return y=unescape(y),y=C(y),y=v(y),g(y)}if(dt=D(V),dt){const y=v(dt);return g(y)}if(dt=F("filename","i").exec(V),dt){dt=dt[1];let y=L(dt);return y=v(y),g(y)}function F(y,u){return new RegExp("(?:^|;)\\s*"+y+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function x(y,u){if(y){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const _=new TextDecoder(y,{fatal:!0}),P=(0,a.stringToBytes)(u);u=_.decode(P),j=!1}catch{}}return u}function g(y){return j&&/[\x80-\xff]/.test(y)&&(y=x("utf-8",y),j&&(y=x("iso-8859-1",y))),y}function D(y){const u=[];let _;const P=F("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(_=P.exec(y))!==null;){let[,A,o,h]=_;if(A=parseInt(A,10),A in u){if(A===0)break;continue}u[A]=[o,h]}const T=[];for(let A=0;A<u.length&&A in u;++A){let[o,h]=u[A];h=L(h),o&&(h=unescape(h),A===0&&(h=C(h))),T.push(h)}return T.join("")}function L(y){if(y.startsWith('"')){const u=y.slice(1).split('\\"');for(let _=0;_<u.length;++_){const P=u[_].indexOf('"');P!==-1&&(u[_]=u[_].slice(0,P),u.length=_+1),u[_]=u[_].replaceAll(/\\(.)/g,"$1")}y=u.join('"')}return y}function C(y){const u=y.indexOf("'");if(u===-1)return y;const _=y.slice(0,u),T=y.slice(u+1).replace(/^[^']*'/,"");return x(_,T)}function v(y){return!y.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(y)?y:y.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,_,P,T){if(P==="q"||P==="Q")return T=T.replaceAll("_"," "),T=T.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,o){return String.fromCharCode(parseInt(o,16))}),x(_,T);try{T=atob(T)}catch{}return x(_,T)})}return""}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var a=U(1),p=U(20);const V=200,j=206;function dt(L){const C=L.response;return typeof C!="string"?C:(0,a.stringToBytes)(C).buffer}class F{constructor(C,v={}){this.url=C,this.isHttp=/^https?:/i.test(C),this.httpHeaders=this.isHttp&&v.httpHeaders||Object.create(null),this.withCredentials=v.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(C,v,y){const u={begin:C,end:v};for(const _ in y)u[_]=y[_];return this.request(u)}requestFull(C){return this.request(C)}request(C){const v=new XMLHttpRequest,y=this.currXhrId++,u=this.pendingRequests[y]={xhr:v};v.open("GET",this.url),v.withCredentials=this.withCredentials;for(const _ in this.httpHeaders){const P=this.httpHeaders[_];P!==void 0&&v.setRequestHeader(_,P)}return this.isHttp&&"begin"in C&&"end"in C?(v.setRequestHeader("Range",`bytes=${C.begin}-${C.end-1}`),u.expectedStatus=j):u.expectedStatus=V,v.responseType="arraybuffer",C.onError&&(v.onerror=function(_){C.onError(v.status)}),v.onreadystatechange=this.onStateChange.bind(this,y),v.onprogress=this.onProgress.bind(this,y),u.onHeadersReceived=C.onHeadersReceived,u.onDone=C.onDone,u.onError=C.onError,u.onProgress=C.onProgress,v.send(null),y}onProgress(C,v){var u;const y=this.pendingRequests[C];y&&((u=y.onProgress)==null||u.call(y,v))}onStateChange(C,v){var A,o,h;const y=this.pendingRequests[C];if(!y)return;const u=y.xhr;if(u.readyState>=2&&y.onHeadersReceived&&(y.onHeadersReceived(),delete y.onHeadersReceived),u.readyState!==4||!(C in this.pendingRequests))return;if(delete this.pendingRequests[C],u.status===0&&this.isHttp){(A=y.onError)==null||A.call(y,u.status);return}const _=u.status||V;if(!(_===V&&y.expectedStatus===j)&&_!==y.expectedStatus){(o=y.onError)==null||o.call(y,u.status);return}const T=dt(u);if(_===j){const k=u.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(k);y.onDone({begin:parseInt(m[1],10),chunk:T})}else T?y.onDone({begin:0,chunk:T}):(h=y.onError)==null||h.call(y,u.status)}getRequestXhr(C){return this.pendingRequests[C].xhr}isPendingRequest(C){return C in this.pendingRequests}abortRequest(C){const v=this.pendingRequests[C].xhr;delete this.pendingRequests[C],v.abort()}}class x{constructor(C){this._source=C,this._manager=new F(C.url,{httpHeaders:C.httpHeaders,withCredentials:C.withCredentials}),this._rangeChunkSize=C.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(C){const v=this._rangeRequestReaders.indexOf(C);v>=0&&this._rangeRequestReaders.splice(v,1)}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader}getRangeReader(C,v){const y=new D(this._manager,C,v);return y.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(y),y}cancelAllRequests(C){var v;(v=this._fullRequestReader)==null||v.cancel(C);for(const y of this._rangeRequestReaders.slice(0))y.cancel(C)}}r.PDFNetworkStream=x;class g{constructor(C,v){this._manager=C;const y={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._fullRequestId=C.requestFull(y),this._headersReceivedCapability=new a.PromiseCapability,this._disableRange=v.disableRange||!1,this._contentLength=v.length,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const C=this._fullRequestId,v=this._manager.getRequestXhr(C),y=P=>v.getResponseHeader(P),{allowRangeRequests:u,suggestedLength:_}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});u&&(this._isRangeSupported=!0),this._contentLength=_||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(y),this._isRangeSupported&&this._manager.abortRequest(C),this._headersReceivedCapability.resolve()}_onDone(C){if(C&&(this._requests.length>0?this._requests.shift().resolve({value:C.chunk,done:!1}):this._cachedChunks.push(C.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(C){this._storedError=(0,p.createResponseStatusError)(C,this._url),this._headersReceivedCapability.reject(this._storedError);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(C){var v;(v=this.onProgress)==null||v.call(this,{loaded:C.loaded,total:C.lengthComputable?C.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=new a.PromiseCapability;return this._requests.push(C),C.promise}cancel(C){this._done=!0,this._headersReceivedCapability.reject(C);for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class D{constructor(C,v,y){this._manager=C;const u={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=C.url,this._requestId=C.requestRange(v,y,u),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var C;(C=this.onClosed)==null||C.call(this,this)}_onDone(C){const v=C.chunk;this._requests.length>0?this._requests.shift().resolve({value:v,done:!1}):this._queuedChunk=v,this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(C){this._storedError=(0,p.createResponseStatusError)(C,this._url);for(const v of this._requests)v.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(C){var v;this.isStreamingSupported||(v=this.onProgress)==null||v.call(this,{loaded:C.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const C=new a.PromiseCapability;return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var a=U(1),p=U(20);const V=/^file:\/\/\/[a-zA-Z]:\//;function j(y){const u=require$$5,_=u.parse(y);return _.protocol==="file:"||_.host?_:/^[a-z]:[/\\]/i.test(y)?u.parse(`file:///${y}`):(_.host||(_.protocol="file:"),_)}class dt{constructor(u){this.source=u,this.url=j(u.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var u;return((u=this._fullRequestReader)==null?void 0:u._loaded)??0}getFullReader(){return(0,a.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new C(this):new D(this),this._fullRequestReader}getRangeReader(u,_){if(_<=this._progressiveDataLength)return null;const P=this.isFsUrl?new v(this,u,_):new L(this,u,_);return this._rangeRequestReaders.push(P),P}cancelAllRequests(u){var _;(_=this._fullRequestReader)==null||_.cancel(u);for(const P of this._rangeRequestReaders.slice(0))P.cancel(u)}}r.PDFNodeStream=dt;class F{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null;const _=u.source;this._contentLength=_.length,this._loaded=0,this._filename=null,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._readableStream=null,this._readCapability=new a.PromiseCapability,this._headersCapability=new a.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=u.length,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",_=>{this._error(_)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class x{constructor(u){this._url=u.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new a.PromiseCapability;const _=u.source;this._isStreamingSupported=!_.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var P;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const u=this._readableStream.read();return u===null?(this._readCapability=new a.PromiseCapability,this.read()):(this._loaded+=u.length,(P=this.onProgress)==null||P.call(this,{loaded:this._loaded}),{value:new Uint8Array(u).buffer,done:!1})}cancel(u){if(!this._readableStream){this._error(u);return}this._readableStream.destroy(u)}_error(u){this._storedError=u,this._readCapability.resolve()}_setReadableStream(u){this._readableStream=u,u.on("readable",()=>{this._readCapability.resolve()}),u.on("end",()=>{u.destroy(),this._done=!0,this._readCapability.resolve()}),u.on("error",_=>{this._error(_)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function g(y,u){return{protocol:y.protocol,auth:y.auth,host:y.hostname,port:y.port,path:y.path,method:"GET",headers:u}}class D extends F{constructor(u){super(u);const _=P=>{if(P.statusCode===404){const h=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h,this._headersCapability.reject(h);return}this._headersCapability.resolve(),this._setReadableStream(P);const T=h=>this._readableStream.headers[h.toLowerCase()],{allowRangeRequests:A,suggestedLength:o}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:T,isHttp:u.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=o||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(T)};if(this._request=null,this._url.protocol==="http:"){const P=require$$5;this._request=P.request(g(this._url,u.httpHeaders),_)}else{const P=require$$5;this._request=P.request(g(this._url,u.httpHeaders),_)}this._request.on("error",P=>{this._storedError=P,this._headersCapability.reject(P)}),this._request.end()}}class L extends x{constructor(u,_,P){super(u),this._httpHeaders={};for(const A in u.httpHeaders){const o=u.httpHeaders[A];o!==void 0&&(this._httpHeaders[A]=o)}this._httpHeaders.Range=`bytes=${_}-${P-1}`;const T=A=>{if(A.statusCode===404){const o=new a.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(g(this._url,this._httpHeaders),T)}else{const A=require$$5;this._request=A.request(g(this._url,this._httpHeaders),T)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class C extends F{constructor(u){super(u);let _=decodeURIComponent(this._url.path);V.test(this._url.href)&&(_=_.replace(/^\//,""));const P=require$$5;P.lstat(_,(T,A)=>{if(T){T.code==="ENOENT"&&(T=new a.MissingPDFException(`Missing PDF "${_}".`)),this._storedError=T,this._headersCapability.reject(T);return}this._contentLength=A.size,this._setReadableStream(P.createReadStream(_)),this._headersCapability.resolve()})}}class v extends x{constructor(u,_,P){super(u);let T=decodeURIComponent(this._url.path);V.test(this._url.href)&&(T=T.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(T,{start:_,end:P-1}))}}},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var a=U(6),p=U(1);const V={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},j="http://www.w3.org/XML/1998/namespace",dt="http://www.w3.org/1999/xlink",F=["butt","round","square"],x=["miter","round","bevel"],g=function(A,o="",h=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!h)return URL.createObjectURL(new Blob([A],{type:o}));const k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let m=`data:${o};base64,`;for(let l=0,R=A.length;l<R;l+=3){const f=A[l]&255,$=A[l+1]&255,G=A[l+2]&255,S=f>>2,q=(f&3)<<4|$>>4,it=l+1<R?($&15)<<2|G>>6:64,ot=l+2<R?G&63:64;m+=k[S]+k[q]+k[it]+k[ot]}return m},D=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,h=new Int32Array(256);for(let G=0;G<256;G++){let S=G;for(let q=0;q<8;q++)S=S&1?3988292384^S>>1&2147483647:S>>1&2147483647;h[G]=S}function k(G,S,q){let it=-1;for(let ot=S;ot<q;ot++){const W=(it^G[ot])&255,ct=h[W];it=it>>>8^ct}return it^-1}function m(G,S,q,it){let ot=it;const W=S.length;q[ot]=W>>24&255,q[ot+1]=W>>16&255,q[ot+2]=W>>8&255,q[ot+3]=W&255,ot+=4,q[ot]=G.charCodeAt(0)&255,q[ot+1]=G.charCodeAt(1)&255,q[ot+2]=G.charCodeAt(2)&255,q[ot+3]=G.charCodeAt(3)&255,ot+=4,q.set(S,ot),ot+=S.length;const ct=k(q,it+4,ot);q[ot]=ct>>24&255,q[ot+1]=ct>>16&255,q[ot+2]=ct>>8&255,q[ot+3]=ct&255}function l(G,S,q){let it=1,ot=0;for(let W=S;W<q;++W)it=(it+(G[W]&255))%65521,ot=(ot+it)%65521;return ot<<16|it}function R(G){if(!p.isNodeJS)return f(G);try{const S=parseInt(process.versions.node)>=8?G:Buffer.from(G),q=require$$5.deflateSync(S,{level:9});return q instanceof Uint8Array?q:new Uint8Array(q)}catch(S){(0,p.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+S)}return f(G)}function f(G){let S=G.length;const q=65535,it=Math.ceil(S/q),ot=new Uint8Array(2+S+it*5+4);let W=0;ot[W++]=120,ot[W++]=156;let ct=0;for(;S>q;)ot[W++]=0,ot[W++]=255,ot[W++]=255,ot[W++]=0,ot[W++]=0,ot.set(G.subarray(ct,ct+q),W),W+=q,ct+=q,S-=q;ot[W++]=1,ot[W++]=S&255,ot[W++]=S>>8&255,ot[W++]=~S&65535&255,ot[W++]=(~S&65535)>>8&255,ot.set(G.subarray(ct),W),W+=G.length-ct;const gt=l(G,0,G.length);return ot[W++]=gt>>24&255,ot[W++]=gt>>16&255,ot[W++]=gt>>8&255,ot[W++]=gt&255,ot}function $(G,S,q,it){const ot=G.width,W=G.height;let ct,gt,vt;const Tt=G.data;switch(S){case p.ImageKind.GRAYSCALE_1BPP:gt=0,ct=1,vt=ot+7>>3;break;case p.ImageKind.RGB_24BPP:gt=2,ct=8,vt=ot*3;break;case p.ImageKind.RGBA_32BPP:gt=6,ct=8,vt=ot*4;break;default:throw new Error("invalid format")}const w=new Uint8Array((1+vt)*W);let n=0,i=0;for(let N=0;N<W;++N)w[n++]=0,w.set(Tt.subarray(i,i+vt),n),i+=vt,n+=vt;if(S===p.ImageKind.GRAYSCALE_1BPP&&it){n=0;for(let N=0;N<W;N++){n++;for(let st=0;st<vt;st++)w[n++]^=255}}const s=new Uint8Array([ot>>24&255,ot>>16&255,ot>>8&255,ot&255,W>>24&255,W>>16&255,W>>8&255,W&255,ct,gt,0,0,0]),c=R(w),d=A.length+o*3+s.length+c.length,E=new Uint8Array(d);let M=0;return E.set(A,M),M+=A.length,m("IHDR",s,E,M),M+=o+s.length,m("IDATA",c,E,M),M+=o+c.length,m("IEND",new Uint8Array(0),E,M),g(E,"image/png",q)}return function(S,q,it){const ot=S.kind===void 0?p.ImageKind.GRAYSCALE_1BPP:S.kind;return $(S,ot,q,it)}}();class L{constructor(){this.fontSizeScale=1,this.fontWeight=V.fontWeight,this.fontSize=0,this.textMatrix=p.IDENTITY_MATRIX,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=p.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=V.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,h){this.x=o,this.y=h}}function C(A){let o=[];const h=[];for(const k of A){if(k.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),h.push(o),o=o.at(-1).items;continue}k.fn==="restore"?o=h.pop():o.push(k)}return o}function v(A){if(Number.isInteger(A))return A.toString();const o=A.toFixed(10);let h=o.length-1;if(o[h]!=="0")return o;do h--;while(o[h]==="0");return o.substring(0,o[h]==="."?h:h+1)}function y(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":`scale(${v(A[0])} ${v(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){const o=Math.acos(A[0])*180/Math.PI;return`rotate(${v(o)})`}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return`translate(${v(A[4])} ${v(A[5])})`;return`matrix(${v(A[0])} ${v(A[1])} ${v(A[2])} ${v(A[3])} ${v(A[4])} ${v(A[5])})`}let u=0,_=0,P=0;class T{constructor(o,h,k=!1){(0,a.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new a.DOMSVGFactory,this.current=new L,this.transformMatrix=p.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=o,this.objs=h,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!k,this._operatorIdMapping=[];for(const m in p.OPS)this._operatorIdMapping[p.OPS[m]]=m}getObject(o,h=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):h}save(){this.transformStack.push(this.transformMatrix);const o=this.current;this.extraStack.push(o),this.current=o.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(o){this.save(),this.executeOpTree(o),this.restore()}loadDependencies(o){const h=o.fnArray,k=o.argsArray;for(let m=0,l=h.length;m<l;m++)if(h[m]===p.OPS.dependency)for(const R of k[m]){const f=R.startsWith("g_")?this.commonObjs:this.objs,$=new Promise(G=>{f.get(R,G)});this.current.dependencies.push($)}return Promise.all(this.current.dependencies)}transform(o,h,k,m,l,R){const f=[o,h,k,m,l,R];this.transformMatrix=p.Util.transform(this.transformMatrix,f),this.tgrp=null}getSVG(o,h){this.viewport=h;const k=this._initialize(h);return this.loadDependencies(o).then(()=>(this.transformMatrix=p.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(o)),k))}convertOpList(o){const h=this._operatorIdMapping,k=o.argsArray,m=o.fnArray,l=[];for(let R=0,f=m.length;R<f;R++){const $=m[R];l.push({fnId:$,fn:h[$],args:k[R]})}return C(l)}executeOpTree(o){for(const h of o){const k=h.fn,m=h.fnId,l=h.args;switch(m|0){case p.OPS.beginText:this.beginText();break;case p.OPS.dependency:break;case p.OPS.setLeading:this.setLeading(l);break;case p.OPS.setLeadingMoveText:this.setLeadingMoveText(l[0],l[1]);break;case p.OPS.setFont:this.setFont(l);break;case p.OPS.showText:this.showText(l[0]);break;case p.OPS.showSpacedText:this.showText(l[0]);break;case p.OPS.endText:this.endText();break;case p.OPS.moveText:this.moveText(l[0],l[1]);break;case p.OPS.setCharSpacing:this.setCharSpacing(l[0]);break;case p.OPS.setWordSpacing:this.setWordSpacing(l[0]);break;case p.OPS.setHScale:this.setHScale(l[0]);break;case p.OPS.setTextMatrix:this.setTextMatrix(l[0],l[1],l[2],l[3],l[4],l[5]);break;case p.OPS.setTextRise:this.setTextRise(l[0]);break;case p.OPS.setTextRenderingMode:this.setTextRenderingMode(l[0]);break;case p.OPS.setLineWidth:this.setLineWidth(l[0]);break;case p.OPS.setLineJoin:this.setLineJoin(l[0]);break;case p.OPS.setLineCap:this.setLineCap(l[0]);break;case p.OPS.setMiterLimit:this.setMiterLimit(l[0]);break;case p.OPS.setFillRGBColor:this.setFillRGBColor(l[0],l[1],l[2]);break;case p.OPS.setStrokeRGBColor:this.setStrokeRGBColor(l[0],l[1],l[2]);break;case p.OPS.setStrokeColorN:this.setStrokeColorN(l);break;case p.OPS.setFillColorN:this.setFillColorN(l);break;case p.OPS.shadingFill:this.shadingFill(l[0]);break;case p.OPS.setDash:this.setDash(l[0],l[1]);break;case p.OPS.setRenderingIntent:this.setRenderingIntent(l[0]);break;case p.OPS.setFlatness:this.setFlatness(l[0]);break;case p.OPS.setGState:this.setGState(l[0]);break;case p.OPS.fill:this.fill();break;case p.OPS.eoFill:this.eoFill();break;case p.OPS.stroke:this.stroke();break;case p.OPS.fillStroke:this.fillStroke();break;case p.OPS.eoFillStroke:this.eoFillStroke();break;case p.OPS.clip:this.clip("nonzero");break;case p.OPS.eoClip:this.clip("evenodd");break;case p.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case p.OPS.paintImageXObject:this.paintImageXObject(l[0]);break;case p.OPS.paintInlineImageXObject:this.paintInlineImageXObject(l[0]);break;case p.OPS.paintImageMaskXObject:this.paintImageMaskXObject(l[0]);break;case p.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(l[0],l[1]);break;case p.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case p.OPS.closePath:this.closePath();break;case p.OPS.closeStroke:this.closeStroke();break;case p.OPS.closeFillStroke:this.closeFillStroke();break;case p.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case p.OPS.nextLine:this.nextLine();break;case p.OPS.transform:this.transform(l[0],l[1],l[2],l[3],l[4],l[5]);break;case p.OPS.constructPath:this.constructPath(l[0],l[1]);break;case p.OPS.endPath:this.endPath();break;case 92:this.group(h.items);break;default:(0,p.warn)(`Unimplemented operator ${k}`);break}}}setWordSpacing(o){this.current.wordSpacing=o}setCharSpacing(o){this.current.charSpacing=o}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(o,h,k,m,l,R){const f=this.current;f.textMatrix=f.lineMatrix=[o,h,k,m,l,R],f.textMatrixScale=Math.hypot(o,h),f.x=f.lineX=0,f.y=f.lineY=0,f.xcoords=[],f.ycoords=[],f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${v(f.fontSize)}px`),f.tspan.setAttributeNS(null,"y",v(-f.y)),f.txtElement=this.svgFactory.createElement("svg:text"),f.txtElement.append(f.tspan)}beginText(){const o=this.current;o.x=o.lineX=0,o.y=o.lineY=0,o.textMatrix=p.IDENTITY_MATRIX,o.lineMatrix=p.IDENTITY_MATRIX,o.textMatrixScale=1,o.tspan=this.svgFactory.createElement("svg:tspan"),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtgrp=this.svgFactory.createElement("svg:g"),o.xcoords=[],o.ycoords=[]}moveText(o,h){const k=this.current;k.x=k.lineX+=o,k.y=k.lineY+=h,k.xcoords=[],k.ycoords=[],k.tspan=this.svgFactory.createElement("svg:tspan"),k.tspan.setAttributeNS(null,"font-family",k.fontFamily),k.tspan.setAttributeNS(null,"font-size",`${v(k.fontSize)}px`),k.tspan.setAttributeNS(null,"y",v(-k.y))}showText(o){const h=this.current,k=h.font,m=h.fontSize;if(m===0)return;const l=h.fontSizeScale,R=h.charSpacing,f=h.wordSpacing,$=h.fontDirection,G=h.textHScale*$,S=k.vertical,q=S?1:-1,it=k.defaultVMetrics,ot=m*h.fontMatrix[0];let W=0;for(const vt of o){if(vt===null){W+=$*f;continue}else if(typeof vt=="number"){W+=q*vt*m/1e3;continue}const Tt=(vt.isSpace?f:0)+R,w=vt.fontChar;let n,i,s=vt.width;if(S){let d;const E=vt.vmetric||it;d=vt.vmetric?E[1]:s*.5,d=-d*ot;const M=E[2]*ot;s=E?-E[0]:s,n=d/l,i=(W+M)/l}else n=W/l,i=0;(vt.isInFont||k.missingFile)&&(h.xcoords.push(h.x+n),S&&h.ycoords.push(-h.y+i),h.tspan.textContent+=w);const c=S?s*ot-Tt*$:s*ot+Tt*$;W+=c}h.tspan.setAttributeNS(null,"x",h.xcoords.map(v).join(" ")),S?h.tspan.setAttributeNS(null,"y",h.ycoords.map(v).join(" ")):h.tspan.setAttributeNS(null,"y",v(-h.y)),S?h.y-=W:h.x+=W*G,h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${v(h.fontSize)}px`),h.fontStyle!==V.fontStyle&&h.tspan.setAttributeNS(null,"font-style",h.fontStyle),h.fontWeight!==V.fontWeight&&h.tspan.setAttributeNS(null,"font-weight",h.fontWeight);const ct=h.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;if(ct===p.TextRenderingMode.FILL||ct===p.TextRenderingMode.FILL_STROKE?(h.fillColor!==V.fillColor&&h.tspan.setAttributeNS(null,"fill",h.fillColor),h.fillAlpha<1&&h.tspan.setAttributeNS(null,"fill-opacity",h.fillAlpha)):h.textRenderingMode===p.TextRenderingMode.ADD_TO_PATH?h.tspan.setAttributeNS(null,"fill","transparent"):h.tspan.setAttributeNS(null,"fill","none"),ct===p.TextRenderingMode.STROKE||ct===p.TextRenderingMode.FILL_STROKE){const vt=1/(h.textMatrixScale||1);this._setStrokeAttributes(h.tspan,vt)}let gt=h.textMatrix;h.textRise!==0&&(gt=gt.slice(),gt[5]+=h.textRise),h.txtElement.setAttributeNS(null,"transform",`${y(gt)} scale(${v(G)}, -1)`),h.txtElement.setAttributeNS(j,"xml:space","preserve"),h.txtElement.append(h.tspan),h.txtgrp.append(h.txtElement),this._ensureTransformGroup().append(h.txtElement)}setLeadingMoveText(o,h){this.setLeading(-h),this.moveText(o,h)}addFontStyle(o){if(!o.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const h=g(o.data,o.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${o.loadedName}"; src: url(${h}); }
`}setFont(o){const h=this.current,k=this.commonObjs.get(o[0]);let m=o[1];h.font=k,this.embedFonts&&!k.missingFile&&!this.embeddedFonts[k.loadedName]&&(this.addFontStyle(k),this.embeddedFonts[k.loadedName]=k),h.fontMatrix=k.fontMatrix||p.FONT_IDENTITY_MATRIX;let l="normal";k.black?l="900":k.bold&&(l="bold");const R=k.italic?"italic":"normal";m<0?(m=-m,h.fontDirection=-1):h.fontDirection=1,h.fontSize=m,h.fontFamily=k.loadedName,h.fontWeight=l,h.fontStyle=R,h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"y",v(-h.y)),h.xcoords=[],h.ycoords=[]}endText(){var h;const o=this.current;o.textRenderingMode&p.TextRenderingMode.ADD_TO_PATH_FLAG&&((h=o.txtElement)!=null&&h.hasChildNodes())&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(o){o>0&&(this.current.lineWidth=o)}setLineCap(o){this.current.lineCap=F[o]}setLineJoin(o){this.current.lineJoin=x[o]}setMiterLimit(o){this.current.miterLimit=o}setStrokeAlpha(o){this.current.strokeAlpha=o}setStrokeRGBColor(o,h,k){this.current.strokeColor=p.Util.makeHexColor(o,h,k)}setFillAlpha(o){this.current.fillAlpha=o}setFillRGBColor(o,h,k){this.current.fillColor=p.Util.makeHexColor(o,h,k),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(o){this.current.strokeColor=this._makeColorN_Pattern(o)}setFillColorN(o){this.current.fillColor=this._makeColorN_Pattern(o)}shadingFill(o){const{width:h,height:k}=this.viewport,m=p.Util.inverseTransform(this.transformMatrix),[l,R,f,$]=p.Util.getAxialAlignedBoundingBox([0,0,h,k],m),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x",l),G.setAttributeNS(null,"y",R),G.setAttributeNS(null,"width",f-l),G.setAttributeNS(null,"height",$-R),G.setAttributeNS(null,"fill",this._makeShadingPattern(o)),this.current.fillAlpha<1&&G.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(G)}_makeColorN_Pattern(o){return o[0]==="TilingPattern"?this._makeTilingPattern(o):this._makeShadingPattern(o)}_makeTilingPattern(o){const h=o[1],k=o[2],m=o[3]||p.IDENTITY_MATRIX,[l,R,f,$]=o[4],G=o[5],S=o[6],q=o[7],it=`shading${P++}`,[ot,W,ct,gt]=p.Util.normalizeRect([...p.Util.applyTransform([l,R],m),...p.Util.applyTransform([f,$],m)]),[vt,Tt]=p.Util.singularValueDecompose2dScale(m),w=G*vt,n=S*Tt,i=this.svgFactory.createElement("svg:pattern");i.setAttributeNS(null,"id",it),i.setAttributeNS(null,"patternUnits","userSpaceOnUse"),i.setAttributeNS(null,"width",w),i.setAttributeNS(null,"height",n),i.setAttributeNS(null,"x",`${ot}`),i.setAttributeNS(null,"y",`${W}`);const s=this.svg,c=this.transformMatrix,d=this.current.fillColor,E=this.current.strokeColor,M=this.svgFactory.create(ct-ot,gt-W);if(this.svg=M,this.transformMatrix=m,q===2){const N=p.Util.makeHexColor(...h);this.current.fillColor=N,this.current.strokeColor=N}return this.executeOpTree(this.convertOpList(k)),this.svg=s,this.transformMatrix=c,this.current.fillColor=d,this.current.strokeColor=E,i.append(M.childNodes[0]),this.defs.append(i),`url(#${it})`}_makeShadingPattern(o){switch(typeof o=="string"&&(o=this.objs.get(o)),o[0]){case"RadialAxial":const h=`shading${P++}`,k=o[3];let m;switch(o[1]){case"axial":const l=o[4],R=o[5];m=this.svgFactory.createElement("svg:linearGradient"),m.setAttributeNS(null,"id",h),m.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),m.setAttributeNS(null,"x1",l[0]),m.setAttributeNS(null,"y1",l[1]),m.setAttributeNS(null,"x2",R[0]),m.setAttributeNS(null,"y2",R[1]);break;case"radial":const f=o[4],$=o[5],G=o[6],S=o[7];m=this.svgFactory.createElement("svg:radialGradient"),m.setAttributeNS(null,"id",h),m.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),m.setAttributeNS(null,"cx",$[0]),m.setAttributeNS(null,"cy",$[1]),m.setAttributeNS(null,"r",S),m.setAttributeNS(null,"fx",f[0]),m.setAttributeNS(null,"fy",f[1]),m.setAttributeNS(null,"fr",G);break;default:throw new Error(`Unknown RadialAxial type: ${o[1]}`)}for(const l of k){const R=this.svgFactory.createElement("svg:stop");R.setAttributeNS(null,"offset",l[0]),R.setAttributeNS(null,"stop-color",l[1]),m.append(R)}return this.defs.append(m),`url(#${h})`;case"Mesh":return(0,p.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${o[0]}`)}}setDash(o,h){this.current.dashArray=o,this.current.dashPhase=h}constructPath(o,h){const k=this.current;let m=k.x,l=k.y,R=[],f=0;for(const $ of o)switch($|0){case p.OPS.rectangle:m=h[f++],l=h[f++];const G=h[f++],S=h[f++],q=m+G,it=l+S;R.push("M",v(m),v(l),"L",v(q),v(l),"L",v(q),v(it),"L",v(m),v(it),"Z");break;case p.OPS.moveTo:m=h[f++],l=h[f++],R.push("M",v(m),v(l));break;case p.OPS.lineTo:m=h[f++],l=h[f++],R.push("L",v(m),v(l));break;case p.OPS.curveTo:m=h[f+4],l=h[f+5],R.push("C",v(h[f]),v(h[f+1]),v(h[f+2]),v(h[f+3]),v(m),v(l)),f+=6;break;case p.OPS.curveTo2:R.push("C",v(m),v(l),v(h[f]),v(h[f+1]),v(h[f+2]),v(h[f+3])),m=h[f+2],l=h[f+3],f+=4;break;case p.OPS.curveTo3:m=h[f+2],l=h[f+3],R.push("C",v(h[f]),v(h[f+1]),v(m),v(l),v(m),v(l)),f+=4;break;case p.OPS.closePath:R.push("Z");break}R=R.join(" "),k.path&&o.length>0&&o[0]!==p.OPS.rectangle&&o[0]!==p.OPS.moveTo?R=k.path.getAttributeNS(null,"d")+R:(k.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(k.path)),k.path.setAttributeNS(null,"d",R),k.path.setAttributeNS(null,"fill","none"),k.element=k.path,k.setCurrentPoint(m,l)}endPath(){const o=this.current;if(o.path=null,!this.pendingClip)return;if(!o.element){this.pendingClip=null;return}const h=`clippath${u++}`,k=this.svgFactory.createElement("svg:clipPath");k.setAttributeNS(null,"id",h),k.setAttributeNS(null,"transform",y(this.transformMatrix));const m=o.element.cloneNode(!0);if(this.pendingClip==="evenodd"?m.setAttributeNS(null,"clip-rule","evenodd"):m.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,k.append(m),this.defs.append(k),o.activeClipUrl){o.clipGroup=null;for(const l of this.extraStack)l.clipGroup=null;k.setAttributeNS(null,"clip-path",o.activeClipUrl)}o.activeClipUrl=`url(#${h})`,this.tgrp=null}clip(o){this.pendingClip=o}closePath(){const o=this.current;if(o.path){const h=`${o.path.getAttributeNS(null,"d")}Z`;o.path.setAttributeNS(null,"d",h)}}setLeading(o){this.current.leading=-o}setTextRise(o){this.current.textRise=o}setTextRenderingMode(o){this.current.textRenderingMode=o}setHScale(o){this.current.textHScale=o/100}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[h,k]of o)switch(h){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k);break;case"CA":this.setStrokeAlpha(k);break;case"ca":this.setFillAlpha(k);break;default:(0,p.warn)(`Unimplemented graphic state operator ${h}`);break}}fill(){const o=this.current;o.element&&(o.element.setAttributeNS(null,"fill",o.fillColor),o.element.setAttributeNS(null,"fill-opacity",o.fillAlpha),this.endPath())}stroke(){const o=this.current;o.element&&(this._setStrokeAttributes(o.element),o.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(o,h=1){const k=this.current;let m=k.dashArray;h!==1&&m.length>0&&(m=m.map(function(l){return h*l})),o.setAttributeNS(null,"stroke",k.strokeColor),o.setAttributeNS(null,"stroke-opacity",k.strokeAlpha),o.setAttributeNS(null,"stroke-miterlimit",v(k.miterLimit)),o.setAttributeNS(null,"stroke-linecap",k.lineCap),o.setAttributeNS(null,"stroke-linejoin",k.lineJoin),o.setAttributeNS(null,"stroke-width",v(h*k.lineWidth)+"px"),o.setAttributeNS(null,"stroke-dasharray",m.map(v).join(" ")),o.setAttributeNS(null,"stroke-dashoffset",v(h*k.dashPhase)+"px")}eoFill(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width","1px"),o.setAttributeNS(null,"height","1px"),o.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(o)}paintImageXObject(o){const h=this.getObject(o);if(!h){(0,p.warn)(`Dependent image with object ID ${o} is not ready yet`);return}this.paintInlineImageXObject(h)}paintInlineImageXObject(o,h){const k=o.width,m=o.height,l=D(o,this.forceDataSchema,!!h),R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y","0"),R.setAttributeNS(null,"width",v(k)),R.setAttributeNS(null,"height",v(m)),this.current.element=R,this.clip("nonzero");const f=this.svgFactory.createElement("svg:image");f.setAttributeNS(dt,"xlink:href",l),f.setAttributeNS(null,"x","0"),f.setAttributeNS(null,"y",v(-m)),f.setAttributeNS(null,"width",v(k)+"px"),f.setAttributeNS(null,"height",v(m)+"px"),f.setAttributeNS(null,"transform",`scale(${v(1/k)} ${v(-1/m)})`),h?h.append(f):this._ensureTransformGroup().append(f)}paintImageMaskXObject(o){const h=this.getObject(o.data,o);if(h.bitmap){(0,p.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const k=this.current,m=h.width,l=h.height,R=k.fillColor;k.maskId=`mask${_++}`;const f=this.svgFactory.createElement("svg:mask");f.setAttributeNS(null,"id",k.maskId);const $=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x","0"),$.setAttributeNS(null,"y","0"),$.setAttributeNS(null,"width",v(m)),$.setAttributeNS(null,"height",v(l)),$.setAttributeNS(null,"fill",R),$.setAttributeNS(null,"mask",`url(#${k.maskId})`),this.defs.append(f),this._ensureTransformGroup().append($),this.paintInlineImageXObject(h,f)}paintFormXObjectBegin(o,h){if(Array.isArray(o)&&o.length===6&&this.transform(o[0],o[1],o[2],o[3],o[4],o[5]),h){const k=h[2]-h[0],m=h[3]-h[1],l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x",h[0]),l.setAttributeNS(null,"y",h[1]),l.setAttributeNS(null,"width",v(k)),l.setAttributeNS(null,"height",v(m)),this.current.element=l,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(o){const h=this.svgFactory.create(o.width,o.height),k=this.svgFactory.createElement("svg:defs");h.append(k),this.defs=k;const m=this.svgFactory.createElement("svg:g");return m.setAttributeNS(null,"transform",y(o.transform)),h.append(m),this.svg=m,h}_ensureClipGroup(){if(!this.current.clipGroup){const o=this.svgFactory.createElement("svg:g");o.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(o),this.current.clipGroup=o}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",y(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}r.SVGGraphics=T},(H,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaText=void 0;class U{static textContent(p){const V=[],j={items:V,styles:Object.create(null)};function dt(F){var D;if(!F)return;let x=null;const g=F.name;if(g==="#text")x=F.value;else if(U.shouldBuildText(g))(D=F==null?void 0:F.attributes)!=null&&D.textContent?x=F.attributes.textContent:F.value&&(x=F.value);else return;if(x!==null&&V.push({str:x}),!!F.children)for(const L of F.children)dt(L)}return dt(p),j}static shouldBuildText(p){return!(p==="textarea"||p==="input"||p==="option"||p==="select")}}r.XfaText=U},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerRenderTask=void 0,r.renderTextLayer=y,r.updateTextLayer=u;var a=U(1),p=U(6);const V=1e5,j=30,dt=.8,F=new Map;function x(_,P){let T;if(P&&a.FeatureTest.isOffscreenCanvasSupported)T=new OffscreenCanvas(_,_).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=_,T=A.getContext("2d",{alpha:!1})}return T}function g(_,P){const T=F.get(_);if(T)return T;const A=x(j,P);A.font=`${j}px ${_}`;const o=A.measureText("");let h=o.fontBoundingBoxAscent,k=Math.abs(o.fontBoundingBoxDescent);if(h){const l=h/(h+k);return F.set(_,l),A.canvas.width=A.canvas.height=0,l}A.strokeStyle="red",A.clearRect(0,0,j,j),A.strokeText("g",0,0);let m=A.getImageData(0,0,j,j).data;k=0;for(let l=m.length-1-3;l>=0;l-=4)if(m[l]>0){k=Math.ceil(l/4/j);break}A.clearRect(0,0,j,j),A.strokeText("A",0,j),m=A.getImageData(0,0,j,j).data,h=0;for(let l=0,R=m.length;l<R;l+=4)if(m[l]>0){h=j-Math.floor(l/4/j);break}if(A.canvas.width=A.canvas.height=0,h){const l=h/(h+k);return F.set(_,l),l}return F.set(_,dt),dt}function D(_,P,T){const A=document.createElement("span"),o={angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL,fontSize:0};_._textDivs.push(A);const h=a.Util.transform(_._transform,P.transform);let k=Math.atan2(h[1],h[0]);const m=T[P.fontName];m.vertical&&(k+=Math.PI/2);const l=Math.hypot(h[2],h[3]),R=l*g(m.fontFamily,_._isOffscreenCanvasSupported);let f,$;k===0?(f=h[4],$=h[5]-R):(f=h[4]+R*Math.sin(k),$=h[5]-R*Math.cos(k));const G="calc(var(--scale-factor)*",S=A.style;_._container===_._rootContainer?(S.left=`${(100*f/_._pageWidth).toFixed(2)}%`,S.top=`${(100*$/_._pageHeight).toFixed(2)}%`):(S.left=`${G}${f.toFixed(2)}px)`,S.top=`${G}${$.toFixed(2)}px)`),S.fontSize=`${G}${l.toFixed(2)}px)`,S.fontFamily=m.fontFamily,o.fontSize=l,A.setAttribute("role","presentation"),A.textContent=P.str,A.dir=P.dir,_._fontInspectorEnabled&&(A.dataset.fontName=P.fontName),k!==0&&(o.angle=k*(180/Math.PI));let q=!1;if(P.str.length>1)q=!0;else if(P.str!==" "&&P.transform[0]!==P.transform[3]){const it=Math.abs(P.transform[0]),ot=Math.abs(P.transform[3]);it!==ot&&Math.max(it,ot)/Math.min(it,ot)>1.5&&(q=!0)}q&&(o.canvasWidth=m.vertical?P.height:P.width),_._textDivProperties.set(A,o),_._isReadableStream&&_._layoutText(A)}function L(_){const{div:P,scale:T,properties:A,ctx:o,prevFontSize:h,prevFontFamily:k}=_,{style:m}=P;let l="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:R}=m,{canvasWidth:f,fontSize:$}=A;(h!==$||k!==R)&&(o.font=`${$*T}px ${R}`,_.prevFontSize=$,_.prevFontFamily=R);const{width:G}=o.measureText(P.textContent);G>0&&(l=`scaleX(${f*T/G})`)}A.angle!==0&&(l=`rotate(${A.angle}deg) ${l}`),l.length>0&&(m.transform=l)}function C(_){if(_._canceled)return;const P=_._textDivs,T=_._capability;if(P.length>V){T.resolve();return}if(!_._isReadableStream)for(const o of P)_._layoutText(o);T.resolve()}class v{constructor({textContentSource:P,container:T,viewport:A,textDivs:o,textDivProperties:h,textContentItemsStr:k,isOffscreenCanvasSupported:m}){var G;this._textContentSource=P,this._isReadableStream=P instanceof ReadableStream,this._container=this._rootContainer=T,this._textDivs=o||[],this._textContentItemsStr=k||[],this._isOffscreenCanvasSupported=m,this._fontInspectorEnabled=!!((G=globalThis.FontInspector)!=null&&G.enabled),this._reader=null,this._textDivProperties=h||new WeakMap,this._canceled=!1,this._capability=new a.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:x(0,m)};const{pageWidth:l,pageHeight:R,pageX:f,pageY:$}=A.rawDims;this._transform=[1,0,0,-1,-f,$+R],this._pageWidth=l,this._pageHeight=R,(0,p.setLayerDimensions)(T,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new a.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new a.AbortException("TextLayer task cancelled."))}_processItems(P,T){for(const A of P){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const o=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id",`${A.id}`),o.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),D(this,A,T)}}_layoutText(P){const T=this._layoutTextParams.properties=this._textDivProperties.get(P);if(this._layoutTextParams.div=P,L(this._layoutTextParams),T.hasText&&this._container.append(P),T.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const P=new a.PromiseCapability;let T=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:o,done:h})=>{if(h){P.resolve();return}Object.assign(T,o.styles),this._processItems(o.items,T),A()},P.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:o}=this._textContentSource;this._processItems(A,o),P.resolve()}else throw new Error('No "textContentSource" parameter specified.');P.promise.then(()=>{T=null,C(this)},this._capability.reject)}}r.TextLayerRenderTask=v;function y(_){!_.textContentSource&&(_.textContent||_.textContentStream)&&((0,p.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),_.textContentSource=_.textContent||_.textContentStream);const{container:P,viewport:T}=_,A=getComputedStyle(P),o=A.getPropertyValue("visibility"),h=parseFloat(A.getPropertyValue("--scale-factor"));o==="visible"&&(!h||Math.abs(h-T.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const k=new v(_);return k._render(),k}function u({container:_,viewport:P,textDivs:T,textDivProperties:A,isOffscreenCanvasSupported:o,mustRotate:h=!0,mustRescale:k=!0}){if(h&&(0,p.setLayerDimensions)(_,{rotation:P.rotation}),k){const m=x(0,o),R={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:m};for(const f of T)R.properties=A.get(f),R.div=f,L(R)}}},(H,r,U)=>{var g,D,L,C,v,y,u,_,P,T,A,en,h,Re,m,nn,R,sn;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditorLayer=void 0;var a=U(1),p=U(4),V=U(28),j=U(33),dt=U(6),F=U(34);const $=class ${constructor({uiManager:S,pageIndex:q,div:it,accessibilityManager:ot,annotationLayer:W,viewport:ct,l10n:gt}){B(this,A);B(this,h);B(this,m);B(this,R);B(this,g,void 0);B(this,D,!1);B(this,L,null);B(this,C,this.pointerup.bind(this));B(this,v,this.pointerdown.bind(this));B(this,y,new Map);B(this,u,!1);B(this,_,!1);B(this,P,!1);B(this,T,void 0);const vt=[V.FreeTextEditor,j.InkEditor,F.StampEditor];if(!$._initialized){$._initialized=!0;for(const Tt of vt)Tt.initialize(gt)}S.registerEditorTypes(vt),rt(this,T,S),this.pageIndex=q,this.div=it,rt(this,g,ot),rt(this,L,W),this.viewport=ct,t(this,T).addLayer(this)}get isEmpty(){return t(this,y).size===0}updateToolbar(S){t(this,T).updateToolbar(S)}updateMode(S=t(this,T).getMode()){X(this,R,sn).call(this),S===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),S!==a.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",S===a.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",S===a.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",S===a.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(S){if(!S&&t(this,T).getMode()!==a.AnnotationEditorType.INK)return;if(!S){for(const it of t(this,y).values())if(it.isEmpty()){it.setInBackground();return}}X(this,h,Re).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(S){t(this,T).setEditingState(S)}addCommands(S){t(this,T).addCommands(S)}enable(){this.div.style.pointerEvents="auto";const S=new Set;for(const it of t(this,y).values())it.enableEditing(),it.annotationElementId&&S.add(it.annotationElementId);if(!t(this,L))return;const q=t(this,L).getEditableAnnotations();for(const it of q){if(it.hide(),t(this,T).isDeletedAnnotationElement(it.data.id)||S.has(it.data.id))continue;const ot=this.deserialize(it);ot&&(this.addOrRebuild(ot),ot.enableEditing())}}disable(){var q;rt(this,P,!0),this.div.style.pointerEvents="none";const S=new Set;for(const it of t(this,y).values()){if(it.disableEditing(),!it.annotationElementId||it.serialize()!==null){S.add(it.annotationElementId);continue}(q=this.getEditableAnnotation(it.annotationElementId))==null||q.show(),it.remove()}if(t(this,L)){const it=t(this,L).getEditableAnnotations();for(const ot of it){const{id:W}=ot.data;S.has(W)||t(this,T).isDeletedAnnotationElement(W)||ot.show()}}X(this,R,sn).call(this),this.isEmpty&&(this.div.hidden=!0),rt(this,P,!1)}getEditableAnnotation(S){var q;return((q=t(this,L))==null?void 0:q.getEditableAnnotation(S))||null}setActiveEditor(S){t(this,T).getActive()!==S&&t(this,T).setActiveEditor(S)}enableClick(){this.div.addEventListener("pointerdown",t(this,v)),this.div.addEventListener("pointerup",t(this,C))}disableClick(){this.div.removeEventListener("pointerdown",t(this,v)),this.div.removeEventListener("pointerup",t(this,C))}attach(S){t(this,y).set(S.id,S);const{annotationElementId:q}=S;q&&t(this,T).isDeletedAnnotationElement(q)&&t(this,T).removeDeletedAnnotationElement(S)}detach(S){var q;t(this,y).delete(S.id),(q=t(this,g))==null||q.removePointerInTextLayer(S.contentDiv),!t(this,P)&&S.annotationElementId&&t(this,T).addDeletedAnnotationElement(S)}remove(S){this.detach(S),t(this,T).removeEditor(S),S.div.contains(document.activeElement)&&setTimeout(()=>{t(this,T).focusMainContainer()},0),S.div.remove(),S.isAttachedToDOM=!1,t(this,_)||this.addInkEditorIfNeeded(!1)}changeParent(S){var q;S.parent!==this&&(S.annotationElementId&&(t(this,T).addDeletedAnnotationElement(S.annotationElementId),p.AnnotationEditor.deleteAnnotationElement(S),S.annotationElementId=null),this.attach(S),(q=S.parent)==null||q.detach(S),S.setParent(this),S.div&&S.isAttachedToDOM&&(S.div.remove(),this.div.append(S.div)))}add(S){if(this.changeParent(S),t(this,T).addEditor(S),this.attach(S),!S.isAttachedToDOM){const q=S.render();this.div.append(q),S.isAttachedToDOM=!0}S.fixAndSetPosition(),S.onceAdded(),t(this,T).addToAnnotationStorage(S)}moveEditorInDOM(S){var it;if(!S.isAttachedToDOM)return;const{activeElement:q}=document;S.div.contains(q)&&(S._focusEventsAllowed=!1,setTimeout(()=>{S.div.contains(document.activeElement)?S._focusEventsAllowed=!0:(S.div.addEventListener("focusin",()=>{S._focusEventsAllowed=!0},{once:!0}),q.focus())},0)),S._structTreeParentId=(it=t(this,g))==null?void 0:it.moveElementInDOM(this.div,S.div,S.contentDiv,!0)}addOrRebuild(S){S.needsToBeRebuilt()?S.rebuild():this.add(S)}addUndoableEditor(S){const q=()=>S._uiManager.rebuild(S),it=()=>{S.remove()};this.addCommands({cmd:q,undo:it,mustExec:!1})}getNextId(){return t(this,T).getId()}pasteEditor(S,q){t(this,T).updateToolbar(S),t(this,T).updateMode(S);const{offsetX:it,offsetY:ot}=X(this,m,nn).call(this),W=this.getNextId(),ct=X(this,A,en).call(this,{parent:this,id:W,x:it,y:ot,uiManager:t(this,T),isCentered:!0,...q});ct&&this.add(ct)}deserialize(S){switch(S.annotationType??S.annotationEditorType){case a.AnnotationEditorType.FREETEXT:return V.FreeTextEditor.deserialize(S,this,t(this,T));case a.AnnotationEditorType.INK:return j.InkEditor.deserialize(S,this,t(this,T));case a.AnnotationEditorType.STAMP:return F.StampEditor.deserialize(S,this,t(this,T))}return null}addNewEditor(){X(this,h,Re).call(this,X(this,m,nn).call(this),!0)}setSelected(S){t(this,T).setSelected(S)}toggleSelected(S){t(this,T).toggleSelected(S)}isSelected(S){return t(this,T).isSelected(S)}unselect(S){t(this,T).unselect(S)}pointerup(S){const{isMac:q}=a.FeatureTest.platform;if(!(S.button!==0||S.ctrlKey&&q)&&S.target===this.div&&t(this,u)){if(rt(this,u,!1),!t(this,D)){rt(this,D,!0);return}if(t(this,T).getMode()===a.AnnotationEditorType.STAMP){t(this,T).unselectAll();return}X(this,h,Re).call(this,S,!1)}}pointerdown(S){if(t(this,u)){rt(this,u,!1);return}const{isMac:q}=a.FeatureTest.platform;if(S.button!==0||S.ctrlKey&&q||S.target!==this.div)return;rt(this,u,!0);const it=t(this,T).getActive();rt(this,D,!it||it.isEmpty())}findNewParent(S,q,it){const ot=t(this,T).findParent(q,it);return ot===null||ot===this?!1:(ot.changeParent(S),!0)}destroy(){var S,q;((S=t(this,T).getActive())==null?void 0:S.parent)===this&&(t(this,T).commitOrRemove(),t(this,T).setActiveEditor(null));for(const it of t(this,y).values())(q=t(this,g))==null||q.removePointerInTextLayer(it.contentDiv),it.setParent(null),it.isAttachedToDOM=!1,it.div.remove();this.div=null,t(this,y).clear(),t(this,T).removeLayer(this)}render({viewport:S}){this.viewport=S,(0,dt.setLayerDimensions)(this.div,S);for(const q of t(this,T).getEditors(this.pageIndex))this.add(q);this.updateMode()}update({viewport:S}){t(this,T).commitOrRemove(),this.viewport=S,(0,dt.setLayerDimensions)(this.div,{rotation:S.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:S,pageHeight:q}=this.viewport.rawDims;return[S,q]}};g=new WeakMap,D=new WeakMap,L=new WeakMap,C=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,P=new WeakMap,T=new WeakMap,A=new WeakSet,en=function(S){switch(t(this,T).getMode()){case a.AnnotationEditorType.FREETEXT:return new V.FreeTextEditor(S);case a.AnnotationEditorType.INK:return new j.InkEditor(S);case a.AnnotationEditorType.STAMP:return new F.StampEditor(S)}return null},h=new WeakSet,Re=function(S,q){const it=this.getNextId(),ot=X(this,A,en).call(this,{parent:this,id:it,x:S.offsetX,y:S.offsetY,uiManager:t(this,T),isCentered:q});return ot&&this.add(ot),ot},m=new WeakSet,nn=function(){const{x:S,y:q,width:it,height:ot}=this.div.getBoundingClientRect(),W=Math.max(0,S),ct=Math.max(0,q),gt=Math.min(window.innerWidth,S+it),vt=Math.min(window.innerHeight,q+ot),Tt=(W+gt)/2-S,w=(ct+vt)/2-q,[n,i]=this.viewport.rotation%180===0?[Tt,w]:[w,Tt];return{offsetX:n,offsetY:i}},R=new WeakSet,sn=function(){rt(this,_,!0);for(const S of t(this,y).values())S.isEmpty()&&S.remove();rt(this,_,!1)},ee($,"_initialized",!1);let x=$;r.AnnotationEditorLayer=x},(H,r,U)=>{var F,x,g,D,L,C,v,y,u,_,Fn,T,Mn,o,Dn,k,Ae,l,rn,f,Ln,G,an;Object.defineProperty(r,"__esModule",{value:!0}),r.FreeTextEditor=void 0;var a=U(1),p=U(5),V=U(4),j=U(29);const q=class q extends V.AnnotationEditor{constructor(W){super({...W,name:"freeTextEditor"});B(this,_);B(this,T);B(this,o);B(this,k);B(this,l);B(this,f);B(this,G);B(this,F,this.editorDivBlur.bind(this));B(this,x,this.editorDivFocus.bind(this));B(this,g,this.editorDivInput.bind(this));B(this,D,this.editorDivKeydown.bind(this));B(this,L,void 0);B(this,C,"");B(this,v,`${this.id}-editor`);B(this,y,void 0);B(this,u,null);rt(this,L,W.color||q._defaultColor||V.AnnotationEditor._defaultLineColor),rt(this,y,W.fontSize||q._defaultFontSize)}static get _keyboardManager(){const W=q.prototype,ct=Tt=>Tt.isEmpty(),gt=p.AnnotationEditorUIManager.TRANSLATE_SMALL,vt=p.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,a.shadow)(this,"_keyboardManager",new p.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],W.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],W.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],W._translateEmpty,{args:[-gt,0],checker:ct}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],W._translateEmpty,{args:[-vt,0],checker:ct}],[["ArrowRight","mac+ArrowRight"],W._translateEmpty,{args:[gt,0],checker:ct}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],W._translateEmpty,{args:[vt,0],checker:ct}],[["ArrowUp","mac+ArrowUp"],W._translateEmpty,{args:[0,-gt],checker:ct}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],W._translateEmpty,{args:[0,-vt],checker:ct}],[["ArrowDown","mac+ArrowDown"],W._translateEmpty,{args:[0,gt],checker:ct}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],W._translateEmpty,{args:[0,vt],checker:ct}]]))}static initialize(W){V.AnnotationEditor.initialize(W,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const ct=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(ct.getPropertyValue("--freetext-padding"))}static updateDefaultParams(W,ct){switch(W){case a.AnnotationEditorParamsType.FREETEXT_SIZE:q._defaultFontSize=ct;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:q._defaultColor=ct;break}}updateParams(W,ct){switch(W){case a.AnnotationEditorParamsType.FREETEXT_SIZE:X(this,_,Fn).call(this,ct);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:X(this,T,Mn).call(this,ct);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,q._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,q._defaultColor||V.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,y)],[a.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,L)]]}_translateEmpty(W,ct){this._uiManager.translateSelectedEditors(W,ct,!0)}getInitialTranslation(){const W=this.parentScale;return[-q._internalPadding*W,-(q._internalPadding+t(this,y))*W]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,D)),this.editorDiv.addEventListener("focus",t(this,x)),this.editorDiv.addEventListener("blur",t(this,F)),this.editorDiv.addEventListener("input",t(this,g)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,v)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,D)),this.editorDiv.removeEventListener("focus",t(this,x)),this.editorDiv.removeEventListener("blur",t(this,F)),this.editorDiv.removeEventListener("input",t(this,g)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(W){this._focusEventsAllowed&&(super.focusin(W),W.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var W;if(this.width){X(this,G,an).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(W=this._initialOptions)!=null&&W.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const W=t(this,C),ct=rt(this,C,X(this,o,Dn).call(this).trimEnd());if(W===ct)return;const gt=vt=>{if(rt(this,C,vt),!vt){this.remove();return}X(this,l,rn).call(this),this._uiManager.rebuild(this),X(this,k,Ae).call(this)};this.addCommands({cmd:()=>{gt(ct)},undo:()=>{gt(W)},mustExec:!1}),X(this,k,Ae).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(W){this.enterInEditMode()}keydown(W){W.target===this.div&&W.key==="Enter"&&(this.enterInEditMode(),W.preventDefault())}editorDivKeydown(W){q._keyboardManager.exec(this,W)}editorDivFocus(W){this.isEditing=!0}editorDivBlur(W){this.isEditing=!1}editorDivInput(W){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let W,ct;this.width&&(W=this.x,ct=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,v)),this.enableEditing(),V.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(vt=>{var Tt;return(Tt=this.editorDiv)==null?void 0:Tt.setAttribute("aria-label",vt)}),V.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(vt=>{var Tt;return(Tt=this.editorDiv)==null?void 0:Tt.setAttribute("default-content",vt)}),this.editorDiv.contentEditable=!0;const{style:gt}=this.editorDiv;if(gt.fontSize=`calc(${t(this,y)}px * var(--scale-factor))`,gt.color=t(this,L),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,p.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[vt,Tt]=this.parentDimensions;if(this.annotationElementId){const{position:w}=t(this,u);let[n,i]=this.getInitialTranslation();[n,i]=this.pageTranslationToScreen(n,i);const[s,c]=this.pageDimensions,[d,E]=this.pageTranslation;let M,N;switch(this.rotation){case 0:M=W+(w[0]-d)/s,N=ct+this.height-(w[1]-E)/c;break;case 90:M=W+(w[0]-d)/s,N=ct-(w[1]-E)/c,[n,i]=[i,-n];break;case 180:M=W-this.width+(w[0]-d)/s,N=ct-(w[1]-E)/c,[n,i]=[-n,-i];break;case 270:M=W+(w[0]-d-this.height*c)/s,N=ct+(w[1]-E-this.width*s)/c,[n,i]=[-i,n];break}this.setAt(M*vt,N*Tt,n,i)}else this.setAt(W*vt,ct*Tt,this.width*vt,this.height*Tt);X(this,l,rn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(W,ct,gt){let vt=null;if(W instanceof j.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:w,fontColor:n},rect:i,rotation:s,id:c},textContent:d,textPosition:E,parent:{page:{pageNumber:M}}}=W;if(!d||d.length===0)return null;vt=W={annotationType:a.AnnotationEditorType.FREETEXT,color:Array.from(n),fontSize:w,value:d.join(`
`),position:E,pageIndex:M-1,rect:i,rotation:s,id:c,deleted:!1}}const Tt=super.deserialize(W,ct,gt);return rt(Tt,y,W.fontSize),rt(Tt,L,a.Util.makeHexColor(...W.color)),rt(Tt,C,W.value),Tt.annotationElementId=W.id||null,rt(Tt,u,vt),Tt}serialize(W=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const ct=q._internalPadding*this.parentScale,gt=this.getRect(ct,ct),vt=V.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,L)),Tt={annotationType:a.AnnotationEditorType.FREETEXT,color:vt,fontSize:t(this,y),value:t(this,C),pageIndex:this.pageIndex,rect:gt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return W?Tt:this.annotationElementId&&!X(this,f,Ln).call(this,Tt)?null:(Tt.id=this.annotationElementId,Tt)}};F=new WeakMap,x=new WeakMap,g=new WeakMap,D=new WeakMap,L=new WeakMap,C=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakSet,Fn=function(W){const ct=vt=>{this.editorDiv.style.fontSize=`calc(${vt}px * var(--scale-factor))`,this.translate(0,-(vt-t(this,y))*this.parentScale),rt(this,y,vt),X(this,k,Ae).call(this)},gt=t(this,y);this.addCommands({cmd:()=>{ct(W)},undo:()=>{ct(gt)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},T=new WeakSet,Mn=function(W){const ct=t(this,L);this.addCommands({cmd:()=>{rt(this,L,this.editorDiv.style.color=W)},undo:()=>{rt(this,L,this.editorDiv.style.color=ct)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,Dn=function(){const W=this.editorDiv.getElementsByTagName("div");if(W.length===0)return this.editorDiv.innerText;const ct=[];for(const gt of W)ct.push(gt.innerText.replace(/\r\n?|\n/,""));return ct.join(`
`)},k=new WeakSet,Ae=function(){const[W,ct]=this.parentDimensions;let gt;if(this.isAttachedToDOM)gt=this.div.getBoundingClientRect();else{const{currentLayer:vt,div:Tt}=this,w=Tt.style.display;Tt.style.display="hidden",vt.div.append(this.div),gt=Tt.getBoundingClientRect(),Tt.remove(),Tt.style.display=w}this.rotation%180===this.parentRotation%180?(this.width=gt.width/W,this.height=gt.height/ct):(this.width=gt.height/W,this.height=gt.width/ct),this.fixAndSetPosition()},l=new WeakSet,rn=function(){if(this.editorDiv.replaceChildren(),!!t(this,C))for(const W of t(this,C).split(`
`)){const ct=document.createElement("div");ct.append(W?document.createTextNode(W):document.createElement("br")),this.editorDiv.append(ct)}},f=new WeakSet,Ln=function(W){const{value:ct,fontSize:gt,color:vt,rect:Tt,pageIndex:w}=t(this,u);return W.value!==ct||W.fontSize!==gt||W.rect.some((n,i)=>Math.abs(n-Tt[i])>=1)||W.color.some((n,i)=>n!==vt[i])||W.pageIndex!==w},G=new WeakSet,an=function(W=!1){if(!this.annotationElementId)return;if(X(this,k,Ae).call(this),!W&&(this.width===0||this.height===0)){setTimeout(()=>X(this,G,an).call(this,!0),0);return}const ct=q._internalPadding*this.parentScale;t(this,u).rect=this.getRect(ct,ct)},ee(q,"_freeTextDefaultContent",""),ee(q,"_internalPadding",0),ee(q,"_defaultColor",null),ee(q,"_defaultFontSize",10),ee(q,"_type","freetext");let dt=q;r.FreeTextEditor=dt},(H,r,U)=>{var i,c,ce,E,In,N,st,Z,tt,lt,mt,ht,kt,Bt,Et,Dt,pt,et,nt,ft,Pt,wt,Ut,On,jt,ke,Wt,on,zt,ln,Q,Y,_t,At,te,Zt,J,cn,It,Ct,Ot,Nt,Nn,yt,hn;Object.defineProperty(r,"__esModule",{value:!0}),r.StampAnnotationElement=r.InkAnnotationElement=r.FreeTextAnnotationElement=r.AnnotationLayer=void 0;var a=U(1),p=U(6),V=U(3),j=U(30),dt=U(31),F=U(32);const x=1e3,g=9,D=new WeakSet;function L(Lt){return{width:Lt[2]-Lt[0],height:Lt[3]-Lt[1]}}class C{static create(I){switch(I.data.annotationType){case a.AnnotationType.LINK:return new y(I);case a.AnnotationType.TEXT:return new u(I);case a.AnnotationType.WIDGET:switch(I.data.fieldType){case"Tx":return new P(I);case"Btn":return I.data.radioButton?new o(I):I.data.checkBox?new A(I):new h(I);case"Ch":return new k(I);case"Sig":return new T(I)}return new _(I);case a.AnnotationType.POPUP:return new m(I);case a.AnnotationType.FREETEXT:return new R(I);case a.AnnotationType.LINE:return new f(I);case a.AnnotationType.SQUARE:return new $(I);case a.AnnotationType.CIRCLE:return new G(I);case a.AnnotationType.POLYLINE:return new S(I);case a.AnnotationType.CARET:return new it(I);case a.AnnotationType.INK:return new ot(I);case a.AnnotationType.POLYGON:return new q(I);case a.AnnotationType.HIGHLIGHT:return new W(I);case a.AnnotationType.UNDERLINE:return new ct(I);case a.AnnotationType.SQUIGGLY:return new gt(I);case a.AnnotationType.STRIKEOUT:return new vt(I);case a.AnnotationType.STAMP:return new Tt(I);case a.AnnotationType.FILEATTACHMENT:return new w(I);default:return new v(I)}}}const s=class s{constructor(I,{isRenderable:e=!1,ignoreBorder:b=!1,createQuadrilaterals:O=!1}={}){B(this,i,!1);this.isRenderable=e,this.data=I.data,this.layer=I.layer,this.linkService=I.linkService,this.downloadManager=I.downloadManager,this.imageResourcesPath=I.imageResourcesPath,this.renderForms=I.renderForms,this.svgFactory=I.svgFactory,this.annotationStorage=I.annotationStorage,this.enableScripting=I.enableScripting,this.hasJSActions=I.hasJSActions,this._fieldObjects=I.fieldObjects,this.parent=I.parent,e&&(this.container=this._createContainer(b)),O&&this._createQuadrilaterals()}static _hasPopupData({titleObj:I,contentsObj:e,richText:b}){return!!(I!=null&&I.str||e!=null&&e.str||b!=null&&b.str)}get hasPopupData(){return s._hasPopupData(this.data)}_createContainer(I){const{data:e,parent:{page:b,viewport:O}}=this,z=document.createElement("section");z.setAttribute("data-annotation-id",e.id),this instanceof _||(z.tabIndex=x),z.style.zIndex=this.parent.zIndex++,this.data.popupRef&&z.setAttribute("aria-haspopup","dialog"),e.noRotate&&z.classList.add("norotate");const{pageWidth:K,pageHeight:at,pageX:bt,pageY:Rt}=O.rawDims;if(!e.rect||this instanceof m){const{rotation:Ht}=e;return!e.hasOwnCanvas&&Ht!==0&&this.setRotation(Ht,z),z}const{width:xt,height:Xt}=L(e.rect),Ft=a.Util.normalizeRect([e.rect[0],b.view[3]-e.rect[1]+b.view[1],e.rect[2],b.view[3]-e.rect[3]+b.view[1]]);if(!I&&e.borderStyle.width>0){z.style.borderWidth=`${e.borderStyle.width}px`;const Ht=e.borderStyle.horizontalCornerRadius,qt=e.borderStyle.verticalCornerRadius;if(Ht>0||qt>0){const Qt=`calc(${Ht}px * var(--scale-factor)) / calc(${qt}px * var(--scale-factor))`;z.style.borderRadius=Qt}else if(this instanceof o){const Qt=`calc(${xt}px * var(--scale-factor)) / calc(${Xt}px * var(--scale-factor))`;z.style.borderRadius=Qt}switch(e.borderStyle.style){case a.AnnotationBorderStyleType.SOLID:z.style.borderStyle="solid";break;case a.AnnotationBorderStyleType.DASHED:z.style.borderStyle="dashed";break;case a.AnnotationBorderStyleType.BEVELED:(0,a.warn)("Unimplemented border style: beveled");break;case a.AnnotationBorderStyleType.INSET:(0,a.warn)("Unimplemented border style: inset");break;case a.AnnotationBorderStyleType.UNDERLINE:z.style.borderBottomStyle="solid";break}const Kt=e.borderColor||null;Kt?(rt(this,i,!0),z.style.borderColor=a.Util.makeHexColor(Kt[0]|0,Kt[1]|0,Kt[2]|0)):z.style.borderWidth=0}z.style.left=`${100*(Ft[0]-bt)/K}%`,z.style.top=`${100*(Ft[1]-Rt)/at}%`;const{rotation:Mt}=e;return e.hasOwnCanvas||Mt===0?(z.style.width=`${100*xt/K}%`,z.style.height=`${100*Xt/at}%`):this.setRotation(Mt,z),z}setRotation(I,e=this.container){if(!this.data.rect)return;const{pageWidth:b,pageHeight:O}=this.parent.viewport.rawDims,{width:z,height:K}=L(this.data.rect);let at,bt;I%180===0?(at=100*z/b,bt=100*K/O):(at=100*K/b,bt=100*z/O),e.style.width=`${at}%`,e.style.height=`${bt}%`,e.setAttribute("data-main-rotation",(360-I)%360)}get _commonActions(){const I=(e,b,O)=>{const z=O.detail[e],K=z[0],at=z.slice(1);O.target.style[b]=j.ColorConverters[`${K}_HTML`](at),this.annotationStorage.setValue(this.data.id,{[b]:j.ColorConverters[`${K}_rgb`](at)})};return(0,a.shadow)(this,"_commonActions",{display:e=>{const{display:b}=e.detail,O=b%2===1;this.container.style.visibility=O?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:O,noPrint:b===1||b===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:b}=e.detail;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:b,noView:b})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{I("bgColor","backgroundColor",e)},fillColor:e=>{I("fillColor","backgroundColor",e)},fgColor:e=>{I("fgColor","color",e)},textColor:e=>{I("textColor","color",e)},borderColor:e=>{I("borderColor","borderColor",e)},strokeColor:e=>{I("strokeColor","borderColor",e)},rotation:e=>{const b=e.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(I,e){const b=this._commonActions;for(const O of Object.keys(e.detail)){const z=I[O]||b[O];z==null||z(e)}}_setDefaultPropertiesFromJS(I){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const b=this._commonActions;for(const[O,z]of Object.entries(e)){const K=b[O];if(K){const at={detail:{[O]:z},target:I};K(at),delete e[O]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:I}=this.data;if(!I)return;const[e,b,O,z]=this.data.rect;if(I.length===1){const[,{x:qt,y:Kt},{x:Qt,y:se}]=I[0];if(O===qt&&z===Kt&&e===Qt&&b===se)return}const{style:K}=this.container;let at;if(t(this,i)){const{borderColor:qt,borderWidth:Kt}=K;K.borderWidth=0,at=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${qt}" stroke-width="${Kt}">`],this.container.classList.add("hasBorder")}const bt=O-e,Rt=z-b,{svgFactory:xt}=this,Xt=xt.createElement("svg");Xt.classList.add("quadrilateralsContainer"),Xt.setAttribute("width",0),Xt.setAttribute("height",0);const Ft=xt.createElement("defs");Xt.append(Ft);const Mt=xt.createElement("clipPath"),Ht=`clippath_${this.data.id}`;Mt.setAttribute("id",Ht),Mt.setAttribute("clipPathUnits","objectBoundingBox"),Ft.append(Mt);for(const[,{x:qt,y:Kt},{x:Qt,y:se}]of I){const ne=xt.createElement("rect"),ie=(Qt-e)/bt,oe=(z-Kt)/Rt,le=(qt-Qt)/bt,yn=(Kt-se)/Rt;ne.setAttribute("x",ie),ne.setAttribute("y",oe),ne.setAttribute("width",le),ne.setAttribute("height",yn),Mt.append(ne),at==null||at.push(`<rect vector-effect="non-scaling-stroke" x="${ie}" y="${oe}" width="${le}" height="${yn}"/>`)}t(this,i)&&(at.push("</g></svg>')"),K.backgroundImage=at.join("")),this.container.append(Xt),this.container.style.clipPath=`url(#${Ht})`}_createPopup(){const{container:I,data:e}=this;I.setAttribute("aria-haspopup","dialog");const b=new m({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(b.render())}render(){(0,a.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(I,e=null){const b=[];if(this._fieldObjects){const O=this._fieldObjects[I];if(O)for(const{page:z,id:K,exportValues:at}of O){if(z===-1||K===e)continue;const bt=typeof at=="string"?at:null,Rt=document.querySelector(`[data-element-id="${K}"]`);if(Rt&&!D.has(Rt)){(0,a.warn)(`_getElementsByName - element not allowed: ${K}`);continue}b.push({id:K,exportValue:bt,domElement:Rt})}return b}for(const O of document.getElementsByName(I)){const{exportValue:z}=O,K=O.getAttribute("data-element-id");K!==e&&D.has(O)&&b.push({id:K,exportValue:z,domElement:O})}return b}show(){var I;this.container&&(this.container.hidden=!1),(I=this.popup)==null||I.maybeShow()}hide(){var I;this.container&&(this.container.hidden=!0),(I=this.popup)==null||I.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const I=this.getElementsToTriggerPopup();if(Array.isArray(I))for(const e of I)e.classList.add("highlightArea");else I.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:I,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var b;(b=this.linkService.eventBus)==null||b.dispatch("switchannotationeditormode",{source:this,mode:I,editId:e})})}};i=new WeakMap;let v=s;class y extends v{constructor(e,b=null){super(e,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});B(this,c);B(this,E);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:b}=this,O=document.createElement("a");O.setAttribute("data-element-id",e.id);let z=!1;return e.url?(b.addLinkAttributes(O,e.url,e.newWindow),z=!0):e.action?(this._bindNamedAction(O,e.action),z=!0):e.attachment?(this._bindAttachment(O,e.attachment),z=!0):e.setOCGState?(X(this,E,In).call(this,O,e.setOCGState),z=!0):e.dest?(this._bindLink(O,e.dest),z=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(O,e),z=!0),e.resetForm?(this._bindResetFormAction(O,e.resetForm),z=!0):this.isTooltipOnly&&!z&&(this._bindLink(O,""),z=!0)),this.container.classList.add("linkAnnotation"),z&&this.container.append(O),this.container}_bindLink(e,b){e.href=this.linkService.getDestinationHash(b),e.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&X(this,c,ce).call(this)}_bindNamedAction(e,b){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(b),!1),X(this,c,ce).call(this)}_bindAttachment(e,b){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>{var O;return(O=this.downloadManager)==null||O.openOrDownloadData(this.container,b.content,b.filename),!1},X(this,c,ce).call(this)}_bindJSAction(e,b){e.href=this.linkService.getAnchorUrl("");const O=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const z of Object.keys(b.actions)){const K=O.get(z);K&&(e[K]=()=>{var at;return(at=this.linkService.eventBus)==null||at.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:z}}),!1})}e.onclick||(e.onclick=()=>!1),X(this,c,ce).call(this)}_bindResetFormAction(e,b){const O=e.onclick;if(O||(e.href=this.linkService.getAnchorUrl("")),X(this,c,ce).call(this),!this._fieldObjects){(0,a.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),O||(e.onclick=()=>!1);return}e.onclick=()=>{var Xt;O==null||O();const{fields:z,refs:K,include:at}=b,bt=[];if(z.length!==0||K.length!==0){const Ft=new Set(K);for(const Mt of z){const Ht=this._fieldObjects[Mt]||[];for(const{id:qt}of Ht)Ft.add(qt)}for(const Mt of Object.values(this._fieldObjects))for(const Ht of Mt)Ft.has(Ht.id)===at&&bt.push(Ht)}else for(const Ft of Object.values(this._fieldObjects))bt.push(...Ft);const Rt=this.annotationStorage,xt=[];for(const Ft of bt){const{id:Mt}=Ft;switch(xt.push(Mt),Ft.type){case"text":{const qt=Ft.defaultValue||"";Rt.setValue(Mt,{value:qt});break}case"checkbox":case"radiobutton":{const qt=Ft.defaultValue===Ft.exportValues;Rt.setValue(Mt,{value:qt});break}case"combobox":case"listbox":{const qt=Ft.defaultValue||"";Rt.setValue(Mt,{value:qt});break}default:continue}const Ht=document.querySelector(`[data-element-id="${Mt}"]`);if(Ht){if(!D.has(Ht)){(0,a.warn)(`_bindResetFormAction - element not allowed: ${Mt}`);continue}}else continue;Ht.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Xt=this.linkService.eventBus)==null||Xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:xt,name:"ResetForm"}})),!1}}}c=new WeakSet,ce=function(){this.container.setAttribute("data-internal-link","")},E=new WeakSet,In=function(e,b){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(b),!1),X(this,c,ce).call(this)};class u extends v{constructor(I){super(I,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const I=document.createElement("img");return I.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",I.alt="[{{type}} Annotation]",I.dataset.l10nId="text_annotation_type",I.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(I),this.container}}class _ extends v{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(I){var e;this.data.hasOwnCanvas&&(((e=I.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(I.previousSibling.hidden=!0),I.hidden=!1)}_getKeyModifier(I){const{isWin:e,isMac:b}=a.FeatureTest.platform;return e&&I.ctrlKey||b&&I.metaKey}_setEventListener(I,e,b,O,z){b.includes("mouse")?I.addEventListener(b,K=>{var at;(at=this.linkService.eventBus)==null||at.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:O,value:z(K),shift:K.shiftKey,modifier:this._getKeyModifier(K)}})}):I.addEventListener(b,K=>{var at;if(b==="blur"){if(!e.focused||!K.relatedTarget)return;e.focused=!1}else if(b==="focus"){if(e.focused)return;e.focused=!0}z&&((at=this.linkService.eventBus)==null||at.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:O,value:z(K)}}))})}_setEventListeners(I,e,b,O){var z,K,at;for(const[bt,Rt]of b)(Rt==="Action"||(z=this.data.actions)!=null&&z[Rt])&&((Rt==="Focus"||Rt==="Blur")&&(e||(e={focused:!1})),this._setEventListener(I,e,bt,Rt,O),Rt==="Focus"&&!((K=this.data.actions)!=null&&K.Blur)?this._setEventListener(I,e,"blur","Blur",null):Rt==="Blur"&&!((at=this.data.actions)!=null&&at.Focus)&&this._setEventListener(I,e,"focus","Focus",null))}_setBackgroundColor(I){const e=this.data.backgroundColor||null;I.style.backgroundColor=e===null?"transparent":a.Util.makeHexColor(e[0],e[1],e[2])}_setTextStyle(I){const e=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,O=this.data.defaultAppearanceData.fontSize||g,z=I.style;let K;const at=2,bt=Rt=>Math.round(10*Rt)/10;if(this.data.multiLine){const Rt=Math.abs(this.data.rect[3]-this.data.rect[1]-at),xt=Math.round(Rt/(a.LINE_FACTOR*O))||1,Xt=Rt/xt;K=Math.min(O,bt(Xt/a.LINE_FACTOR))}else{const Rt=Math.abs(this.data.rect[3]-this.data.rect[1]-at);K=Math.min(O,bt(Rt/a.LINE_FACTOR))}z.fontSize=`calc(${K}px * var(--scale-factor))`,z.color=a.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(z.textAlign=e[this.data.textAlignment])}_setRequired(I,e){e?I.setAttribute("required",!0):I.removeAttribute("required"),I.setAttribute("aria-required",e)}}class P extends _{constructor(I){const e=I.renderForms||!I.data.hasAppearance&&!!I.data.fieldValue;super(I,{isRenderable:e})}setPropertyOnSiblings(I,e,b,O){const z=this.annotationStorage;for(const K of this._getElementsByName(I.name,I.id))K.domElement&&(K.domElement[e]=b),z.setValue(K.id,{[O]:b})}render(){var O,z;const I=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const K=I.getValue(e,{value:this.data.fieldValue});let at=K.value||"";const bt=I.getValue(e,{charLimit:this.data.maxLen}).charLimit;bt&&at.length>bt&&(at=at.slice(0,bt));let Rt=K.formattedValue||((O=this.data.textContent)==null?void 0:O.join(`
`))||null;Rt&&this.data.comb&&(Rt=Rt.replaceAll(/\s+/g,""));const xt={userValue:at,formattedValue:Rt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=Rt??at,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",Rt??at),this.data.doNotScroll&&(b.style.overflowX="hidden")),this.data.hasOwnCanvas&&(b.hidden=!0),D.add(b),b.setAttribute("data-element-id",e),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=x,this._setRequired(b,this.data.required),bt&&(b.maxLength=bt),b.addEventListener("input",Ft=>{I.setValue(e,{value:Ft.target.value}),this.setPropertyOnSiblings(b,"value",Ft.target.value,"value"),xt.formattedValue=null}),b.addEventListener("resetform",Ft=>{const Mt=this.data.defaultFieldValue??"";b.value=xt.userValue=Mt,xt.formattedValue=null});let Xt=Ft=>{const{formattedValue:Mt}=xt;Mt!=null&&(Ft.target.value=Mt),Ft.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",Mt=>{if(xt.focused)return;const{target:Ht}=Mt;xt.userValue&&(Ht.value=xt.userValue),xt.lastCommittedValue=Ht.value,xt.commitKey=1,xt.focused=!0}),b.addEventListener("updatefromsandbox",Mt=>{this.showElementAndHideCanvas(Mt.target);const Ht={value(qt){xt.userValue=qt.detail.value??"",I.setValue(e,{value:xt.userValue.toString()}),qt.target.value=xt.userValue},formattedValue(qt){const{formattedValue:Kt}=qt.detail;xt.formattedValue=Kt,Kt!=null&&qt.target!==document.activeElement&&(qt.target.value=Kt),I.setValue(e,{formattedValue:Kt})},selRange(qt){qt.target.setSelectionRange(...qt.detail.selRange)},charLimit:qt=>{var ne;const{charLimit:Kt}=qt.detail,{target:Qt}=qt;if(Kt===0){Qt.removeAttribute("maxLength");return}Qt.setAttribute("maxLength",Kt);let se=xt.userValue;!se||se.length<=Kt||(se=se.slice(0,Kt),Qt.value=xt.userValue=se,I.setValue(e,{value:se}),(ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:se,willCommit:!0,commitKey:1,selStart:Qt.selectionStart,selEnd:Qt.selectionEnd}}))}};this._dispatchEventFromSandbox(Ht,Mt)}),b.addEventListener("keydown",Mt=>{var Kt;xt.commitKey=1;let Ht=-1;if(Mt.key==="Escape"?Ht=0:Mt.key==="Enter"&&!this.data.multiLine?Ht=2:Mt.key==="Tab"&&(xt.commitKey=3),Ht===-1)return;const{value:qt}=Mt.target;xt.lastCommittedValue!==qt&&(xt.lastCommittedValue=qt,xt.userValue=qt,(Kt=this.linkService.eventBus)==null||Kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:qt,willCommit:!0,commitKey:Ht,selStart:Mt.target.selectionStart,selEnd:Mt.target.selectionEnd}}))});const Ft=Xt;Xt=null,b.addEventListener("blur",Mt=>{var qt;if(!xt.focused||!Mt.relatedTarget)return;xt.focused=!1;const{value:Ht}=Mt.target;xt.userValue=Ht,xt.lastCommittedValue!==Ht&&((qt=this.linkService.eventBus)==null||qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Ht,willCommit:!0,commitKey:xt.commitKey,selStart:Mt.target.selectionStart,selEnd:Mt.target.selectionEnd}})),Ft(Mt)}),(z=this.data.actions)!=null&&z.Keystroke&&b.addEventListener("beforeinput",Mt=>{var oe;xt.lastCommittedValue=null;const{data:Ht,target:qt}=Mt,{value:Kt,selectionStart:Qt,selectionEnd:se}=qt;let ne=Qt,ie=se;switch(Mt.inputType){case"deleteWordBackward":{const le=Kt.substring(0,Qt).match(/\w*[^\w]*$/);le&&(ne-=le[0].length);break}case"deleteWordForward":{const le=Kt.substring(Qt).match(/^[^\w]*\w*/);le&&(ie+=le[0].length);break}case"deleteContentBackward":Qt===se&&(ne-=1);break;case"deleteContentForward":Qt===se&&(ie+=1);break}Mt.preventDefault(),(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:Kt,change:Ht||"",willCommit:!1,selStart:ne,selEnd:ie}})}),this._setEventListeners(b,xt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Mt=>Mt.target.value)}if(Xt&&b.addEventListener("blur",Xt),this.data.comb){const Mt=(this.data.rect[2]-this.data.rect[0])/bt;b.classList.add("comb"),b.style.letterSpacing=`calc(${Mt}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class T extends _{constructor(I){super(I,{isRenderable:!!I.data.hasOwnCanvas})}}class A extends _{constructor(I){super(I,{isRenderable:I.renderForms})}render(){const I=this.annotationStorage,e=this.data,b=e.id;let O=I.getValue(b,{value:e.exportValue===e.fieldValue}).value;typeof O=="string"&&(O=O!=="Off",I.setValue(b,{value:O})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const z=document.createElement("input");return D.add(z),z.setAttribute("data-element-id",b),z.disabled=e.readOnly,this._setRequired(z,this.data.required),z.type="checkbox",z.name=e.fieldName,O&&z.setAttribute("checked",!0),z.setAttribute("exportValue",e.exportValue),z.tabIndex=x,z.addEventListener("change",K=>{const{name:at,checked:bt}=K.target;for(const Rt of this._getElementsByName(at,b)){const xt=bt&&Rt.exportValue===e.exportValue;Rt.domElement&&(Rt.domElement.checked=xt),I.setValue(Rt.id,{value:xt})}I.setValue(b,{value:bt})}),z.addEventListener("resetform",K=>{const at=e.defaultFieldValue||"Off";K.target.checked=at===e.exportValue}),this.enableScripting&&this.hasJSActions&&(z.addEventListener("updatefromsandbox",K=>{const at={value(bt){bt.target.checked=bt.detail.value!=="Off",I.setValue(b,{value:bt.target.checked})}};this._dispatchEventFromSandbox(at,K)}),this._setEventListeners(z,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],K=>K.target.checked)),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class o extends _{constructor(I){super(I,{isRenderable:I.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const I=this.annotationStorage,e=this.data,b=e.id;let O=I.getValue(b,{value:e.fieldValue===e.buttonValue}).value;typeof O=="string"&&(O=O!==e.buttonValue,I.setValue(b,{value:O}));const z=document.createElement("input");if(D.add(z),z.setAttribute("data-element-id",b),z.disabled=e.readOnly,this._setRequired(z,this.data.required),z.type="radio",z.name=e.fieldName,O&&z.setAttribute("checked",!0),z.tabIndex=x,z.addEventListener("change",K=>{const{name:at,checked:bt}=K.target;for(const Rt of this._getElementsByName(at,b))I.setValue(Rt.id,{value:!1});I.setValue(b,{value:bt})}),z.addEventListener("resetform",K=>{const at=e.defaultFieldValue;K.target.checked=at!=null&&at===e.buttonValue}),this.enableScripting&&this.hasJSActions){const K=e.buttonValue;z.addEventListener("updatefromsandbox",at=>{const bt={value:Rt=>{const xt=K===Rt.detail.value;for(const Xt of this._getElementsByName(Rt.target.name)){const Ft=xt&&Xt.id===b;Xt.domElement&&(Xt.domElement.checked=Ft),I.setValue(Xt.id,{value:Ft})}}};this._dispatchEventFromSandbox(bt,at)}),this._setEventListeners(z,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],at=>at.target.checked)}return this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class h extends y{constructor(I){super(I,{ignoreBorder:I.data.hasAppearance})}render(){const I=super.render();I.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(I.title=this.data.alternativeText);const e=I.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),I}}class k extends _{constructor(I){super(I,{isRenderable:I.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const I=this.annotationStorage,e=this.data.id,b=I.getValue(e,{value:this.data.fieldValue}),O=document.createElement("select");D.add(O),O.setAttribute("data-element-id",e),O.disabled=this.data.readOnly,this._setRequired(O,this.data.required),O.name=this.data.fieldName,O.tabIndex=x;let z=this.data.combo&&this.data.options.length>0;this.data.combo||(O.size=this.data.options.length,this.data.multiSelect&&(O.multiple=!0)),O.addEventListener("resetform",xt=>{const Xt=this.data.defaultFieldValue;for(const Ft of O.options)Ft.selected=Ft.value===Xt});for(const xt of this.data.options){const Xt=document.createElement("option");Xt.textContent=xt.displayValue,Xt.value=xt.exportValue,b.value.includes(xt.exportValue)&&(Xt.setAttribute("selected",!0),z=!1),O.append(Xt)}let K=null;if(z){const xt=document.createElement("option");xt.value=" ",xt.setAttribute("hidden",!0),xt.setAttribute("selected",!0),O.prepend(xt),K=()=>{xt.remove(),O.removeEventListener("input",K),K=null},O.addEventListener("input",K)}const at=xt=>{const Xt=xt?"value":"textContent",{options:Ft,multiple:Mt}=O;return Mt?Array.prototype.filter.call(Ft,Ht=>Ht.selected).map(Ht=>Ht[Xt]):Ft.selectedIndex===-1?null:Ft[Ft.selectedIndex][Xt]};let bt=at(!1);const Rt=xt=>{const Xt=xt.target.options;return Array.prototype.map.call(Xt,Ft=>({displayValue:Ft.textContent,exportValue:Ft.value}))};return this.enableScripting&&this.hasJSActions?(O.addEventListener("updatefromsandbox",xt=>{const Xt={value(Ft){K==null||K();const Mt=Ft.detail.value,Ht=new Set(Array.isArray(Mt)?Mt:[Mt]);for(const qt of O.options)qt.selected=Ht.has(qt.value);I.setValue(e,{value:at(!0)}),bt=at(!1)},multipleSelection(Ft){O.multiple=!0},remove(Ft){const Mt=O.options,Ht=Ft.detail.remove;Mt[Ht].selected=!1,O.remove(Ht),Mt.length>0&&Array.prototype.findIndex.call(Mt,Kt=>Kt.selected)===-1&&(Mt[0].selected=!0),I.setValue(e,{value:at(!0),items:Rt(Ft)}),bt=at(!1)},clear(Ft){for(;O.length!==0;)O.remove(0);I.setValue(e,{value:null,items:[]}),bt=at(!1)},insert(Ft){const{index:Mt,displayValue:Ht,exportValue:qt}=Ft.detail.insert,Kt=O.children[Mt],Qt=document.createElement("option");Qt.textContent=Ht,Qt.value=qt,Kt?Kt.before(Qt):O.append(Qt),I.setValue(e,{value:at(!0),items:Rt(Ft)}),bt=at(!1)},items(Ft){const{items:Mt}=Ft.detail;for(;O.length!==0;)O.remove(0);for(const Ht of Mt){const{displayValue:qt,exportValue:Kt}=Ht,Qt=document.createElement("option");Qt.textContent=qt,Qt.value=Kt,O.append(Qt)}O.options.length>0&&(O.options[0].selected=!0),I.setValue(e,{value:at(!0),items:Rt(Ft)}),bt=at(!1)},indices(Ft){const Mt=new Set(Ft.detail.indices);for(const Ht of Ft.target.options)Ht.selected=Mt.has(Ht.index);I.setValue(e,{value:at(!0)}),bt=at(!1)},editable(Ft){Ft.target.disabled=!Ft.detail.editable}};this._dispatchEventFromSandbox(Xt,xt)}),O.addEventListener("input",xt=>{var Ft;const Xt=at(!0);I.setValue(e,{value:Xt}),xt.preventDefault(),(Ft=this.linkService.eventBus)==null||Ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:bt,changeEx:Xt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(O,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],xt=>xt.target.value)):O.addEventListener("input",function(xt){I.setValue(e,{value:at(!0)})}),this.data.combo&&this._setTextStyle(O),this._setBackgroundColor(O),this._setDefaultPropertiesFromJS(O),this.container.append(O),this.container}}class m extends v{constructor(I){const{data:e,elements:b}=I;super(I,{isRenderable:v._hasPopupData(e)}),this.elements=b}render(){this.container.classList.add("popupAnnotation");const I=new l({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const b of this.elements)b.popup=I,e.push(b.data.id),b.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(b=>`${a.AnnotationPrefix}${b}`).join(",")),this.container}}class l{constructor({container:I,color:e,elements:b,titleObj:O,modificationDate:z,contentsObj:K,richText:at,parent:bt,rect:Rt,parentRect:xt,open:Xt}){B(this,Ut);B(this,jt);B(this,Wt);B(this,zt);B(this,N,null);B(this,st,X(this,Ut,On).bind(this));B(this,Z,X(this,zt,ln).bind(this));B(this,tt,X(this,Wt,on).bind(this));B(this,lt,X(this,jt,ke).bind(this));B(this,mt,null);B(this,ht,null);B(this,kt,null);B(this,Bt,null);B(this,Et,null);B(this,Dt,null);B(this,pt,!1);B(this,et,null);B(this,nt,null);B(this,ft,null);B(this,Pt,null);B(this,wt,!1);var Mt;rt(this,ht,I),rt(this,Pt,O),rt(this,kt,K),rt(this,ft,at),rt(this,Et,bt),rt(this,mt,e),rt(this,nt,Rt),rt(this,Dt,xt),rt(this,Bt,b);const Ft=p.PDFDateString.toDateObject(z);Ft&&rt(this,N,bt.l10n.get("annotation_date_string",{date:Ft.toLocaleDateString(),time:Ft.toLocaleTimeString()})),this.trigger=b.flatMap(Ht=>Ht.getElementsToTriggerPopup());for(const Ht of this.trigger)Ht.addEventListener("click",t(this,lt)),Ht.addEventListener("mouseenter",t(this,tt)),Ht.addEventListener("mouseleave",t(this,Z)),Ht.classList.add("popupTriggerArea");for(const Ht of b)(Mt=Ht.container)==null||Mt.addEventListener("keydown",t(this,st));t(this,ht).hidden=!0,Xt&&X(this,jt,ke).call(this)}render(){if(t(this,et))return;const{page:{view:I},viewport:{rawDims:{pageWidth:e,pageHeight:b,pageX:O,pageY:z}}}=t(this,Et),K=rt(this,et,document.createElement("div"));if(K.className="popup",t(this,mt)){const ne=K.style.outlineColor=a.Util.makeHexColor(...t(this,mt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?K.style.backgroundColor=`color-mix(in srgb, ${ne} 30%, white)`:K.style.backgroundColor=a.Util.makeHexColor(...t(this,mt).map(oe=>Math.floor(.7*(255-oe)+oe)))}const at=document.createElement("span");at.className="header";const bt=document.createElement("h1");if(at.append(bt),{dir:bt.dir,str:bt.textContent}=t(this,Pt),K.append(at),t(this,N)){const ne=document.createElement("span");ne.classList.add("popupDate"),t(this,N).then(ie=>{ne.textContent=ie}),at.append(ne)}const Rt=t(this,kt),xt=t(this,ft);if(xt!=null&&xt.str&&(!(Rt!=null&&Rt.str)||Rt.str===xt.str))F.XfaLayer.render({xfaHtml:xt.html,intent:"richText",div:K}),K.lastChild.classList.add("richText","popupContent");else{const ne=this._formatContents(Rt);K.append(ne)}let Xt=!!t(this,Dt),Ft=Xt?t(this,Dt):t(this,nt);for(const ne of t(this,Bt))if(!Ft||a.Util.intersect(ne.data.rect,Ft)!==null){Ft=ne.data.rect,Xt=!0;break}const Mt=a.Util.normalizeRect([Ft[0],I[3]-Ft[1]+I[1],Ft[2],I[3]-Ft[3]+I[1]]),Ht=5,qt=Xt?Ft[2]-Ft[0]+Ht:0,Kt=Mt[0]+qt,Qt=Mt[1],{style:se}=t(this,ht);se.left=`${100*(Kt-O)/e}%`,se.top=`${100*(Qt-z)/b}%`,t(this,ht).append(K)}_formatContents({str:I,dir:e}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=e;const O=I.split(/(?:\r\n?|\n)/);for(let z=0,K=O.length;z<K;++z){const at=O[z];b.append(document.createTextNode(at)),z<K-1&&b.append(document.createElement("br"))}return b}forceHide(){rt(this,wt,this.isVisible),t(this,wt)&&(t(this,ht).hidden=!0)}maybeShow(){t(this,wt)&&(rt(this,wt,!1),t(this,ht).hidden=!1)}get isVisible(){return t(this,ht).hidden===!1}}N=new WeakMap,st=new WeakMap,Z=new WeakMap,tt=new WeakMap,lt=new WeakMap,mt=new WeakMap,ht=new WeakMap,kt=new WeakMap,Bt=new WeakMap,Et=new WeakMap,Dt=new WeakMap,pt=new WeakMap,et=new WeakMap,nt=new WeakMap,ft=new WeakMap,Pt=new WeakMap,wt=new WeakMap,Ut=new WeakSet,On=function(I){I.altKey||I.shiftKey||I.ctrlKey||I.metaKey||(I.key==="Enter"||I.key==="Escape"&&t(this,pt))&&X(this,jt,ke).call(this)},jt=new WeakSet,ke=function(){rt(this,pt,!t(this,pt)),t(this,pt)?(X(this,Wt,on).call(this),t(this,ht).addEventListener("click",t(this,lt)),t(this,ht).addEventListener("keydown",t(this,st))):(X(this,zt,ln).call(this),t(this,ht).removeEventListener("click",t(this,lt)),t(this,ht).removeEventListener("keydown",t(this,st)))},Wt=new WeakSet,on=function(){t(this,et)||this.render(),this.isVisible?t(this,pt)&&t(this,ht).classList.add("focused"):(t(this,ht).hidden=!1,t(this,ht).style.zIndex=parseInt(t(this,ht).style.zIndex)+1e3)},zt=new WeakSet,ln=function(){t(this,ht).classList.remove("focused"),!(t(this,pt)||!this.isVisible)&&(t(this,ht).hidden=!0,t(this,ht).style.zIndex=parseInt(t(this,ht).style.zIndex)-1e3)};class R extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0}),this.textContent=I.data.textContent,this.textPosition=I.data.textPosition,this.annotationEditorType=a.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const I=document.createElement("div");I.classList.add("annotationTextContent"),I.setAttribute("role","comment");for(const e of this.textContent){const b=document.createElement("span");b.textContent=e,I.append(b)}this.container.append(I)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}r.FreeTextAnnotationElement=R;class f extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});B(this,Q,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:b,height:O}=L(e.rect),z=this.svgFactory.create(b,O,!0),K=rt(this,Q,this.svgFactory.createElement("svg:line"));return K.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),K.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),K.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),K.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),K.setAttribute("stroke-width",e.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),z.append(K),this.container.append(z),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Q)}addHighlightArea(){this.container.classList.add("highlightArea")}}Q=new WeakMap;class $ extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});B(this,Y,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:b,height:O}=L(e.rect),z=this.svgFactory.create(b,O,!0),K=e.borderStyle.width,at=rt(this,Y,this.svgFactory.createElement("svg:rect"));return at.setAttribute("x",K/2),at.setAttribute("y",K/2),at.setAttribute("width",b-K),at.setAttribute("height",O-K),at.setAttribute("stroke-width",K||1),at.setAttribute("stroke","transparent"),at.setAttribute("fill","transparent"),z.append(at),this.container.append(z),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Y)}addHighlightArea(){this.container.classList.add("highlightArea")}}Y=new WeakMap;class G extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});B(this,_t,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:b,height:O}=L(e.rect),z=this.svgFactory.create(b,O,!0),K=e.borderStyle.width,at=rt(this,_t,this.svgFactory.createElement("svg:ellipse"));return at.setAttribute("cx",b/2),at.setAttribute("cy",O/2),at.setAttribute("rx",b/2-K/2),at.setAttribute("ry",O/2-K/2),at.setAttribute("stroke-width",K||1),at.setAttribute("stroke","transparent"),at.setAttribute("fill","transparent"),z.append(at),this.container.append(z),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,_t)}addHighlightArea(){this.container.classList.add("highlightArea")}}_t=new WeakMap;class S extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});B(this,At,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:b,height:O}=L(e.rect),z=this.svgFactory.create(b,O,!0);let K=[];for(const bt of e.vertices){const Rt=bt.x-e.rect[0],xt=e.rect[3]-bt.y;K.push(Rt+","+xt)}K=K.join(" ");const at=rt(this,At,this.svgFactory.createElement(this.svgElementName));return at.setAttribute("points",K),at.setAttribute("stroke-width",e.borderStyle.width||1),at.setAttribute("stroke","transparent"),at.setAttribute("fill","transparent"),z.append(at),this.container.append(z),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,At)}addHighlightArea(){this.container.classList.add("highlightArea")}}At=new WeakMap;class q extends S{constructor(I){super(I),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class it extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ot extends v{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});B(this,te,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=a.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:b,height:O}=L(e.rect),z=this.svgFactory.create(b,O,!0);for(const K of e.inkLists){let at=[];for(const Rt of K){const xt=Rt.x-e.rect[0],Xt=e.rect[3]-Rt.y;at.push(`${xt},${Xt}`)}at=at.join(" ");const bt=this.svgFactory.createElement(this.svgElementName);t(this,te).push(bt),bt.setAttribute("points",at),bt.setAttribute("stroke-width",e.borderStyle.width||1),bt.setAttribute("stroke","transparent"),bt.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),z.append(bt)}return this.container.append(z),this.container}getElementsToTriggerPopup(){return t(this,te)}addHighlightArea(){this.container.classList.add("highlightArea")}}te=new WeakMap,r.InkAnnotationElement=ot;class W extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ct extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gt extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class vt extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Tt extends v{constructor(I){super(I,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}r.StampAnnotationElement=Tt;class w extends v{constructor(e){var z;super(e,{isRenderable:!0});B(this,J);B(this,Zt,null);const{filename:b,content:O}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(b,!0),this.content=O,(z=this.linkService.eventBus)==null||z.dispatch("fileattachmentannotation",{source:this,filename:b,content:O})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:b}=this;let O;b.hasAppearance||b.fillAlpha===0?O=document.createElement("div"):(O=document.createElement("img"),O.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(b.name)?"paperclip":"pushpin"}.svg`,b.fillAlpha&&b.fillAlpha<1&&(O.style=`filter: opacity(${Math.round(b.fillAlpha*100)}%);`)),O.addEventListener("dblclick",X(this,J,cn).bind(this)),rt(this,Zt,O);const{isMac:z}=a.FeatureTest.platform;return e.addEventListener("keydown",K=>{K.key==="Enter"&&(z?K.metaKey:K.ctrlKey)&&X(this,J,cn).call(this)}),!b.popupRef&&this.hasPopupData?this._createPopup():O.classList.add("popupTriggerArea"),e.append(O),e}getElementsToTriggerPopup(){return t(this,Zt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zt=new WeakMap,J=new WeakSet,cn=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)};class n{constructor({div:I,accessibilityManager:e,annotationCanvasMap:b,l10n:O,page:z,viewport:K}){B(this,Nt);B(this,yt);B(this,It,null);B(this,Ct,null);B(this,Ot,new Map);this.div=I,rt(this,It,e),rt(this,Ct,b),this.l10n=O,this.page=z,this.viewport=K,this.zIndex=0,this.l10n||(this.l10n=dt.NullL10n)}async render(I){const{annotations:e}=I,b=this.div;(0,p.setLayerDimensions)(b,this.viewport);const O=new Map,z={data:null,layer:b,linkService:I.linkService,downloadManager:I.downloadManager,imageResourcesPath:I.imageResourcesPath||"",renderForms:I.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:I.annotationStorage||new V.AnnotationStorage,enableScripting:I.enableScripting===!0,hasJSActions:I.hasJSActions,fieldObjects:I.fieldObjects,parent:this,elements:null};for(const K of e){if(K.noHTML)continue;const at=K.annotationType===a.AnnotationType.POPUP;if(at){const xt=O.get(K.id);if(!xt)continue;z.elements=xt}else{const{width:xt,height:Xt}=L(K.rect);if(xt<=0||Xt<=0)continue}z.data=K;const bt=C.create(z);if(!bt.isRenderable)continue;if(!at&&K.popupRef){const xt=O.get(K.popupRef);xt?xt.push(bt):O.set(K.popupRef,[bt])}bt.annotationEditorType>0&&t(this,Ot).set(bt.data.id,bt);const Rt=bt.render();K.hidden&&(Rt.style.visibility="hidden"),X(this,Nt,Nn).call(this,Rt,K.id)}X(this,yt,hn).call(this),await this.l10n.translate(b)}update({viewport:I}){const e=this.div;this.viewport=I,(0,p.setLayerDimensions)(e,{rotation:I.rotation}),X(this,yt,hn).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(t(this,Ot).values())}getEditableAnnotation(I){return t(this,Ot).get(I)}}It=new WeakMap,Ct=new WeakMap,Ot=new WeakMap,Nt=new WeakSet,Nn=function(I,e){var O;const b=I.firstChild||I;b.id=`${a.AnnotationPrefix}${e}`,this.div.append(I),(O=t(this,It))==null||O.moveElementInDOM(this.div,I,b,!1)},yt=new WeakSet,hn=function(){if(!t(this,Ct))return;const I=this.div;for(const[e,b]of t(this,Ct)){const O=I.querySelector(`[data-annotation-id="${e}"]`);if(!O)continue;const{firstChild:z}=O;z?z.nodeName==="CANVAS"?z.replaceWith(b):z.before(b):O.append(b)}t(this,Ct).clear()},r.AnnotationLayer=n},(H,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;function U(V){return Math.floor(Math.max(0,Math.min(1,V))*255).toString(16).padStart(2,"0")}function a(V){return Math.max(0,Math.min(255,255*V))}class p{static CMYK_G([j,dt,F,x]){return["G",1-Math.min(1,.3*j+.59*F+.11*dt+x)]}static G_CMYK([j]){return["CMYK",0,0,0,1-j]}static G_RGB([j]){return["RGB",j,j,j]}static G_rgb([j]){return j=a(j),[j,j,j]}static G_HTML([j]){const dt=U(j);return`#${dt}${dt}${dt}`}static RGB_G([j,dt,F]){return["G",.3*j+.59*dt+.11*F]}static RGB_rgb(j){return j.map(a)}static RGB_HTML(j){return`#${j.map(U).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([j,dt,F,x]){return["RGB",1-Math.min(1,j+x),1-Math.min(1,F+x),1-Math.min(1,dt+x)]}static CMYK_rgb([j,dt,F,x]){return[a(1-Math.min(1,j+x)),a(1-Math.min(1,F+x)),a(1-Math.min(1,dt+x))]}static CMYK_HTML(j){const dt=this.CMYK_RGB(j).slice(1);return this.RGB_HTML(dt)}static RGB_CMYK([j,dt,F]){const x=1-j,g=1-dt,D=1-F,L=Math.min(x,g,D);return["CMYK",x,g,D,L]}}r.ColorConverters=p},(H,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NullL10n=void 0,r.getL10nFallback=a;const U={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};U.print_progress_percent="{{progress}}%";function a(j,dt){switch(j){case"find_match_count":j=`find_match_count[${dt.total===1?"one":"other"}]`;break;case"find_match_count_limit":j=`find_match_count_limit[${dt.limit===1?"one":"other"}]`;break}return U[j]||""}function p(j,dt){return dt?j.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(F,x)=>x in dt?dt[x]:"{{"+x+"}}"):j}const V={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(j,dt=null,F=a(j,dt)){return p(F,dt)},async translate(j){}};r.NullL10n=V},(H,r,U)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;var a=U(25);class p{static setupStorage(j,dt,F,x,g){const D=x.getValue(dt,{value:null});switch(F.name){case"textarea":if(D.value!==null&&(j.textContent=D.value),g==="print")break;j.addEventListener("input",L=>{x.setValue(dt,{value:L.target.value})});break;case"input":if(F.attributes.type==="radio"||F.attributes.type==="checkbox"){if(D.value===F.attributes.xfaOn?j.setAttribute("checked",!0):D.value===F.attributes.xfaOff&&j.removeAttribute("checked"),g==="print")break;j.addEventListener("change",L=>{x.setValue(dt,{value:L.target.checked?L.target.getAttribute("xfaOn"):L.target.getAttribute("xfaOff")})})}else{if(D.value!==null&&j.setAttribute("value",D.value),g==="print")break;j.addEventListener("input",L=>{x.setValue(dt,{value:L.target.value})})}break;case"select":if(D.value!==null){j.setAttribute("value",D.value);for(const L of F.children)L.attributes.value===D.value?L.attributes.selected=!0:L.attributes.hasOwnProperty("selected")&&delete L.attributes.selected}j.addEventListener("input",L=>{const C=L.target.options,v=C.selectedIndex===-1?"":C[C.selectedIndex].value;x.setValue(dt,{value:v})});break}}static setAttributes({html:j,element:dt,storage:F=null,intent:x,linkService:g}){const{attributes:D}=dt,L=j instanceof HTMLAnchorElement;D.type==="radio"&&(D.name=`${D.name}-${x}`);for(const[C,v]of Object.entries(D))if(v!=null)switch(C){case"class":v.length&&j.setAttribute(C,v.join(" "));break;case"dataId":break;case"id":j.setAttribute("data-element-id",v);break;case"style":Object.assign(j.style,v);break;case"textContent":j.textContent=v;break;default:(!L||C!=="href"&&C!=="newWindow")&&j.setAttribute(C,v)}L&&g.addLinkAttributes(j,D.href,D.newWindow),F&&D.dataId&&this.setupStorage(j,D.dataId,dt,F)}static render(j){var y;const dt=j.annotationStorage,F=j.linkService,x=j.xfaHtml,g=j.intent||"display",D=document.createElement(x.name);x.attributes&&this.setAttributes({html:D,element:x,intent:g,linkService:F});const L=[[x,-1,D]],C=j.div;if(C.append(D),j.viewport){const u=`matrix(${j.viewport.transform.join(",")})`;C.style.transform=u}g!=="richText"&&C.setAttribute("class","xfaLayer xfaFont");const v=[];for(;L.length>0;){const[u,_,P]=L.at(-1);if(_+1===u.children.length){L.pop();continue}const T=u.children[++L.at(-1)[1]];if(T===null)continue;const{name:A}=T;if(A==="#text"){const h=document.createTextNode(T.value);v.push(h),P.append(h);continue}const o=(y=T==null?void 0:T.attributes)!=null&&y.xmlns?document.createElementNS(T.attributes.xmlns,A):document.createElement(A);if(P.append(o),T.attributes&&this.setAttributes({html:o,element:T,storage:dt,intent:g,linkService:F}),T.children&&T.children.length>0)L.push([T,-1,o]);else if(T.value){const h=document.createTextNode(T.value);a.XfaText.shouldBuildText(A)&&v.push(h),o.append(h)}}for(const u of C.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:v}}static update(j){const dt=`matrix(${j.viewport.transform.join(",")})`;j.div.style.transform=dt,j.div.hidden=!1}}r.XfaLayer=p},(H,r,U)=>{var x,g,D,L,C,v,y,u,_,P,T,A,o,h,k,Bn,l,Un,f,jn,G,$n,q,dn,ot,Hn,ct,un,vt,Wn,w,Gn,i,Vn,c,zn,E,Xn,N,ae,Z,fn,lt,Fe,ht,Me,Bt,fe,Dt,pn,et,De,ft,qn,wt,gn,Gt,Yn,Vt,Kn,$t,mn,ut,Le,Y,pe;Object.defineProperty(r,"__esModule",{value:!0}),r.InkEditor=void 0;var a=U(1),p=U(4),V=U(29),j=U(6),dt=U(5);const At=class At extends p.AnnotationEditor{constructor(J){super({...J,name:"inkEditor"});B(this,k);B(this,l);B(this,f);B(this,G);B(this,q);B(this,ot);B(this,ct);B(this,vt);B(this,w);B(this,i);B(this,c);B(this,E);B(this,N);B(this,Z);B(this,lt);B(this,ht);B(this,Bt);B(this,Dt);B(this,et);B(this,Vt);B(this,$t);B(this,ut);B(this,Y);B(this,x,0);B(this,g,0);B(this,D,this.canvasPointermove.bind(this));B(this,L,this.canvasPointerleave.bind(this));B(this,C,this.canvasPointerup.bind(this));B(this,v,this.canvasPointerdown.bind(this));B(this,y,new Path2D);B(this,u,!1);B(this,_,!1);B(this,P,!1);B(this,T,null);B(this,A,0);B(this,o,0);B(this,h,null);this.color=J.color||null,this.thickness=J.thickness||null,this.opacity=J.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(J){p.AnnotationEditor.initialize(J,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(J,St){switch(J){case a.AnnotationEditorParamsType.INK_THICKNESS:At._defaultThickness=St;break;case a.AnnotationEditorParamsType.INK_COLOR:At._defaultColor=St;break;case a.AnnotationEditorParamsType.INK_OPACITY:At._defaultOpacity=St/100;break}}updateParams(J,St){switch(J){case a.AnnotationEditorParamsType.INK_THICKNESS:X(this,k,Bn).call(this,St);break;case a.AnnotationEditorParamsType.INK_COLOR:X(this,l,Un).call(this,St);break;case a.AnnotationEditorParamsType.INK_OPACITY:X(this,f,jn).call(this,St);break}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,At._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,At._defaultColor||p.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(At._defaultOpacity*100)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||At._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||At._defaultColor||p.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??At._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(X(this,lt,Fe).call(this),X(this,ht,Me).call(this)),this.isAttachedToDOM||(this.parent.add(this),X(this,Bt,fe).call(this)),X(this,Y,pe).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,T).disconnect(),rt(this,T,null),super.remove())}setParent(J){!this.parent&&J?this._uiManager.removeShouldRescale(this):this.parent&&J===null&&this._uiManager.addShouldRescale(this),super.setParent(J)}onScaleChanging(){const[J,St]=this.parentDimensions,It=this.width*J,Ct=this.height*St;this.setDimensions(It,Ct)}enableEditMode(){t(this,u)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,v)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,v)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,u)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),rt(this,u,!0),this.div.classList.add("disabled"),X(this,Y,pe).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(J){this._focusEventsAllowed&&(super.focusin(J),this.enableEditMode())}canvasPointerdown(J){J.button!==0||!this.isInEditMode()||t(this,u)||(this.setInForeground(),J.preventDefault(),J.type!=="mouse"&&this.div.focus(),X(this,ot,Hn).call(this,J.offsetX,J.offsetY))}canvasPointermove(J){J.preventDefault(),X(this,ct,un).call(this,J.offsetX,J.offsetY)}canvasPointerup(J){J.preventDefault(),X(this,Z,fn).call(this,J)}canvasPointerleave(J){X(this,Z,fn).call(this,J)}get isResizable(){return!this.isEmpty()&&t(this,u)}render(){if(this.div)return this.div;let J,St;this.width&&(J=this.x,St=this.y),super.render(),p.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Jt=>{var yt;return(yt=this.div)==null?void 0:yt.setAttribute("aria-label",Jt)});const[It,Ct,Ot,Nt]=X(this,G,$n).call(this);if(this.setAt(It,Ct,0,0),this.setDims(Ot,Nt),X(this,lt,Fe).call(this),this.width){const[Jt,yt]=this.parentDimensions;this.setAspectRatio(this.width*Jt,this.height*yt),this.setAt(J*Jt,St*yt,this.width*Jt,this.height*yt),rt(this,P,!0),X(this,Bt,fe).call(this),this.setDims(this.width*Jt,this.height*yt),X(this,N,ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return X(this,ht,Me).call(this),this.div}setDimensions(J,St){const It=Math.round(J),Ct=Math.round(St);if(t(this,A)===It&&t(this,o)===Ct)return;rt(this,A,It),rt(this,o,Ct),this.canvas.style.visibility="hidden";const[Ot,Nt]=this.parentDimensions;this.width=J/Ot,this.height=St/Nt,this.fixAndSetPosition(),t(this,u)&&X(this,Dt,pn).call(this,J,St),X(this,Bt,fe).call(this),X(this,N,ae).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(J,St,It){var z,K,at;if(J instanceof V.InkAnnotationElement)return null;const Ct=super.deserialize(J,St,It);Ct.thickness=J.thickness,Ct.color=a.Util.makeHexColor(...J.color),Ct.opacity=J.opacity;const[Ot,Nt]=Ct.pageDimensions,Jt=Ct.width*Ot,yt=Ct.height*Nt,Yt=Ct.parentScale,Lt=J.thickness/2;rt(Ct,u,!0),rt(Ct,A,Math.round(Jt)),rt(Ct,o,Math.round(yt));const{paths:I,rect:e,rotation:b}=J;for(let{bezier:bt}of I){bt=X(z=At,Gt,Yn).call(z,bt,e,b);const Rt=[];Ct.paths.push(Rt);let xt=Yt*(bt[0]-Lt),Xt=Yt*(bt[1]-Lt);for(let Mt=2,Ht=bt.length;Mt<Ht;Mt+=6){const qt=Yt*(bt[Mt]-Lt),Kt=Yt*(bt[Mt+1]-Lt),Qt=Yt*(bt[Mt+2]-Lt),se=Yt*(bt[Mt+3]-Lt),ne=Yt*(bt[Mt+4]-Lt),ie=Yt*(bt[Mt+5]-Lt);Rt.push([[xt,Xt],[qt,Kt],[Qt,se],[ne,ie]]),xt=ne,Xt=ie}const Ft=X(this,ft,qn).call(this,Rt);Ct.bezierPath2D.push(Ft)}const O=X(K=Ct,$t,mn).call(K);return rt(Ct,g,Math.max(p.AnnotationEditor.MIN_SIZE,O[2]-O[0])),rt(Ct,x,Math.max(p.AnnotationEditor.MIN_SIZE,O[3]-O[1])),X(at=Ct,Dt,pn).call(at,Jt,yt),Ct}serialize(){if(this.isEmpty())return null;const J=this.getRect(0,0),St=p.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:St,thickness:this.thickness,opacity:this.opacity,paths:X(this,Vt,Kn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,J),pageIndex:this.pageIndex,rect:J,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};x=new WeakMap,g=new WeakMap,D=new WeakMap,L=new WeakMap,C=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,P=new WeakMap,T=new WeakMap,A=new WeakMap,o=new WeakMap,h=new WeakMap,k=new WeakSet,Bn=function(J){const St=this.thickness;this.addCommands({cmd:()=>{this.thickness=J,X(this,Y,pe).call(this)},undo:()=>{this.thickness=St,X(this,Y,pe).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Un=function(J){const St=this.color;this.addCommands({cmd:()=>{this.color=J,X(this,N,ae).call(this)},undo:()=>{this.color=St,X(this,N,ae).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},f=new WeakSet,jn=function(J){J/=100;const St=this.opacity;this.addCommands({cmd:()=>{this.opacity=J,X(this,N,ae).call(this)},undo:()=>{this.opacity=St,X(this,N,ae).call(this)},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},G=new WeakSet,$n=function(){const{parentRotation:J,parentDimensions:[St,It]}=this;switch(J){case 90:return[0,It,It,St];case 180:return[St,It,St,It];case 270:return[St,0,It,St];default:return[0,0,St,It]}},q=new WeakSet,dn=function(){const{ctx:J,color:St,opacity:It,thickness:Ct,parentScale:Ot,scaleFactor:Nt}=this;J.lineWidth=Ct*Ot/Nt,J.lineCap="round",J.lineJoin="round",J.miterLimit=10,J.strokeStyle=`${St}${(0,dt.opacityToHex)(It)}`},ot=new WeakSet,Hn=function(J,St){this.canvas.addEventListener("contextmenu",j.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,L)),this.canvas.addEventListener("pointermove",t(this,D)),this.canvas.addEventListener("pointerup",t(this,C)),this.canvas.removeEventListener("pointerdown",t(this,v)),this.isEditing=!0,t(this,P)||(rt(this,P,!0),X(this,Bt,fe).call(this),this.thickness||(this.thickness=At._defaultThickness),this.color||(this.color=At._defaultColor||p.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=At._defaultOpacity)),this.currentPath.push([J,St]),rt(this,_,!1),X(this,q,dn).call(this),rt(this,h,()=>{X(this,i,Vn).call(this),t(this,h)&&window.requestAnimationFrame(t(this,h))}),window.requestAnimationFrame(t(this,h))},ct=new WeakSet,un=function(J,St){const[It,Ct]=this.currentPath.at(-1);if(this.currentPath.length>1&&J===It&&St===Ct)return;const Ot=this.currentPath;let Nt=t(this,y);if(Ot.push([J,St]),rt(this,_,!0),Ot.length<=2){Nt.moveTo(...Ot[0]),Nt.lineTo(J,St);return}Ot.length===3&&(rt(this,y,Nt=new Path2D),Nt.moveTo(...Ot[0])),X(this,c,zn).call(this,Nt,...Ot.at(-3),...Ot.at(-2),J,St)},vt=new WeakSet,Wn=function(){if(this.currentPath.length===0)return;const J=this.currentPath.at(-1);t(this,y).lineTo(...J)},w=new WeakSet,Gn=function(J,St){rt(this,h,null),J=Math.min(Math.max(J,0),this.canvas.width),St=Math.min(Math.max(St,0),this.canvas.height),X(this,ct,un).call(this,J,St),X(this,vt,Wn).call(this);let It;if(this.currentPath.length!==1)It=X(this,E,Xn).call(this);else{const yt=[J,St];It=[[yt,yt.slice(),yt.slice(),yt]]}const Ct=t(this,y),Ot=this.currentPath;this.currentPath=[],rt(this,y,new Path2D);const Nt=()=>{this.allRawPaths.push(Ot),this.paths.push(It),this.bezierPath2D.push(Ct),this.rebuild()},Jt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(X(this,lt,Fe).call(this),X(this,ht,Me).call(this)),X(this,Y,pe).call(this))};this.addCommands({cmd:Nt,undo:Jt,mustExec:!0})},i=new WeakSet,Vn=function(){if(!t(this,_))return;rt(this,_,!1);const J=Math.ceil(this.thickness*this.parentScale),St=this.currentPath.slice(-3),It=St.map(Nt=>Nt[0]),Ct=St.map(Nt=>Nt[1]);Math.min(...It)-J,Math.max(...It)+J,Math.min(...Ct)-J,Math.max(...Ct)+J;const{ctx:Ot}=this;Ot.save(),Ot.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Nt of this.bezierPath2D)Ot.stroke(Nt);Ot.stroke(t(this,y)),Ot.restore()},c=new WeakSet,zn=function(J,St,It,Ct,Ot,Nt,Jt){const yt=(St+Ct)/2,Yt=(It+Ot)/2,Lt=(Ct+Nt)/2,I=(Ot+Jt)/2;J.bezierCurveTo(yt+2*(Ct-yt)/3,Yt+2*(Ot-Yt)/3,Lt+2*(Ct-Lt)/3,I+2*(Ot-I)/3,Lt,I)},E=new WeakSet,Xn=function(){const J=this.currentPath;if(J.length<=2)return[[J[0],J[0],J.at(-1),J.at(-1)]];const St=[];let It,[Ct,Ot]=J[0];for(It=1;It<J.length-2;It++){const[e,b]=J[It],[O,z]=J[It+1],K=(e+O)/2,at=(b+z)/2,bt=[Ct+2*(e-Ct)/3,Ot+2*(b-Ot)/3],Rt=[K+2*(e-K)/3,at+2*(b-at)/3];St.push([[Ct,Ot],bt,Rt,[K,at]]),[Ct,Ot]=[K,at]}const[Nt,Jt]=J[It],[yt,Yt]=J[It+1],Lt=[Ct+2*(Nt-Ct)/3,Ot+2*(Jt-Ot)/3],I=[yt+2*(Nt-yt)/3,Yt+2*(Jt-Yt)/3];return St.push([[Ct,Ot],Lt,I,[yt,Yt]]),St},N=new WeakSet,ae=function(){if(this.isEmpty()){X(this,et,De).call(this);return}X(this,q,dn).call(this);const{canvas:J,ctx:St}=this;St.setTransform(1,0,0,1,0,0),St.clearRect(0,0,J.width,J.height),X(this,et,De).call(this);for(const It of this.bezierPath2D)St.stroke(It)},Z=new WeakSet,fn=function(J){this.canvas.removeEventListener("pointerleave",t(this,L)),this.canvas.removeEventListener("pointermove",t(this,D)),this.canvas.removeEventListener("pointerup",t(this,C)),this.canvas.addEventListener("pointerdown",t(this,v)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",j.noContextMenu)},10),X(this,w,Gn).call(this,J.offsetX,J.offsetY),this.addToAnnotationStorage(),this.setInBackground()},lt=new WeakSet,Fe=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",p.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(J=>{var St;return(St=this.canvas)==null?void 0:St.setAttribute("aria-label",J)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ht=new WeakSet,Me=function(){rt(this,T,new ResizeObserver(J=>{const St=J[0].contentRect;St.width&&St.height&&this.setDimensions(St.width,St.height)})),t(this,T).observe(this.div)},Bt=new WeakSet,fe=function(){if(!t(this,P))return;const[J,St]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*J),this.canvas.height=Math.ceil(this.height*St),X(this,et,De).call(this)},Dt=new WeakSet,pn=function(J,St){const It=X(this,ut,Le).call(this),Ct=(J-It)/t(this,g),Ot=(St-It)/t(this,x);this.scaleFactor=Math.min(Ct,Ot)},et=new WeakSet,De=function(){const J=X(this,ut,Le).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+J,this.translationY*this.scaleFactor+J)},ft=new WeakSet,qn=function(J){const St=new Path2D;for(let It=0,Ct=J.length;It<Ct;It++){const[Ot,Nt,Jt,yt]=J[It];It===0&&St.moveTo(...Ot),St.bezierCurveTo(Nt[0],Nt[1],Jt[0],Jt[1],yt[0],yt[1])}return St},wt=new WeakSet,gn=function(J,St,It){const[Ct,Ot,Nt,Jt]=St;switch(It){case 0:for(let yt=0,Yt=J.length;yt<Yt;yt+=2)J[yt]+=Ct,J[yt+1]=Jt-J[yt+1];break;case 90:for(let yt=0,Yt=J.length;yt<Yt;yt+=2){const Lt=J[yt];J[yt]=J[yt+1]+Ct,J[yt+1]=Lt+Ot}break;case 180:for(let yt=0,Yt=J.length;yt<Yt;yt+=2)J[yt]=Nt-J[yt],J[yt+1]+=Ot;break;case 270:for(let yt=0,Yt=J.length;yt<Yt;yt+=2){const Lt=J[yt];J[yt]=Nt-J[yt+1],J[yt+1]=Jt-Lt}break;default:throw new Error("Invalid rotation")}return J},Gt=new WeakSet,Yn=function(J,St,It){const[Ct,Ot,Nt,Jt]=St;switch(It){case 0:for(let yt=0,Yt=J.length;yt<Yt;yt+=2)J[yt]-=Ct,J[yt+1]=Jt-J[yt+1];break;case 90:for(let yt=0,Yt=J.length;yt<Yt;yt+=2){const Lt=J[yt];J[yt]=J[yt+1]-Ot,J[yt+1]=Lt-Ct}break;case 180:for(let yt=0,Yt=J.length;yt<Yt;yt+=2)J[yt]=Nt-J[yt],J[yt+1]-=Ot;break;case 270:for(let yt=0,Yt=J.length;yt<Yt;yt+=2){const Lt=J[yt];J[yt]=Jt-J[yt+1],J[yt+1]=Nt-Lt}break;default:throw new Error("Invalid rotation")}return J},Vt=new WeakSet,Kn=function(J,St,It,Ct){var Yt,Lt;const Ot=[],Nt=this.thickness/2,Jt=J*St+Nt,yt=J*It+Nt;for(const I of this.paths){const e=[],b=[];for(let O=0,z=I.length;O<z;O++){const[K,at,bt,Rt]=I[O],xt=J*K[0]+Jt,Xt=J*K[1]+yt,Ft=J*at[0]+Jt,Mt=J*at[1]+yt,Ht=J*bt[0]+Jt,qt=J*bt[1]+yt,Kt=J*Rt[0]+Jt,Qt=J*Rt[1]+yt;O===0&&(e.push(xt,Xt),b.push(xt,Xt)),e.push(Ft,Mt,Ht,qt,Kt,Qt),b.push(Ft,Mt),O===z-1&&b.push(Kt,Qt)}Ot.push({bezier:X(Yt=At,wt,gn).call(Yt,e,Ct,this.rotation),points:X(Lt=At,wt,gn).call(Lt,b,Ct,this.rotation)})}return Ot},$t=new WeakSet,mn=function(){let J=1/0,St=-1/0,It=1/0,Ct=-1/0;for(const Ot of this.paths)for(const[Nt,Jt,yt,Yt]of Ot){const Lt=a.Util.bezierBoundingBox(...Nt,...Jt,...yt,...Yt);J=Math.min(J,Lt[0]),It=Math.min(It,Lt[1]),St=Math.max(St,Lt[2]),Ct=Math.max(Ct,Lt[3])}return[J,It,St,Ct]},ut=new WeakSet,Le=function(){return t(this,u)?Math.ceil(this.thickness*this.parentScale):0},Y=new WeakSet,pe=function(J=!1){if(this.isEmpty())return;if(!t(this,u)){X(this,N,ae).call(this);return}const St=X(this,$t,mn).call(this),It=X(this,ut,Le).call(this);rt(this,g,Math.max(p.AnnotationEditor.MIN_SIZE,St[2]-St[0])),rt(this,x,Math.max(p.AnnotationEditor.MIN_SIZE,St[3]-St[1]));const Ct=Math.ceil(It+t(this,g)*this.scaleFactor),Ot=Math.ceil(It+t(this,x)*this.scaleFactor),[Nt,Jt]=this.parentDimensions;this.width=Ct/Nt,this.height=Ot/Jt,this.setAspectRatio(Ct,Ot);const yt=this.translationX,Yt=this.translationY;this.translationX=-St[0],this.translationY=-St[1],X(this,Bt,fe).call(this),X(this,N,ae).call(this),rt(this,A,Ct),rt(this,o,Ot),this.setDims(Ct,Ot);const Lt=J?It/this.scaleFactor/2:0;this.translate(yt-this.translationX-Lt,Yt-this.translationY-Lt)},B(At,ft),B(At,wt),B(At,Gt),ee(At,"_defaultColor",null),ee(At,"_defaultOpacity",1),ee(At,"_defaultThickness",1),ee(At,"_type","ink");let F=At;r.InkEditor=F},(H,r,U)=>{var F,x,g,D,L,C,v,y,u,_,P,ve,A,Ee,h,Ie,m,bn,R,Jn,$,Qn,S,_n,it,Oe,W,Zn;Object.defineProperty(r,"__esModule",{value:!0}),r.StampEditor=void 0;var a=U(1),p=U(4),V=U(6),j=U(29);const gt=class gt extends p.AnnotationEditor{constructor(w){super({...w,name:"stampEditor"});B(this,P);B(this,A);B(this,h);B(this,m);B(this,R);B(this,$);B(this,S);B(this,it);B(this,W);B(this,F,null);B(this,x,null);B(this,g,null);B(this,D,null);B(this,L,null);B(this,C,null);B(this,v,null);B(this,y,null);B(this,u,!1);B(this,_,!1);rt(this,D,w.bitmapUrl),rt(this,L,w.bitmapFile)}static initialize(w){p.AnnotationEditor.initialize(w)}static get supportedTypes(){const w=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,a.shadow)(this,"supportedTypes",w.map(n=>`image/${n}`))}static get supportedTypesStr(){return(0,a.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(w){return this.supportedTypes.includes(w)}static paste(w,n){n.pasteEditor(a.AnnotationEditorType.STAMP,{bitmapFile:w.getAsFile()})}remove(){var w,n;t(this,x)&&(rt(this,F,null),this._uiManager.imageManager.deleteId(t(this,x)),(w=t(this,C))==null||w.remove(),rt(this,C,null),(n=t(this,v))==null||n.disconnect(),rt(this,v,null)),super.remove()}rebuild(){if(!this.parent){t(this,x)&&X(this,h,Ie).call(this);return}super.rebuild(),this.div!==null&&(t(this,x)&&X(this,h,Ie).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,g)||t(this,F)||t(this,D)||t(this,L))}get isResizable(){return!0}render(){if(this.div)return this.div;let w,n;if(this.width&&(w=this.x,n=this.y),super.render(),this.div.hidden=!0,t(this,F)?X(this,m,bn).call(this):X(this,h,Ie).call(this),this.width){const[i,s]=this.parentDimensions;this.setAt(w*i,n*s,this.width*i,this.height*s)}return this.div}static deserialize(w,n,i){if(w instanceof j.StampAnnotationElement)return null;const s=super.deserialize(w,n,i),{rect:c,bitmapUrl:d,bitmapId:E,isSvg:M,accessibilityData:N}=w;E&&i.imageManager.isValidId(E)?rt(s,x,E):rt(s,D,d),rt(s,u,M);const[st,Z]=s.pageDimensions;return s.width=(c[2]-c[0])/st,s.height=(c[3]-c[1])/Z,N&&(s.altTextData=N),s}serialize(w=!1,n=null){if(this.isEmpty())return null;const i={annotationType:a.AnnotationEditorType.STAMP,bitmapId:t(this,x),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,u),structTreeParentId:this._structTreeParentId};if(w)return i.bitmapUrl=X(this,it,Oe).call(this,!0),i.accessibilityData=this.altTextData,i;const{decorative:s,altText:c}=this.altTextData;if(!s&&c&&(i.accessibilityData={type:"Figure",alt:c}),n===null)return i;n.stamps||(n.stamps=new Map);const d=t(this,u)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!n.stamps.has(t(this,x)))n.stamps.set(t(this,x),{area:d,serialized:i}),i.bitmap=X(this,it,Oe).call(this,!1);else if(t(this,u)){const E=n.stamps.get(t(this,x));d>E.area&&(E.area=d,E.serialized.bitmap.close(),E.serialized.bitmap=X(this,it,Oe).call(this,!1))}return i}};F=new WeakMap,x=new WeakMap,g=new WeakMap,D=new WeakMap,L=new WeakMap,C=new WeakMap,v=new WeakMap,y=new WeakMap,u=new WeakMap,_=new WeakMap,P=new WeakSet,ve=function(w,n=!1){if(!w){this.remove();return}rt(this,F,w.bitmap),n||(rt(this,x,w.id),rt(this,u,w.isSvg)),X(this,m,bn).call(this)},A=new WeakSet,Ee=function(){rt(this,g,null),this._uiManager.enableWaiting(!1),t(this,C)&&this.div.focus()},h=new WeakSet,Ie=function(){if(t(this,x)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,x)).then(n=>X(this,P,ve).call(this,n,!0)).finally(()=>X(this,A,Ee).call(this));return}if(t(this,D)){const n=t(this,D);rt(this,D,null),this._uiManager.enableWaiting(!0),rt(this,g,this._uiManager.imageManager.getFromUrl(n).then(i=>X(this,P,ve).call(this,i)).finally(()=>X(this,A,Ee).call(this)));return}if(t(this,L)){const n=t(this,L);rt(this,L,null),this._uiManager.enableWaiting(!0),rt(this,g,this._uiManager.imageManager.getFromFile(n).then(i=>X(this,P,ve).call(this,i)).finally(()=>X(this,A,Ee).call(this)));return}const w=document.createElement("input");w.type="file",w.accept=gt.supportedTypesStr,rt(this,g,new Promise(n=>{w.addEventListener("change",async()=>{if(!w.files||w.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(w.files[0]);X(this,P,ve).call(this,i)}n()}),w.addEventListener("cancel",()=>{this.remove(),n()})}).finally(()=>X(this,A,Ee).call(this))),w.click()},m=new WeakSet,bn=function(){const{div:w}=this;let{width:n,height:i}=t(this,F);const[s,c]=this.pageDimensions,d=.75;if(this.width)n=this.width*s,i=this.height*c;else if(n>d*s||i>d*c){const st=Math.min(d*s/n,d*c/i);n*=st,i*=st}const[E,M]=this.parentDimensions;this.setDims(n*E/s,i*M/c),this._uiManager.enableWaiting(!1);const N=rt(this,C,document.createElement("canvas"));w.append(N),w.hidden=!1,X(this,S,_n).call(this,n,i),X(this,W,Zn).call(this),t(this,_)||(this.parent.addUndoableEditor(this),rt(this,_,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},R=new WeakSet,Jn=function(w,n){var d;const[i,s]=this.parentDimensions;this.width=w/i,this.height=n/s,this.setDims(w,n),(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,y)!==null&&clearTimeout(t(this,y)),rt(this,y,setTimeout(()=>{rt(this,y,null),X(this,S,_n).call(this,w,n)},200))},$=new WeakSet,Qn=function(w,n){const{width:i,height:s}=t(this,F);let c=i,d=s,E=t(this,F);for(;c>2*w||d>2*n;){const M=c,N=d;c>2*w&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2)),d>2*n&&(d=d>=16384?Math.floor(d/2)-1:Math.ceil(d/2));const st=new OffscreenCanvas(c,d);st.getContext("2d").drawImage(E,0,0,M,N,0,0,c,d),E=st.transferToImageBitmap()}return E},S=new WeakSet,_n=function(w,n){w=Math.ceil(w),n=Math.ceil(n);const i=t(this,C);if(!i||i.width===w&&i.height===n)return;i.width=w,i.height=n;const s=t(this,u)?t(this,F):X(this,$,Qn).call(this,w,n),c=i.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(s,0,0,s.width,s.height,0,0,w,n)},it=new WeakSet,Oe=function(w){if(w){if(t(this,u)){const s=this._uiManager.imageManager.getSvgUrl(t(this,x));if(s)return s}const n=document.createElement("canvas");return{width:n.width,height:n.height}=t(this,F),n.getContext("2d").drawImage(t(this,F),0,0),n.toDataURL()}if(t(this,u)){const[n,i]=this.pageDimensions,s=Math.round(this.width*n*V.PixelsPerInch.PDF_TO_CSS_UNITS),c=Math.round(this.height*i*V.PixelsPerInch.PDF_TO_CSS_UNITS),d=new OffscreenCanvas(s,c);return d.getContext("2d").drawImage(t(this,F),0,0,t(this,F).width,t(this,F).height,0,0,s,c),d.transferToImageBitmap()}return structuredClone(t(this,F))},W=new WeakSet,Zn=function(){rt(this,v,new ResizeObserver(w=>{const n=w[0].contentRect;n.width&&n.height&&X(this,R,Jn).call(this,n.width,n.height)})),t(this,v).observe(this.div)},ee(gt,"_type","stamp");let dt=gt;r.StampEditor=dt}],__webpack_module_cache__={};function __w_pdfjs_require__(H){var r=__webpack_module_cache__[H];if(r!==void 0)return r.exports;var U=__webpack_module_cache__[H]={exports:{}};return __webpack_modules__[H](U,U.exports,__w_pdfjs_require__),U.exports}var __webpack_exports__={};return(()=>{var H=__webpack_exports__;Object.defineProperty(H,"__esModule",{value:!0}),Object.defineProperty(H,"AbortException",{enumerable:!0,get:function(){return r.AbortException}}),Object.defineProperty(H,"AnnotationEditorLayer",{enumerable:!0,get:function(){return V.AnnotationEditorLayer}}),Object.defineProperty(H,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return r.AnnotationEditorParamsType}}),Object.defineProperty(H,"AnnotationEditorType",{enumerable:!0,get:function(){return r.AnnotationEditorType}}),Object.defineProperty(H,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return j.AnnotationEditorUIManager}}),Object.defineProperty(H,"AnnotationLayer",{enumerable:!0,get:function(){return dt.AnnotationLayer}}),Object.defineProperty(H,"AnnotationMode",{enumerable:!0,get:function(){return r.AnnotationMode}}),Object.defineProperty(H,"CMapCompressionType",{enumerable:!0,get:function(){return r.CMapCompressionType}}),Object.defineProperty(H,"DOMSVGFactory",{enumerable:!0,get:function(){return a.DOMSVGFactory}}),Object.defineProperty(H,"FeatureTest",{enumerable:!0,get:function(){return r.FeatureTest}}),Object.defineProperty(H,"GlobalWorkerOptions",{enumerable:!0,get:function(){return F.GlobalWorkerOptions}}),Object.defineProperty(H,"ImageKind",{enumerable:!0,get:function(){return r.ImageKind}}),Object.defineProperty(H,"InvalidPDFException",{enumerable:!0,get:function(){return r.InvalidPDFException}}),Object.defineProperty(H,"MissingPDFException",{enumerable:!0,get:function(){return r.MissingPDFException}}),Object.defineProperty(H,"OPS",{enumerable:!0,get:function(){return r.OPS}}),Object.defineProperty(H,"PDFDataRangeTransport",{enumerable:!0,get:function(){return U.PDFDataRangeTransport}}),Object.defineProperty(H,"PDFDateString",{enumerable:!0,get:function(){return a.PDFDateString}}),Object.defineProperty(H,"PDFWorker",{enumerable:!0,get:function(){return U.PDFWorker}}),Object.defineProperty(H,"PasswordResponses",{enumerable:!0,get:function(){return r.PasswordResponses}}),Object.defineProperty(H,"PermissionFlag",{enumerable:!0,get:function(){return r.PermissionFlag}}),Object.defineProperty(H,"PixelsPerInch",{enumerable:!0,get:function(){return a.PixelsPerInch}}),Object.defineProperty(H,"PromiseCapability",{enumerable:!0,get:function(){return r.PromiseCapability}}),Object.defineProperty(H,"RenderingCancelledException",{enumerable:!0,get:function(){return a.RenderingCancelledException}}),Object.defineProperty(H,"SVGGraphics",{enumerable:!0,get:function(){return U.SVGGraphics}}),Object.defineProperty(H,"UnexpectedResponseException",{enumerable:!0,get:function(){return r.UnexpectedResponseException}}),Object.defineProperty(H,"Util",{enumerable:!0,get:function(){return r.Util}}),Object.defineProperty(H,"VerbosityLevel",{enumerable:!0,get:function(){return r.VerbosityLevel}}),Object.defineProperty(H,"XfaLayer",{enumerable:!0,get:function(){return x.XfaLayer}}),Object.defineProperty(H,"build",{enumerable:!0,get:function(){return U.build}}),Object.defineProperty(H,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return r.createValidAbsoluteUrl}}),Object.defineProperty(H,"getDocument",{enumerable:!0,get:function(){return U.getDocument}}),Object.defineProperty(H,"getFilenameFromUrl",{enumerable:!0,get:function(){return a.getFilenameFromUrl}}),Object.defineProperty(H,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return a.getPdfFilenameFromUrl}}),Object.defineProperty(H,"getXfaPageViewport",{enumerable:!0,get:function(){return a.getXfaPageViewport}}),Object.defineProperty(H,"isDataScheme",{enumerable:!0,get:function(){return a.isDataScheme}}),Object.defineProperty(H,"isPdfFile",{enumerable:!0,get:function(){return a.isPdfFile}}),Object.defineProperty(H,"loadScript",{enumerable:!0,get:function(){return a.loadScript}}),Object.defineProperty(H,"noContextMenu",{enumerable:!0,get:function(){return a.noContextMenu}}),Object.defineProperty(H,"normalizeUnicode",{enumerable:!0,get:function(){return r.normalizeUnicode}}),Object.defineProperty(H,"renderTextLayer",{enumerable:!0,get:function(){return p.renderTextLayer}}),Object.defineProperty(H,"setLayerDimensions",{enumerable:!0,get:function(){return a.setLayerDimensions}}),Object.defineProperty(H,"shadow",{enumerable:!0,get:function(){return r.shadow}}),Object.defineProperty(H,"updateTextLayer",{enumerable:!0,get:function(){return p.updateTextLayer}}),Object.defineProperty(H,"version",{enumerable:!0,get:function(){return U.version}});var r=__w_pdfjs_require__(1),U=__w_pdfjs_require__(2),a=__w_pdfjs_require__(6),p=__w_pdfjs_require__(26),V=__w_pdfjs_require__(27),j=__w_pdfjs_require__(5),dt=__w_pdfjs_require__(29),F=__w_pdfjs_require__(14),x=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=function(H,r,U){if(U||arguments.length===2)for(var a=0,p=r.length,V;a<p;a++)(V||!(a in r))&&(V||(V=Array.prototype.slice.call(r,0,a)),V[a]=r[a]);return H.concat(V||Array.prototype.slice.call(r))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(H,r){var U={};return allEvents.forEach(function(a){var p=H[a];p&&(r?U[a]=function(V){return p(V,r(a))}:U[a]=p)}),U}function makeCancellablePromise(H){var r=!1,U=new Promise(function(a,p){H.then(function(V){return!r&&a(V)}).catch(function(V){return!r&&p(V)})});return{promise:U,cancel:function(){r=!0}}}var isProduction$1=!0,prefix="Invariant failed";function invariant(H,r){if(!H){if(isProduction$1)throw new Error(prefix);var U=typeof r=="function"?r():r,a=U?"".concat(prefix,": ").concat(U):prefix;throw new Error(a)}}var isProduction=!0;function warning(H,r){if(!isProduction){if(H)return;var U="Warning: "+r;typeof console<"u"&&console.warn(U);try{throw Error(U)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message({children:H,type:r}){return $670gB$react.createElement("div",{className:`react-pdf__message react-pdf__message--${r}`},H)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(r){this.pdfDocument=r}setViewer(r){this.pdfViewer=r}setExternalLinkRel(r){this.externalLinkRel=r}setExternalLinkTarget(r){this.externalLinkTarget=r}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(r){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=r}get rotation(){return 0}set rotation(r){}goToDestination(r){return new Promise(U=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(r,"Destination is not specified."),typeof r=="string"?this.pdfDocument.getDestination(r).then(U):Array.isArray(r)?U(r):r.then(U)}).then(U=>{invariant(Array.isArray(U),`"${U}" is not a valid destination array.`);const a=U[0];new Promise(p=>{invariant(this.pdfDocument,"PDF document not loaded."),a instanceof Object?this.pdfDocument.getPageIndex(a).then(V=>{p(V)}).catch(()=>{invariant(!1,`"${a}" is not a valid page reference.`)}):typeof a=="number"?p(a):invariant(!1,`"${a}" is not a valid destination reference.`)}).then(p=>{const V=p+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(V>=1&&V<=this.pagesCount,`"${V}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:U,pageIndex:p,pageNumber:V})})})}navigateTo(r){this.goToDestination(r)}goToPage(r){const U=r-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(r>=1&&r<=this.pagesCount,`"${r}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:U,pageNumber:r})}addLinkAttributes(r,U,a){r.href=U,r.rel=this.externalLinkRel||DEFAULT_LINK_REL,r.target=a?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(H){return typeof H<"u"}function isProvided(H){return isDefined(H)&&H!==null}function isString(H){return typeof H=="string"}function isArrayBuffer(H){return H instanceof ArrayBuffer}function isBlob(H){return invariant(isBrowser,"isBlob can only be used in a browser environment"),H instanceof Blob}function isDataURI(H){return isString(H)&&/^data:/.test(H)}function dataURItoByteString(H){invariant(isDataURI(H),"Invalid data URI.");const[r="",U=""]=H.split(",");return r.split(";").indexOf("base64")!==-1?atob(U):unescape(U)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(H){H&&H.cancel&&H.cancel()}function makePageCallback(H,r){return Object.defineProperty(H,"width",{get(){return this.view[2]*r},configurable:!0}),Object.defineProperty(H,"height",{get(){return this.view[3]*r},configurable:!0}),Object.defineProperty(H,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(H,"originalHeight",{get(){return this.view[3]},configurable:!0}),H}function isCancelException(H){return H.name==="RenderingCancelledException"}function loadFromFile(H){return new Promise((r,U)=>{const a=new FileReader;a.onload=()=>{if(!a.result)return U(new Error("Error while reading a file."));r(a.result)},a.onerror=p=>{if(!p.target)return U(new Error("Error while reading a file."));const{error:V}=p.target;if(!V)return U(new Error("Error while reading a file."));switch(V.code){case V.NOT_FOUND_ERR:return U(new Error("Error while reading a file: File not found."));case V.SECURITY_ERR:return U(new Error("Error while reading a file: Security error."));case V.ABORT_ERR:return U(new Error("Error while reading a file: Aborted."));default:return U(new Error("Error while reading a file."))}},a.readAsArrayBuffer(H)})}function reducer(H,r){switch(r.type){case"RESOLVE":return{value:r.value,error:void 0};case"REJECT":return{value:!1,error:r.error};case"RESET":return{value:void 0,error:void 0};default:return H}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs$1,eventProps=(()=>{const H={};return allEvents.forEach(r=>{H[r]=PropTypes.func}),H})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function H(r,U,a){const{[U]:p,pageNumber:V,pdf:j}=r;if(!isDefined(j))return null;if(isDefined(p)){if(typeof p!="number")return new Error(`\`${U}\` of type \`${typeof p}\` supplied to \`${a}\`, expected \`number\`.`);if(p<0)return new Error(`Expected \`${U}\` to be greater or equal to 0.`);const{numPages:dt}=j;if(p+1>dt)return new Error(`Expected \`${U}\` to be less or equal to ${dt-1}.`)}else if(!isDefined(V))return new Error(`\`${U}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${a}\`.`);return null},isPageNumber=function H(r,U,a){const{[U]:p,pageIndex:V,pdf:j}=r;if(!isDefined(j))return null;if(isDefined(p)){if(typeof p!="number")return new Error(`\`${U}\` of type \`${typeof p}\` supplied to \`${a}\`, expected \`number\`.`);if(p<1)return new Error(`Expected \`${U}\` to be greater or equal to 1.`);const{numPages:dt}=j;if(p>dt)return new Error(`Expected \`${U}\` to be less or equal to ${dt}.`)}else if(!isDefined(V))return new Error(`\`${U}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${a}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(H,r,U,a){function p(V){return V instanceof U?V:new U(function(j){j(V)})}return new(U||(U=Promise))(function(V,j){function dt(g){try{x(a.next(g))}catch(D){j(D)}}function F(g){try{x(a.throw(g))}catch(D){j(D)}}function x(g){g.done?V(g.value):p(g.value).then(dt,F)}x((a=a.apply(H,r||[])).next())})},__rest$1=function(H,r){var U={};for(var a in H)Object.prototype.hasOwnProperty.call(H,a)&&r.indexOf(a)<0&&(U[a]=H[a]);if(H!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,a=Object.getOwnPropertySymbols(H);p<a.length;p++)r.indexOf(a[p])<0&&Object.prototype.propertyIsEnumerable.call(H,a[p])&&(U[a[p]]=H[a[p]]);return U};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(H,r)=>{switch(r){case PasswordResponses$1.NEED_PASSWORD:{const U=prompt("Enter the password to open this PDF file.");H(U);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const U=prompt("Invalid password. Please try again.");H(U);break}}},Document=reactExports.forwardRef(function H(r,U){var{children:a,className:p,error:V="Failed to load PDF file.",externalLinkRel:j,externalLinkTarget:dt,file:F,inputRef:x,imageResourcesPath:g,loading:D="Loading PDF…",noData:L="No PDF file specified.",onItemClick:C,onLoadError:v,onLoadProgress:y,onLoadSuccess:u,onPassword:_=defaultOnPassword,onSourceError:P,onSourceSuccess:T,options:A,renderMode:o,rotate:h}=r,k=__rest$1(r,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[m,l]=useResolver(),{value:R,error:f}=m,[$,G]=useResolver(),{value:S,error:q}=$,it=reactExports.useRef(new LinkService),ot=reactExports.useRef([]),W=reactExports.useRef({scrollPageIntoView:tt=>{const{dest:lt,pageNumber:mt,pageIndex:ht=mt-1}=tt;if(C){C({dest:lt,pageIndex:ht,pageNumber:mt});return}const kt=ot.current[ht];if(kt){kt.scrollIntoView();return}warning(!1,`An internal link leading to page ${mt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(U,()=>({linkService:it,pages:ot,viewer:W}),[]);function ct(){T&&T()}function gt(){f&&(warning(!1,f.toString()),P&&P(f))}function vt(){l({type:"RESET"})}reactExports.useEffect(vt,[F,l]);const Tt=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!F)return null;if(typeof F=="string")return isDataURI(F)?{data:dataURItoByteString(F)}:(displayCORSWarning(),{url:F});if(F instanceof PDFDataRangeTransport)return{range:F};if(isArrayBuffer(F))return{data:F};if(isBrowser&&isBlob(F))return{data:yield loadFromFile(F)};if(invariant(typeof F=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant("data"in F||"range"in F||"url"in F,"Invalid parameter object: need either .data, .range or .url"),"url"in F&&typeof F.url=="string"){if(isDataURI(F.url)){const{url:tt}=F,lt=__rest$1(F,["url"]),mt=dataURItoByteString(tt);return Object.assign({data:mt},lt)}displayCORSWarning()}return F}),[F]);reactExports.useEffect(()=>{const tt=makeCancellablePromise(Tt());return tt.promise.then(lt=>{l({type:"RESOLVE",value:lt})}).catch(lt=>{l({type:"REJECT",error:lt})}),()=>{cancelRunningTask(tt)}},[Tt,l]),reactExports.useEffect(()=>{if(!(typeof R>"u")){if(R===!1){gt();return}ct()}},[R]);function w(){S&&(u&&u(S),ot.current=new Array(S.numPages),it.current.setDocument(S))}function n(){q&&(warning(!1,q.toString()),v&&v(q))}function i(){G({type:"RESET"})}reactExports.useEffect(i,[G,R]);function s(){if(!R)return;const tt=A?Object.assign(Object.assign({},R),A):R,lt=pdfjs$1.getDocument(tt);y&&(lt.onProgress=y),_&&(lt.onPassword=_);const mt=lt;return mt.promise.then(ht=>{G({type:"RESOLVE",value:ht})}).catch(ht=>{mt.destroyed||G({type:"REJECT",error:ht})}),()=>{mt.destroy()}}reactExports.useEffect(s,[A,G,R]),reactExports.useEffect(()=>{if(!(typeof S>"u")){if(S===!1){n();return}w()}},[S]);function c(){it.current.setViewer(W.current),it.current.setExternalLinkRel(j),it.current.setExternalLinkTarget(dt)}reactExports.useEffect(c,[j,dt]);function d(tt,lt){ot.current[tt]=lt}function E(tt){delete ot.current[tt]}const M=reactExports.useMemo(()=>({imageResourcesPath:g,linkService:it.current,onItemClick:C,pdf:S,registerPage:d,renderMode:o,rotate:h,unregisterPage:E}),[g,C,S,o,h]),N=reactExports.useMemo(()=>makeEventProps(k,()=>S),[k,S]);function st(){return $670gB$react.createElement(DocumentContext.Provider,{value:M},a)}function Z(){return F?S==null?$670gB$react.createElement(Message,{type:"loading"},typeof D=="function"?D():D):S===!1?$670gB$react.createElement(Message,{type:"error"},typeof V=="function"?V():V):st():$670gB$react.createElement(Message,{type:"no-data"},typeof L=="function"?L():L)}return $670gB$react.createElement("div",Object.assign({className:clsx("react-pdf__Document",p),ref:x,style:{"--scale-factor":"1"}},N),Z())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var H=[],r=0;r<arguments.length;r++)H[r]=arguments[r];var U=H.filter(Boolean);if(U.length<=1){var a=U[0];return a||null}return function(V){U.forEach(function(j){typeof j=="function"?j(V):j&&(j.current=V)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(H){return H in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(H){return"children"in H}function isStructTreeNodeWithOnlyContentChild(H){return isStructTreeNode(H)?H.children.length===1&&0 in H.children&&"id"in H.children[0]:!1}function getRoleAttributes(H){const r={};if(isStructTreeNode(H)){const{role:U}=H,a=U.match(HEADING_PATTERN);if(a)r.role="heading",r["aria-level"]=Number(a[1]);else if(isPdfRole(U)){const p=PDF_ROLE_TO_HTML_ROLE[U];p&&(r.role=p)}}return r}function getBaseAttributes(H){const r={};if(isStructTreeNode(H)){if(H.alt!==void 0&&(r["aria-label"]=H.alt),H.lang!==void 0&&(r.lang=H.lang),isStructTreeNodeWithOnlyContentChild(H)){const[U]=H.children;if(U){const a=getBaseAttributes(U);return Object.assign(Object.assign({},r),a)}}}else"id"in H&&(r["aria-owns"]=H.id);return r}function getAttributes(H){return H?Object.assign(Object.assign({},getRoleAttributes(H)),getBaseAttributes(H)):null}function StructTreeItem({className:H,node:r}){const U=reactExports.useMemo(()=>getAttributes(r),[r]),a=reactExports.useMemo(()=>!isStructTreeNode(r)||isStructTreeNodeWithOnlyContentChild(r)?null:r.children.map((p,V)=>$670gB$react.createElement(StructTreeItem,{key:V,node:p})),[r]);return $670gB$react.createElement("span",Object.assign({className:H},U),a)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const H=usePageContext();invariant(H,"Unable to find Page context.");const{onGetStructTreeError:r,onGetStructTreeSuccess:U}=H,[a,p]=useResolver(),{value:V,error:j}=a,{customTextRenderer:dt,page:F}=H;function x(){V&&U&&U(V)}function g(){j&&(warning(!1,j.toString()),r&&r(j))}function D(){p({type:"RESET"})}reactExports.useEffect(D,[p,F]);function L(){if(dt||!F)return;const C=makeCancellablePromise(F.getStructTree()),v=C;return C.promise.then(y=>{p({type:"RESOLVE",value:y})}).catch(y=>{p({type:"REJECT",error:y})}),()=>cancelRunningTask(v)}return reactExports.useEffect(L,[dt,F,p]),reactExports.useEffect(()=>{if(V!==void 0){if(V===!1){g();return}x()}},[V]),V?$670gB$react.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:V}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(H){const r=usePageContext();invariant(r,"Unable to find Page context.");const U=Object.assign(Object.assign({},r),H),{_className:a,canvasBackground:p,devicePixelRatio:V=getDevicePixelRatio(),onRenderError:j,onRenderSuccess:dt,page:F,renderForms:x,renderTextLayer:g,rotate:D,scale:L}=U,{canvasRef:C}=H;invariant(F,"Attempted to render page canvas, but no page was specified.");const v=reactExports.useRef(null);function y(){F&&dt&&dt(makePageCallback(F,L))}function u(o){isCancelException(o)||(warning(!1,o.toString()),j&&j(o))}const _=reactExports.useMemo(()=>F.getViewport({scale:L*V,rotation:D}),[V,F,D,L]),P=reactExports.useMemo(()=>F.getViewport({scale:L,rotation:D}),[F,D,L]);function T(){if(!F)return;F.cleanup();const{current:o}=v;if(!o)return;o.width=_.width,o.height=_.height,o.style.width=`${Math.floor(P.width)}px`,o.style.height=`${Math.floor(P.height)}px`,o.style.visibility="hidden";const h={annotationMode:x?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:o.getContext("2d",{alpha:!1}),viewport:_};p&&(h.background=p);const k=F.render(h),m=k;return k.promise.then(()=>{o.style.visibility="",y()}).catch(u),()=>cancelRunningTask(m)}reactExports.useEffect(T,[p,v,V,F,x,_,P]);const A=reactExports.useCallback(()=>{const{current:o}=v;o&&(o.width=0,o.height=0)},[v]);return reactExports.useEffect(()=>A,[A]),$670gB$react.createElement("canvas",{className:`${a}__canvas`,dir:"ltr",ref:mergeRefs(C,v),style:{display:"block",userSelect:"none"}},g?$670gB$react.createElement(StructTree,null):null)}function PageSVG(){const H=usePageContext();invariant(H,"Unable to find Page context.");const{_className:r,onRenderSuccess:U,onRenderError:a,page:p,rotate:V,scale:j}=H;invariant(p,"Attempted to render page SVG, but no page was specified.");const[dt,F]=useResolver(),{value:x,error:g}=dt;function D(){p&&U&&U(makePageCallback(p,j))}function L(){g&&(isCancelException(g)||(warning(!1,g.toString()),a&&a(g)))}const C=reactExports.useMemo(()=>p.getViewport({scale:j,rotation:V}),[p,V,j]);function v(){F({type:"RESET"})}reactExports.useEffect(v,[p,F,C]);function y(){if(!p)return;const T=makeCancellablePromise(p.getOperatorList());return T.promise.then(A=>{new pdfjs$1.SVGGraphics(p.commonObjs,p.objs).getSVG(A,C).then(h=>{if(!(h instanceof SVGElement))throw new Error("getSVG returned unexpected result.");F({type:"RESOLVE",value:h})}).catch(h=>{F({type:"REJECT",error:h})})}).catch(A=>{F({type:"REJECT",error:A})}),()=>cancelRunningTask(T)}reactExports.useEffect(y,[p,F,C]),reactExports.useEffect(()=>{if(x!==void 0){if(x===!1){L();return}D()}},[x]);function u(T){if(!T||!x)return;T.firstElementChild||T.appendChild(x);const{width:A,height:o}=C;x.setAttribute("width",`${A}`),x.setAttribute("height",`${o}`)}const{width:_,height:P}=C;return $670gB$react.createElement("div",{className:`${r}__svg`,ref:T=>u(T),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:_,height:P,userSelect:"none"}})}function isTextItem(H){return"str"in H}function TextLayer(){const H=usePageContext();invariant(H,"Unable to find Page context.");const{customTextRenderer:r,onGetTextError:U,onGetTextSuccess:a,onRenderTextLayerError:p,onRenderTextLayerSuccess:V,page:j,pageIndex:dt,pageNumber:F,rotate:x,scale:g}=H;invariant(j,"Attempted to load page text content, but no page was specified.");const[D,L]=useResolver(),{value:C,error:v}=D,y=reactExports.useRef(null),u=reactExports.useRef();warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function _(){C&&a&&a(C)}function P(){v&&(warning(!1,v.toString()),U&&U(v))}function T(){L({type:"RESET"})}reactExports.useEffect(T,[j,L]);function A(){if(!j)return;const f=makeCancellablePromise(j.getTextContent()),$=f;return f.promise.then(G=>{L({type:"RESOLVE",value:G})}).catch(G=>{L({type:"REJECT",error:G})}),()=>cancelRunningTask($)}reactExports.useEffect(A,[j,L]),reactExports.useEffect(()=>{if(C!==void 0){if(C===!1){P();return}_()}},[C]);const o=reactExports.useCallback(()=>{V&&V()},[V]),h=reactExports.useCallback(f=>{warning(!1,f.toString()),p&&p(f)},[p]);function k(){const f=u.current;f&&f.classList.add("active")}function m(){const f=u.current;f&&f.classList.remove("active")}const l=reactExports.useMemo(()=>j.getViewport({scale:g,rotation:x}),[j,x,g]);function R(){if(!j||!C)return;const{current:f}=y;if(!f)return;f.innerHTML="";const $=j.streamTextContent({includeMarkedContent:!0}),G={container:f,textContentSource:$,viewport:l},S=pdfjs$1.renderTextLayer(G),q=S;return S.promise.then(()=>{const it=document.createElement("div");it.className="endOfContent",f.append(it),u.current=it;const ot=f.querySelectorAll('[role="presentation"]');if(r){let W=0;C.items.forEach((ct,gt)=>{if(!isTextItem(ct))return;const vt=ot[W];if(!vt)return;const Tt=r(Object.assign({pageIndex:dt,pageNumber:F,itemIndex:gt},ct));vt.innerHTML=Tt,W+=ct.str&&ct.hasEOL?2:1})}o()}).catch(h),()=>cancelRunningTask(q)}return reactExports.useLayoutEffect(R,[r,h,o,j,dt,F,C,l]),$670gB$react.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:m,onMouseDown:k,ref:y})}function AnnotationLayer(){const H=useDocumentContext();invariant(H,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const r=usePageContext();invariant(r,"Unable to find Page context.");const U=Object.assign(Object.assign({},H),r),{imageResourcesPath:a,linkService:p,onGetAnnotationsError:V,onGetAnnotationsSuccess:j,onRenderAnnotationLayerError:dt,onRenderAnnotationLayerSuccess:F,page:x,pdf:g,renderForms:D,rotate:L,scale:C=1}=U;invariant(x,"Attempted to load page annotations, but no page was specified.");const[v,y]=useResolver(),{value:u,error:_}=v,P=reactExports.useRef(null);warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function T(){u&&j&&j(u)}function A(){_&&(warning(!1,_.toString()),V&&V(_))}function o(){y({type:"RESET"})}reactExports.useEffect(o,[y,x]);function h(){if(!x)return;const f=makeCancellablePromise(x.getAnnotations()),$=f;return f.promise.then(G=>{y({type:"RESOLVE",value:G})}).catch(G=>{y({type:"REJECT",error:G})}),()=>{cancelRunningTask($)}}reactExports.useEffect(h,[y,x,D]),reactExports.useEffect(()=>{if(u!==void 0){if(u===!1){A();return}T()}},[u]);function k(){F&&F()}function m(f){warning(!1,`${f}`),dt&&dt(f)}const l=reactExports.useMemo(()=>x.getViewport({scale:C,rotation:L}),[x,L,C]);function R(){if(!g||!x||!u)return;const{current:f}=P;if(!f)return;const $=l.clone({dontFlip:!0}),G={accessibilityManager:null,annotationCanvasMap:null,div:f,l10n:null,page:x,viewport:$},S={annotations:u,annotationStorage:g.annotationStorage,div:f,downloadManager:null,imageResourcesPath:a,linkService:p,page:x,renderForms:D,viewport:$};f.innerHTML="";try{new pdfjs$1.AnnotationLayer(G).render(S),k()}catch(q){m(q)}return()=>{}}return reactExports.useEffect(R,[u,a,p,x,D,l]),$670gB$react.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:P})}var __rest=function(H,r){var U={};for(var a in H)Object.prototype.hasOwnProperty.call(H,a)&&r.indexOf(a)<0&&(U[a]=H[a]);if(H!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,a=Object.getOwnPropertySymbols(H);p<a.length;p++)r.indexOf(a[p])<0&&Object.prototype.propertyIsEnumerable.call(H,a[p])&&(U[a[p]]=H[a[p]]);return U};const defaultScale=1,Page=function H(r){const U=useDocumentContext();invariant(U,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const a=Object.assign(Object.assign({},U),r),{_className:p="react-pdf__Page",_enableRegisterUnregisterPage:V=!0,canvasBackground:j,canvasRef:dt,children:F,className:x,customRenderer:g,customTextRenderer:D,devicePixelRatio:L,error:C="Failed to load the page.",height:v,inputRef:y,loading:u="Loading page…",noData:_="No page specified.",onGetAnnotationsError:P,onGetAnnotationsSuccess:T,onGetStructTreeError:A,onGetStructTreeSuccess:o,onGetTextError:h,onGetTextSuccess:k,onLoadError:m,onLoadSuccess:l,onRenderAnnotationLayerError:R,onRenderAnnotationLayerSuccess:f,onRenderError:$,onRenderSuccess:G,onRenderTextLayerError:S,onRenderTextLayerSuccess:q,pageIndex:it,pageNumber:ot,pdf:W,registerPage:ct,renderAnnotationLayer:gt=!0,renderForms:vt=!1,renderMode:Tt="canvas",renderTextLayer:w=!0,rotate:n,scale:i=defaultScale,unregisterPage:s,width:c}=a,d=__rest(a,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[E,M]=useResolver(),{value:N,error:st}=E,Z=reactExports.useRef(null);invariant(W,"Attempted to load a page, but no document was specified.");const tt=isProvided(ot)?ot-1:it??null,lt=ot??(isProvided(it)?it+1:null),mt=n??(N?N.rotate:null),ht=reactExports.useMemo(()=>{if(!N)return null;let Wt=1;const $t=i??defaultScale;if(c||v){const zt=N.getViewport({scale:1,rotation:mt});c?Wt=c/zt.width:v&&(Wt=v/zt.height)}return $t*Wt},[v,N,mt,i,c]);function kt(){return()=>{isProvided(tt)&&V&&s&&s(tt)}}reactExports.useEffect(kt,[V,W,tt,s]);function Bt(){if(l){if(!N||!ht)return;l(makePageCallback(N,ht))}if(V&&ct){if(!isProvided(tt)||!Z.current)return;ct(tt,Z.current)}}function Et(){st&&(warning(!1,st.toString()),m&&m(st))}function Dt(){M({type:"RESET"})}reactExports.useEffect(Dt,[M,W,tt]);function pt(){if(!W||!lt)return;const Wt=makeCancellablePromise(W.getPage(lt)),$t=Wt;return Wt.promise.then(zt=>{M({type:"RESOLVE",value:zt})}).catch(zt=>{M({type:"REJECT",error:zt})}),()=>cancelRunningTask($t)}reactExports.useEffect(pt,[M,W,tt,lt,ct]),reactExports.useEffect(()=>{if(N!==void 0){if(N===!1){Et();return}Bt()}},[N,ht]);const et=reactExports.useMemo(()=>N&&isProvided(tt)&&lt&&isProvided(mt)&&isProvided(ht)?{_className:p,canvasBackground:j,customTextRenderer:D,devicePixelRatio:L,onGetAnnotationsError:P,onGetAnnotationsSuccess:T,onGetStructTreeError:A,onGetStructTreeSuccess:o,onGetTextError:h,onGetTextSuccess:k,onRenderAnnotationLayerError:R,onRenderAnnotationLayerSuccess:f,onRenderError:$,onRenderSuccess:G,onRenderTextLayerError:S,onRenderTextLayerSuccess:q,page:N,pageIndex:tt,pageNumber:lt,renderForms:vt,renderTextLayer:w,rotate:mt,scale:ht}:null,[p,j,D,L,P,T,A,o,h,k,R,f,$,G,S,q,N,tt,lt,vt,w,mt,ht]),nt=reactExports.useMemo(()=>makeEventProps(d,()=>N&&(ht?makePageCallback(N,ht):void 0)),[d,N,ht]),ft=`${tt}@${ht}/${mt}`,Pt=`${tt}/${mt}`;function wt(){switch(Tt){case"custom":return invariant(g,'renderMode was set to "custom", but no customRenderer was passed.'),$670gB$react.createElement(g,{key:`${ft}_custom`});case"none":return null;case"svg":return $670gB$react.createElement(PageSVG,{key:`${Pt}_svg`});case"canvas":default:return $670gB$react.createElement(PageCanvas,{key:`${ft}_canvas`,canvasRef:dt})}}function Ut(){return w?$670gB$react.createElement(TextLayer,{key:`${ft}_text`}):null}function Gt(){return gt?$670gB$react.createElement(AnnotationLayer,{key:`${ft}_annotations`}):null}function jt(){return $670gB$react.createElement(PageContext.Provider,{value:et},wt(),Ut(),Gt(),F)}function Vt(){return lt?W===null||N===void 0||N===null?$670gB$react.createElement(Message,{type:"loading"},typeof u=="function"?u():u):W===!1||N===!1?$670gB$react.createElement(Message,{type:"error"},typeof C=="function"?C():C):jt():$670gB$react.createElement(Message,{type:"no-data"},typeof _=="function"?_():_)}return $670gB$react.createElement("div",Object.assign({className:clsx(p,x),"data-page-number":lt,ref:mergeRefs(y,Z),style:{"--scale-factor":`${ht}`,backgroundColor:j||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},nt),Vt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});const Page$1=Page;displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";export{Document$1 as D,Page$1 as P,pdfjs$1 as p};
