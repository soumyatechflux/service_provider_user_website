import{r as d,A as L,l as P,n as G,f as N,o as H,p as J,q as U,j as o,B as m,k as O,T as h,E as z,t as q,v as V,w as X,x as Y,y as Z,z as _,C as tt,D as et,F as st}from"./index-BLDXZsNf.js";function at(){var g,p,y,S,j,E;const{userData:l}=d.useContext(L),r=P(),x=G(),[a,$]=d.useState(),{data:n,isLoading:k}=N({queryKey:["examSession"],queryFn:()=>_(l.id)}),{mutate:A}=H({onMutate:()=>{const s=r.getQueryData(["examSession"]);return r.setQueryData(["examSession"],()=>[]),()=>r.setQueryData(["examSession"],s)},mutationFn:()=>R()}),f=(p=(g=n[0])==null?void 0:g.startTime)==null?void 0:p.toDate(),c=(S=(y=n[0])==null?void 0:y.endTime)==null?void 0:S.toDate(),{id:B}=J(),K=async s=>{const e=tt(et,"finalExams",s),i=await st(e);return{...i.data(),id:i.id}},{data:t}=N({queryKey:["examSessionFinalExam"],queryFn:()=>K(B??"")}),R=async()=>{var s;await Z(((s=n[0])==null?void 0:s.id)??"",l.id,`/programs/current/${t==null?void 0:t.programId}`)};d.useEffect(()=>{const s=setInterval(()=>{if(f&&c){const e=c-U.now().toMillis();e>0?$(e):(A(),x("/"))}},1e3);return()=>clearInterval(s)},[f,c,a]);const W=async()=>{t!=null&&t.id&&await Y(l.id,t.id),await r.invalidateQueries({queryKey:["examSession"]}),x("/")};return k?o.jsx(o.Fragment,{}):o.jsxs(m,{width:"100%",position:"relative",children:[o.jsxs(O,{justifyContent:"space-between",direction:"row",children:[o.jsxs(O,{direction:"column",bgcolor:"#FEF4EB",px:12,py:4,children:[o.jsx(h,{sx:{color:"#226E9F"},fontSize:16,fontFamily:"Inter",fontWeight:800,children:"Model Exam"}),o.jsx(h,{sx:{color:"#226E9F"},fontSize:16,fontFamily:"Inter",fontWeight:600,children:"Exam 1"})]}),o.jsx(m,{boxShadow:"0px 4px 4px 0px rgba(0, 0, 0, 0.25)",textAlign:"center",borderRadius:"15px",mr:14,mt:4,display:"flex",justifyContent:"center",alignItems:"center",height:"60px",width:"180px",children:o.jsxs(h,{fontSize:16,fontFamily:"Inter",fontWeight:500,children:[a?Math.floor(a/(1e3*60*60)).toString().length>1?Math.floor(a/(1e3*60*60)):`0${a&&Math.floor(a/(1e3*60*60))}`:"00",":",a?Math.floor(a%(1e3*60*60)/(1e3*60)).toString().length>1?Math.floor(a%(1e3*60*60)/(1e3*60)):`0${a&&Math.floor(a%(1e3*60*60)/(1e3*60))}`:"00",":",a?Math.floor(a%(1e3*60)/1e3).toString().length>1?Math.floor(a%(1e3*60)/1e3):`0${a&&Math.floor(a%(1e3*60)/1e3)}`:"00"]})})]}),o.jsx(m,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:((j=t==null?void 0:t.questions)==null?void 0:j.length)&&((E=t==null?void 0:t.questions)==null?void 0:E.map((s,e)=>{var i,u,F,b,w,Q,I,D,M,T,v,C;return s.type==="options"?s.correctOption.length>1?o.jsx(z,{hidden:e!==Number((i=n[0])==null?void 0:i.lastQuestion),finalExamId:t.id,question:s,index:e,total:(u=t==null?void 0:t.questions)==null?void 0:u.length},e):o.jsx(q,{hidden:e!==Number((F=n[0])==null?void 0:F.lastQuestion),finalExamId:t.id,question:s,index:e,total:(b=t==null?void 0:t.questions)==null?void 0:b.length},e):s.type==="fiveOptions"?s.correctOption.length>2?o.jsx(V,{hidden:e!==Number((w=n[0])==null?void 0:w.lastQuestion),finalExamId:t.id,question:s,index:e,total:(Q=t==null?void 0:t.questions)==null?void 0:Q.length},e):s.correctOption.length>1?o.jsx(z,{hidden:e!==Number((I=n[0])==null?void 0:I.lastQuestion),finalExamId:t.id,question:s,index:e,total:(D=t==null?void 0:t.questions)==null?void 0:D.length},e):o.jsx(q,{hidden:e!==Number((M=n[0])==null?void 0:M.lastQuestion),finalExamId:t.id,question:s,index:e,total:(T=t==null?void 0:t.questions)==null?void 0:T.length},e):o.jsx(X,{hidden:e!==Number((v=n[0])==null?void 0:v.lastQuestion),finalExamId:t.id,question:s,index:e,total:(C=t==null?void 0:t.questions)==null?void 0:C.length},e)}))}),o.jsx("div",{className:"absolute flex flex-col gap-2 w-fit text-left items-end justify-end text-[#FF7E00] font-[Inter] bottom-10 left-5 z-50",children:o.jsx("button",{className:"bg-[#FF7E00] text-white px-4 py-2 rounded-md",onClick:()=>W(),children:"Exit Exam"})})]})}export{at as default};
